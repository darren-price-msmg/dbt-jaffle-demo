

============================== 2022-08-11 13:58:19.541408 | 81cf2908-b20f-4096-83ca-6612d213ccc9 ==============================
13:58:19.541412 [info ] [MainThread]: Running with dbt=1.1.1
13:58:19.541609 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
13:58:19.541674 [debug] [MainThread]: Tracking: tracking
13:58:19.557745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041699f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041acf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041acb50>]}
13:58:19.613402 [debug] [MainThread]: Executing "git --help"
13:58:19.639378 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:58:19.639731 [debug] [MainThread]: STDERR: "b''"
13:58:19.644014 [debug] [MainThread]: Acquiring new postgres connection "debug"
13:58:19.644494 [debug] [MainThread]: Using postgres connection "debug"
13:58:19.644566 [debug] [MainThread]: On debug: select 1 as id
13:58:19.644652 [debug] [MainThread]: Opening a new connection, currently in state init
13:58:19.688980 [debug] [MainThread]: SQL status: SELECT 1 in 0.04 seconds
13:58:19.689936 [debug] [MainThread]: On debug: Close
13:58:19.690184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048669b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104865660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104864430>]}
13:58:20.165437 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-08-11 13:58:27.692316 | 11b14f59-f653-4f91-ac41-233195b86ac5 ==============================
13:58:27.692349 [info ] [MainThread]: Running with dbt=1.1.1
13:58:27.692804 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
13:58:27.693046 [debug] [MainThread]: Tracking: tracking
13:58:27.708520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10889cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088b6320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088b5090>]}
13:58:27.709570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088b4f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088b7be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088b7190>]}


============================== 2022-08-11 13:58:43.529210 | 22b77ecb-a29c-44f4-8659-fdbd99ea38a5 ==============================
13:58:43.529215 [info ] [MainThread]: Running with dbt=1.1.1
13:58:43.529418 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
13:58:43.529480 [debug] [MainThread]: Tracking: tracking
13:58:43.554013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039f7940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039b3e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039f77c0>]}
13:58:43.556654 [debug] [MainThread]: Set downloads directory='/var/folders/v7/1zrhqbhd3g36bdl87kskrlg40000gp/T/dbt-downloads-5kun7uai'
13:58:43.556956 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
13:58:43.690787 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
13:58:43.691175 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
13:58:43.789269 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
13:58:43.824040 [info ] [MainThread]: Installing dbt-labs/dbt_utils
13:58:44.360752 [info ] [MainThread]:   Installed from version 0.7.4-b1
13:58:44.361115 [info ] [MainThread]:   Updated version available: 0.8.6
13:58:44.361379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '22b77ecb-a29c-44f4-8659-fdbd99ea38a5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039f7f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039f4070>]}
13:58:44.361585 [info ] [MainThread]: 
13:58:44.361730 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
13:58:44.363290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103aa40a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103aa40d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103aa4100>]}


============================== 2022-08-11 13:58:51.258595 | 1e0990ff-c896-4c16-92c6-dd1e6f00dba3 ==============================
13:58:51.258614 [info ] [MainThread]: Running with dbt=1.1.1
13:58:51.258932 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
13:58:51.259015 [debug] [MainThread]: Tracking: tracking
13:58:51.277350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ca04c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cba3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cbbca0>]}
13:58:51.288466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cbbb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cba110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb85b0>]}


============================== 2022-08-11 13:59:35.779277 | ecfb680c-c127-44b6-ac2d-9eaadca21ac7 ==============================
13:59:35.779295 [info ] [MainThread]: Running with dbt=1.1.1
13:59:35.779666 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
13:59:35.779768 [debug] [MainThread]: Tracking: tracking
13:59:35.798741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd6b30>]}
13:59:35.809330 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
13:59:35.809494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ecfb680c-c127-44b6-ac2d-9eaadca21ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd4d30>]}
13:59:35.864466 [debug] [MainThread]: Parsing macros/example_macro.sql
13:59:35.864936 [debug] [MainThread]: Parsing macros/catalog.sql
13:59:35.866565 [debug] [MainThread]: Parsing macros/relations.sql
13:59:35.867208 [debug] [MainThread]: Parsing macros/adapters.sql
13:59:35.877323 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
13:59:35.878038 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
13:59:35.879634 [debug] [MainThread]: Parsing macros/materializations/configs.sql
13:59:35.880572 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
13:59:35.881276 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
13:59:35.888541 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
13:59:35.894538 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
13:59:35.899586 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
13:59:35.901479 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
13:59:35.902224 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
13:59:35.902949 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
13:59:35.904765 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
13:59:35.912460 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
13:59:35.913084 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
13:59:35.917540 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
13:59:35.924554 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
13:59:35.928002 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
13:59:35.929165 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
13:59:35.932595 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
13:59:35.933124 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
13:59:35.934252 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
13:59:35.935173 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
13:59:35.937766 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
13:59:35.959440 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
13:59:35.960149 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
13:59:35.961174 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
13:59:35.961814 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
13:59:35.962183 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
13:59:35.962505 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
13:59:35.962784 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
13:59:35.963343 [debug] [MainThread]: Parsing macros/etc/statement.sql
13:59:35.965237 [debug] [MainThread]: Parsing macros/etc/datetime.sql
13:59:35.968846 [debug] [MainThread]: Parsing macros/adapters/schema.sql
13:59:35.969717 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
13:59:35.970797 [debug] [MainThread]: Parsing macros/adapters/relation.sql
13:59:35.974851 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
13:59:35.976043 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
13:59:35.977860 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
13:59:35.980938 [debug] [MainThread]: Parsing macros/adapters/columns.sql
13:59:35.985082 [debug] [MainThread]: Parsing tests/generic/builtin.sql
13:59:35.986317 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
13:59:35.986729 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
13:59:35.987297 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
13:59:35.987684 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
13:59:35.989958 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
13:59:35.990421 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
13:59:35.990924 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
13:59:35.992078 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
13:59:35.992484 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
13:59:35.993410 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
13:59:35.997863 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
13:59:35.998586 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
13:59:35.999138 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
13:59:35.999697 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
13:59:36.000343 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
13:59:36.000961 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
13:59:36.001387 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
13:59:36.002756 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
13:59:36.005112 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
13:59:36.006608 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
13:59:36.007346 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
13:59:36.007926 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
13:59:36.008725 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
13:59:36.020011 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
13:59:36.020776 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
13:59:36.021870 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
13:59:36.022498 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
13:59:36.022958 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
13:59:36.023444 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
13:59:36.023886 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
13:59:36.024359 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
13:59:36.025102 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
13:59:36.025778 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
13:59:36.026796 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
13:59:36.027507 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
13:59:36.028001 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
13:59:36.029032 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
13:59:36.029928 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
13:59:36.030499 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
13:59:36.031007 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
13:59:36.032195 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
13:59:36.033070 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
13:59:36.033983 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
13:59:36.034899 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
13:59:36.036013 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
13:59:36.036584 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
13:59:36.038122 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
13:59:36.042388 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
13:59:36.044393 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
13:59:36.045045 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
13:59:36.046487 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
13:59:36.048294 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
13:59:36.049737 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
13:59:36.050416 [debug] [MainThread]: Parsing macros/sql/star.sql
13:59:36.051953 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
13:59:36.055421 [debug] [MainThread]: Parsing macros/sql/union.sql
13:59:36.059037 [debug] [MainThread]: Parsing macros/sql/groupby.sql
13:59:36.059578 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
13:59:36.061007 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
13:59:36.061665 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
13:59:36.062323 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
13:59:36.065148 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
13:59:36.067310 [debug] [MainThread]: Parsing macros/sql/pivot.sql
13:59:36.069045 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
13:59:36.070029 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
13:59:36.202325 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers.sql
13:59:36.207322 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payments.sql
13:59:36.208218 [debug] [MainThread]: 1603: static parser failed on staging/stg_orders.sql
13:59:36.210209 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_orders.sql
13:59:36.210749 [debug] [MainThread]: 1699: static parser successfully parsed staging/hidden_model.sql
13:59:36.211792 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/dim_customers.sql
13:59:36.212770 [debug] [MainThread]: 1603: static parser failed on marts/core/fct_orders.sql
13:59:36.214632 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/core/fct_orders.sql
13:59:36.215110 [debug] [MainThread]: 1603: static parser failed on marts/core/intermediate/order_payments.sql
13:59:36.217084 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/core/intermediate/order_payments.sql
13:59:36.217641 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/intermediate/customer_payments.sql
13:59:36.218527 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/intermediate/customer_orders.sql
13:59:36.313997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecfb680c-c127-44b6-ac2d-9eaadca21ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fcb5e0>]}
13:59:36.319692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecfb680c-c127-44b6-ac2d-9eaadca21ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106034eb0>]}
13:59:36.319815 [info ] [MainThread]: Found 9 models, 23 tests, 0 snapshots, 1 analysis, 355 macros, 0 operations, 3 seed files, 2 sources, 3 exposures, 2 metrics
13:59:36.319922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecfb680c-c127-44b6-ac2d-9eaadca21ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105faff70>]}
13:59:36.320806 [info ] [MainThread]: 
13:59:36.320990 [debug] [MainThread]: Acquiring new postgres connection "master"
13:59:36.321394 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbttest"
13:59:36.325420 [debug] [ThreadPool]: Using postgres connection "list_dbttest"
13:59:36.325508 [debug] [ThreadPool]: On list_dbttest: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "msm", "target_name": "dev", "connection_name": "list_dbttest"} */

    select distinct nspname from pg_namespace
  
13:59:36.325565 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:59:36.365373 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.04 seconds
13:59:36.366086 [debug] [ThreadPool]: On list_dbttest: Close
13:59:36.366758 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbttest_dev"
13:59:36.369759 [debug] [ThreadPool]: Using postgres connection "list_dbttest_dev"
13:59:36.369851 [debug] [ThreadPool]: On list_dbttest_dev: BEGIN
13:59:36.369913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:59:36.374623 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
13:59:36.374698 [debug] [ThreadPool]: Using postgres connection "list_dbttest_dev"
13:59:36.374755 [debug] [ThreadPool]: On list_dbttest_dev: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "msm", "target_name": "dev", "connection_name": "list_dbttest_dev"} */
select
      'dbttest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbttest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
13:59:36.380530 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
13:59:36.381108 [debug] [ThreadPool]: On list_dbttest_dev: ROLLBACK
13:59:36.381325 [debug] [ThreadPool]: On list_dbttest_dev: Close
13:59:36.383637 [debug] [MainThread]: Using postgres connection "master"
13:59:36.383729 [debug] [MainThread]: On master: BEGIN
13:59:36.383789 [debug] [MainThread]: Opening a new connection, currently in state init
13:59:36.388866 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:59:36.388938 [debug] [MainThread]: Using postgres connection "master"
13:59:36.388994 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "msm", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
13:59:36.403333 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
13:59:36.403922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecfb680c-c127-44b6-ac2d-9eaadca21ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105104ee0>]}
13:59:36.404069 [debug] [MainThread]: On master: ROLLBACK
13:59:36.404261 [debug] [MainThread]: Using postgres connection "master"
13:59:36.404328 [debug] [MainThread]: On master: BEGIN
13:59:36.404654 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:59:36.404730 [debug] [MainThread]: On master: COMMIT
13:59:36.404790 [debug] [MainThread]: Using postgres connection "master"
13:59:36.404846 [debug] [MainThread]: On master: COMMIT
13:59:36.405004 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:59:36.405075 [debug] [MainThread]: On master: Close
13:59:36.405218 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:59:36.405346 [info ] [MainThread]: 
13:59:36.409456 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
13:59:36.409585 [info ] [Thread-1 (]: 1 of 6 START view model dev.stg_customers ...................................... [RUN]
13:59:36.409778 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.stg_customers"
13:59:36.409845 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
13:59:36.409928 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_customers
13:59:36.411215 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
13:59:36.411954 [debug] [Thread-1 (]: finished collecting timing info
13:59:36.412029 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
13:59:36.439754 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.stg_customers"
13:59:36.440809 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
13:59:36.440875 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
13:59:36.440927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:59:36.454102 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
13:59:36.454179 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
13:59:36.454231 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbttest"."dev"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "dbttest"."dev"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name,
        email

    from source

)

select * from renamed
  );
13:59:36.454860 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.raw_customers" does not exist
LINE 5:     select * from "dbttest"."dev"."raw_customers"
                          ^

13:59:36.454929 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: ROLLBACK
13:59:36.455174 [debug] [Thread-1 (]: finished collecting timing info
13:59:36.455238 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
13:59:36.455376 [debug] [Thread-1 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "dev.raw_customers" does not exist
  LINE 5:     select * from "dbttest"."dev"."raw_customers"
                            ^
  compiled SQL at target/run/jaffle_shop/models/staging/stg_customers.sql
13:59:36.455489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecfb680c-c127-44b6-ac2d-9eaadca21ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ef3a0>]}
13:59:36.455638 [error] [Thread-1 (]: 1 of 6 ERROR creating view model dev.stg_customers ............................. [[31mERROR[0m in 0.05s]
13:59:36.455818 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
13:59:36.455898 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
13:59:36.455991 [info ] [Thread-1 (]: 2 of 6 START view model dev.stg_orders ......................................... [RUN]
13:59:36.456240 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.stg_orders"
13:59:36.456318 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
13:59:36.456385 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_orders
13:59:36.457773 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
13:59:36.458309 [debug] [Thread-1 (]: finished collecting timing info
13:59:36.458373 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
13:59:36.459399 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.stg_orders"
13:59:36.459664 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
13:59:36.459720 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
13:59:36.459769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:59:36.463443 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
13:59:36.463506 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
13:59:36.463557 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbttest"."dev"."stg_orders__dbt_tmp" as (
    /*
hack for example macro references:
    

    The provided args are abc and 123


*/

with source as (
    select * from "dbttest"."dev"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
13:59:36.463860 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.raw_orders" does not exist
LINE 14:     select * from "dbttest"."dev"."raw_orders"
                           ^

13:59:36.463920 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: ROLLBACK
13:59:36.464077 [debug] [Thread-1 (]: finished collecting timing info
13:59:36.464134 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
13:59:36.464242 [debug] [Thread-1 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "dev.raw_orders" does not exist
  LINE 14:     select * from "dbttest"."dev"."raw_orders"
                             ^
  compiled SQL at target/run/jaffle_shop/models/staging/stg_orders.sql
13:59:36.464334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecfb680c-c127-44b6-ac2d-9eaadca21ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b17e0>]}
13:59:36.464451 [error] [Thread-1 (]: 2 of 6 ERROR creating view model dev.stg_orders ................................ [[31mERROR[0m in 0.01s]
13:59:36.464593 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
13:59:36.464665 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
13:59:36.464866 [info ] [Thread-1 (]: 3 of 6 START view model dev.stg_payments ....................................... [RUN]
13:59:36.465052 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.stg_payments"
13:59:36.465118 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
13:59:36.465175 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_payments
13:59:36.466271 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
13:59:36.466676 [debug] [Thread-1 (]: finished collecting timing info
13:59:36.466740 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
13:59:36.467710 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.stg_payments"
13:59:36.467963 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
13:59:36.468018 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
13:59:36.468067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:59:36.473879 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
13:59:36.473949 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
13:59:36.474001 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbttest"."dev"."stg_payments__dbt_tmp" as (
    with source as (
    select * from "dbttest"."dev"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        --`amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
13:59:36.474830 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.raw_payments" does not exist
LINE 5:     select * from "dbttest"."dev"."raw_payments"
                          ^

13:59:36.474894 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: ROLLBACK
13:59:36.475101 [debug] [Thread-1 (]: finished collecting timing info
13:59:36.475159 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
13:59:36.475280 [debug] [Thread-1 (]: Database Error in model stg_payments (models/staging/stg_payments.sql)
  relation "dev.raw_payments" does not exist
  LINE 5:     select * from "dbttest"."dev"."raw_payments"
                            ^
  compiled SQL at target/run/jaffle_shop/models/staging/stg_payments.sql
13:59:36.475403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecfb680c-c127-44b6-ac2d-9eaadca21ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061447f0>]}
13:59:36.475537 [error] [Thread-1 (]: 3 of 6 ERROR creating view model dev.stg_payments .............................. [[31mERROR[0m in 0.01s]
13:59:36.475701 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
13:59:36.475779 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_orders
13:59:36.475972 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_orders
13:59:36.476067 [debug] [Thread-1 (]: Began running node model.jaffle_shop.hidden_model
13:59:36.476170 [info ] [Thread-1 (]: 4 of 6 SKIP relation dev.hidden_model .......................................... [[33mSKIP[0m]
13:59:36.476316 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.hidden_model
13:59:36.476384 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_payments
13:59:36.476483 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_payments
13:59:36.476550 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payments
13:59:36.476664 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payments
13:59:36.476736 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
13:59:36.476831 [info ] [Thread-1 (]: 5 of 6 SKIP relation dev.dim_customers ......................................... [[33mSKIP[0m]
13:59:36.476965 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
13:59:36.477028 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
13:59:36.477103 [info ] [Thread-1 (]: 6 of 6 SKIP relation dev.fct_orders ............................................ [[33mSKIP[0m]
13:59:36.477242 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
13:59:36.477669 [debug] [MainThread]: Acquiring new postgres connection "master"
13:59:36.477753 [debug] [MainThread]: Using postgres connection "master"
13:59:36.477806 [debug] [MainThread]: On master: BEGIN
13:59:36.477856 [debug] [MainThread]: Opening a new connection, currently in state closed
13:59:36.488947 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:59:36.489041 [debug] [MainThread]: On master: COMMIT
13:59:36.489099 [debug] [MainThread]: Using postgres connection "master"
13:59:36.489151 [debug] [MainThread]: On master: COMMIT
13:59:36.489373 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:59:36.489434 [debug] [MainThread]: On master: Close
13:59:36.489579 [info ] [MainThread]: 
13:59:36.489684 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.17s.
13:59:36.489776 [debug] [MainThread]: Connection 'master' was properly closed.
13:59:36.489826 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
13:59:36.494927 [info ] [MainThread]: 
13:59:36.495052 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
13:59:36.495160 [info ] [MainThread]: 
13:59:36.495251 [error] [MainThread]: [33mDatabase Error in model stg_customers (models/staging/stg_customers.sql)[0m
13:59:36.495341 [error] [MainThread]:   relation "dev.raw_customers" does not exist
13:59:36.495424 [error] [MainThread]:   LINE 5:     select * from "dbttest"."dev"."raw_customers"
13:59:36.495506 [error] [MainThread]:                             ^
13:59:36.495590 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/staging/stg_customers.sql
13:59:36.495676 [info ] [MainThread]: 
13:59:36.495759 [error] [MainThread]: [33mDatabase Error in model stg_orders (models/staging/stg_orders.sql)[0m
13:59:36.495842 [error] [MainThread]:   relation "dev.raw_orders" does not exist
13:59:36.495923 [error] [MainThread]:   LINE 14:     select * from "dbttest"."dev"."raw_orders"
13:59:36.496003 [error] [MainThread]:                              ^
13:59:36.496091 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/staging/stg_orders.sql
13:59:36.496172 [info ] [MainThread]: 
13:59:36.496254 [error] [MainThread]: [33mDatabase Error in model stg_payments (models/staging/stg_payments.sql)[0m
13:59:36.496337 [error] [MainThread]:   relation "dev.raw_payments" does not exist
13:59:36.496417 [error] [MainThread]:   LINE 5:     select * from "dbttest"."dev"."raw_payments"
13:59:36.496497 [error] [MainThread]:                             ^
13:59:36.496577 [error] [MainThread]:   compiled SQL at target/run/jaffle_shop/models/staging/stg_payments.sql
13:59:36.496674 [info ] [MainThread]: 
13:59:36.496761 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=3 TOTAL=6
13:59:36.496889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b1330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b14b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106146770>]}


============================== 2022-08-11 14:08:19.083845 | 507efbcb-7471-45d5-8fbd-59c26356ee2e ==============================
14:08:19.083876 [info ] [MainThread]: Running with dbt=1.1.1
14:08:19.084396 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
14:08:19.084512 [debug] [MainThread]: Tracking: tracking
14:08:19.105725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103de7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dfe3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dffca0>]}
14:08:19.115055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dffb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dfe110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dfc5b0>]}


============================== 2022-08-11 14:10:42.263946 | 69c1789d-9a66-4b3f-a4b2-c3e743c42480 ==============================
14:10:42.263946 [info ] [MainThread]: Running with dbt=1.0.0
14:10:42.265256 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/Users/darren.price/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
14:10:42.265408 [debug] [MainThread]: Tracking: tracking
14:10:42.282002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103aa7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ae1de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ae18a0>]}
14:10:42.326199 [debug] [MainThread]: Executing "git --help"
14:10:42.359765 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
14:10:42.360420 [debug] [MainThread]: STDERR: "b''"
14:10:42.363233 [debug] [MainThread]: Acquiring new postgres connection "debug"
14:10:42.363962 [debug] [MainThread]: Using postgres connection "debug"
14:10:42.364096 [debug] [MainThread]: On debug: select 1 as id
14:10:42.364238 [debug] [MainThread]: Opening a new connection, currently in state init
14:10:42.417200 [debug] [MainThread]: SQL status: SELECT 1 in 0.05 seconds
14:10:42.418338 [debug] [MainThread]: On debug: Close
14:10:42.418655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc2b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc0a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc0130>]}
14:10:42.857579 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-08-11 14:14:38.252786 | e8573dd4-1717-491d-9244-ef73720b8be5 ==============================
[0m14:14:38.252793 [info ] [MainThread]: Running with dbt=1.2.0
[0m14:14:38.253170 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m14:14:38.253234 [debug] [MainThread]: Tracking: tracking
[0m14:14:38.270462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037d75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10389c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10389ca90>]}
[0m14:14:38.272521 [debug] [MainThread]: Set downloads directory='/var/folders/v7/1zrhqbhd3g36bdl87kskrlg40000gp/T/dbt-downloads-32uknkhb'
[0m14:14:38.272934 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:14:38.408065 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:14:38.408315 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:14:38.506204 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:14:38.542174 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:14:39.064459 [info ] [MainThread]:   Installed from version 0.8.6
[0m14:14:39.064664 [info ] [MainThread]:   Up to date!
[0m14:14:39.064816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e8573dd4-1717-491d-9244-ef73720b8be5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10389d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10389d5a0>]}
[0m14:14:39.065389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037d7e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038259f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103824220>]}


============================== 2022-08-11 14:14:52.130915 | 6b5e7656-c00d-45c1-852a-a656fb59d491 ==============================
[0m14:14:52.130937 [info ] [MainThread]: Running with dbt=1.2.0
[0m14:14:52.131269 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m14:14:52.131365 [debug] [MainThread]: Tracking: tracking
[0m14:14:52.148524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059125c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105913b50>]}
[0m14:14:52.185053 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.1.1. Current version: 1.2.0.
[0m14:14:52.185261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b5e7656-c00d-45c1-852a-a656fb59d491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105903c10>]}
[0m14:14:52.248172 [debug] [MainThread]: Parsing macros/example_macro.sql
[0m14:14:52.248601 [debug] [MainThread]: Parsing macros/catalog.sql
[0m14:14:52.250272 [debug] [MainThread]: Parsing macros/relations.sql
[0m14:14:52.250970 [debug] [MainThread]: Parsing macros/adapters.sql
[0m14:14:52.263020 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m14:14:52.263812 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m14:14:52.264080 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m14:14:52.264724 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m14:14:52.267808 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m14:14:52.268016 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m14:14:52.268544 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m14:14:52.268985 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m14:14:52.270619 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m14:14:52.271580 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m14:14:52.272293 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m14:14:52.279877 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m14:14:52.286021 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m14:14:52.291704 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m14:14:52.293627 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m14:14:52.294361 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m14:14:52.295095 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m14:14:52.296907 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m14:14:52.304627 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m14:14:52.305254 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m14:14:52.309318 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m14:14:52.316323 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m14:14:52.318680 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m14:14:52.319843 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m14:14:52.322193 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m14:14:52.322715 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m14:14:52.324124 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m14:14:52.325046 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m14:14:52.328043 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m14:14:52.336243 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m14:14:52.336847 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m14:14:52.337868 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m14:14:52.338574 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m14:14:52.338993 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m14:14:52.339339 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m14:14:52.339624 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m14:14:52.340202 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m14:14:52.342064 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m14:14:52.345756 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m14:14:52.346087 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m14:14:52.346588 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m14:14:52.346980 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m14:14:52.347356 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m14:14:52.347861 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m14:14:52.348179 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m14:14:52.348600 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m14:14:52.349040 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m14:14:52.350085 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m14:14:52.350584 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m14:14:52.351026 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m14:14:52.351454 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m14:14:52.351866 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m14:14:52.352233 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m14:14:52.352662 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m14:14:52.353025 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m14:14:52.355473 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m14:14:52.355844 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m14:14:52.356603 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m14:14:52.357470 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m14:14:52.357887 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m14:14:52.358803 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m14:14:52.359884 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m14:14:52.366271 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m14:14:52.367454 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m14:14:52.373171 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m14:14:52.374995 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m14:14:52.378177 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m14:14:52.382289 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m14:14:52.383508 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m14:14:52.383913 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m14:14:52.384409 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m14:14:52.384860 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m14:14:52.387221 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m14:14:52.387678 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m14:14:52.388722 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m14:14:52.389227 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m14:14:52.390383 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m14:14:52.390785 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m14:14:52.391580 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m14:14:52.392519 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m14:14:52.396442 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m14:14:52.400896 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m14:14:52.401624 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m14:14:52.402177 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m14:14:52.402742 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m14:14:52.403393 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m14:14:52.403891 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m14:14:52.404507 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m14:14:52.404933 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m14:14:52.406286 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m14:14:52.408635 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m14:14:52.409372 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m14:14:52.410043 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m14:14:52.411582 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m14:14:52.414276 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m14:14:52.414886 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m14:14:52.416075 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m14:14:52.416887 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m14:14:52.417729 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m14:14:52.429009 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m14:14:52.429853 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m14:14:52.430952 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m14:14:52.431586 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m14:14:52.432334 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m14:14:52.433010 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m14:14:52.433965 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m14:14:52.434678 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m14:14:52.435170 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m14:14:52.436261 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m14:14:52.437148 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m14:14:52.437725 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m14:14:52.438235 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m14:14:52.439417 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m14:14:52.440284 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m14:14:52.441028 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m14:14:52.441942 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m14:14:52.443207 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m14:14:52.443792 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m14:14:52.445331 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m14:14:52.449545 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m14:14:52.449991 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m14:14:52.450473 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m14:14:52.450917 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m14:14:52.451395 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m14:14:52.453150 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m14:14:52.453977 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m14:14:52.455409 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m14:14:52.457197 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m14:14:52.458627 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m14:14:52.459302 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m14:14:52.460880 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m14:14:52.464424 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m14:14:52.469575 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m14:14:52.470117 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m14:14:52.473232 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m14:14:52.474693 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m14:14:52.475406 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m14:14:52.476113 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m14:14:52.479184 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m14:14:52.481813 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m14:14:52.483738 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m14:14:52.484970 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m14:14:52.485996 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m14:14:52.486745 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m14:14:52.647180 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers.sql
[0m14:14:52.652109 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payments.sql
[0m14:14:52.653121 [debug] [MainThread]: 1603: static parser failed on staging/stg_orders.sql
[0m14:14:52.655250 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_orders.sql
[0m14:14:52.655900 [debug] [MainThread]: 1699: static parser successfully parsed staging/hidden_model.sql
[0m14:14:52.657060 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/dim_customers.sql
[0m14:14:52.658311 [debug] [MainThread]: 1603: static parser failed on marts/core/fct_orders.sql
[0m14:14:52.660636 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/core/fct_orders.sql
[0m14:14:52.661144 [debug] [MainThread]: 1603: static parser failed on marts/core/intermediate/order_payments.sql
[0m14:14:52.663079 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/core/intermediate/order_payments.sql
[0m14:14:52.663621 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/intermediate/customer_payments.sql
[0m14:14:52.664772 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/intermediate/customer_orders.sql
[0m14:14:52.786157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b5e7656-c00d-45c1-852a-a656fb59d491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b317e0>]}
[0m14:14:52.792799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b5e7656-c00d-45c1-852a-a656fb59d491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105913a60>]}
[0m14:14:52.792942 [info ] [MainThread]: Found 9 models, 23 tests, 0 snapshots, 1 analysis, 494 macros, 0 operations, 3 seed files, 2 sources, 3 exposures, 2 metrics
[0m14:14:52.793061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b5e7656-c00d-45c1-852a-a656fb59d491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105910f40>]}
[0m14:14:52.794001 [info ] [MainThread]: 
[0m14:14:52.794201 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m14:14:52.794552 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbttest"
[0m14:14:52.798755 [debug] [ThreadPool]: Using postgres connection "list_dbttest"
[0m14:14:52.798849 [debug] [ThreadPool]: On list_dbttest: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "connection_name": "list_dbttest"} */

    select distinct nspname from pg_namespace
  
[0m14:14:52.798908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:52.846212 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.05 seconds
[0m14:14:52.847003 [debug] [ThreadPool]: On list_dbttest: Close
[0m14:14:52.847754 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbttest_dev"
[0m14:14:52.851069 [debug] [ThreadPool]: Using postgres connection "list_dbttest_dev"
[0m14:14:52.851166 [debug] [ThreadPool]: On list_dbttest_dev: BEGIN
[0m14:14:52.851233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:52.858080 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m14:14:52.858169 [debug] [ThreadPool]: Using postgres connection "list_dbttest_dev"
[0m14:14:52.858227 [debug] [ThreadPool]: On list_dbttest_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "connection_name": "list_dbttest_dev"} */
select
      'dbttest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbttest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m14:14:52.865576 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m14:14:52.866163 [debug] [ThreadPool]: On list_dbttest_dev: ROLLBACK
[0m14:14:52.866377 [debug] [ThreadPool]: On list_dbttest_dev: Close
[0m14:14:52.869275 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:52.869367 [debug] [MainThread]: On master: BEGIN
[0m14:14:52.869429 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:52.874137 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:14:52.874211 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:52.874268 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:14:52.887746 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
[0m14:14:52.888353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b5e7656-c00d-45c1-852a-a656fb59d491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f44700>]}
[0m14:14:52.888504 [debug] [MainThread]: On master: ROLLBACK
[0m14:14:52.888703 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:52.888770 [debug] [MainThread]: On master: BEGIN
[0m14:14:52.889088 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:14:52.889165 [debug] [MainThread]: On master: COMMIT
[0m14:14:52.889224 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:52.889282 [debug] [MainThread]: On master: COMMIT
[0m14:14:52.889441 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:14:52.889512 [debug] [MainThread]: On master: Close
[0m14:14:52.889669 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:14:52.889796 [info ] [MainThread]: 
[0m14:14:52.892783 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m14:14:52.892941 [info ] [Thread-1 (]: 1 of 3 START seed file dev.raw_customers ....................................... [RUN]
[0m14:14:52.893159 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.raw_customers"
[0m14:14:52.893235 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m14:14:52.893319 [debug] [Thread-1 (]: finished collecting timing info
[0m14:14:52.893386 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m14:14:52.910638 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m14:14:52.910728 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: BEGIN
[0m14:14:52.910788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:52.922478 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m14:14:52.922555 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m14:14:52.922613 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */

    create table "dbttest"."dev"."raw_customers" ("id" integer,"first_name" text,"last_name" text,"email" text)
  
[0m14:14:52.934353 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.01 seconds
[0m14:14:52.968580 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m14:14:52.968680 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: 
          insert into "dbttest"."dev"."raw_customers" ("id", "first_name", "last_name", "email") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
[0m14:14:52.970907 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.0 seconds
[0m14:14:52.973508 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m14:14:52.982607 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m14:14:52.982688 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_customers"
[0m14:14:52.982743 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m14:14:52.984836 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:14:52.985032 [debug] [Thread-1 (]: finished collecting timing info
[0m14:14:52.985101 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m14:14:52.985260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b5e7656-c00d-45c1-852a-a656fb59d491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b32830>]}
[0m14:14:52.985372 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file dev.raw_customers ................................... [[32mINSERT 100[0m in 0.09s]
[0m14:14:52.985535 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m14:14:52.985610 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_orders
[0m14:14:52.985703 [info ] [Thread-1 (]: 2 of 3 START seed file dev.raw_orders .......................................... [RUN]
[0m14:14:52.985855 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.raw_orders"
[0m14:14:52.985912 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m14:14:52.985966 [debug] [Thread-1 (]: finished collecting timing info
[0m14:14:52.986019 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_orders
[0m14:14:52.990008 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:14:52.990072 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: BEGIN
[0m14:14:52.990122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:52.997697 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m14:14:52.997793 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:14:52.997842 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */

    create table "dbttest"."dev"."raw_orders" ("id" integer,"user_id" integer,"order_date" date,"status" text)
  
[0m14:14:53.004816 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.01 seconds
[0m14:14:53.028710 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:14:53.028781 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: 
          insert into "dbttest"."dev"."raw_orders" ("id", "user_id", "order_date", "status") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s...
[0m14:14:53.031229 [debug] [Thread-1 (]: SQL status: INSERT 0 99 in 0.0 seconds
[0m14:14:53.031418 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m14:14:53.032332 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m14:14:53.032393 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_orders"
[0m14:14:53.032444 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m14:14:53.033255 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:14:53.033415 [debug] [Thread-1 (]: finished collecting timing info
[0m14:14:53.033476 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_orders: Close
[0m14:14:53.033627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b5e7656-c00d-45c1-852a-a656fb59d491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ca1db0>]}
[0m14:14:53.033734 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file dev.raw_orders ...................................... [[32mINSERT 99[0m in 0.05s]
[0m14:14:53.033887 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_orders
[0m14:14:53.033963 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_payments
[0m14:14:53.034057 [info ] [Thread-1 (]: 3 of 3 START seed file dev.raw_payments ........................................ [RUN]
[0m14:14:53.034206 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.jaffle_shop.raw_payments"
[0m14:14:53.034299 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m14:14:53.034353 [debug] [Thread-1 (]: finished collecting timing info
[0m14:14:53.034407 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_payments
[0m14:14:53.038216 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m14:14:53.038276 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_payments: BEGIN
[0m14:14:53.038325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:53.048532 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m14:14:53.048612 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m14:14:53.048661 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */

    create table "dbttest"."dev"."raw_payments" ("id" integer,"order_id" integer,"payment_method" text,"amount" integer)
  
[0m14:14:53.057061 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.01 seconds
[0m14:14:53.084218 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m14:14:53.084286 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_payments: 
          insert into "dbttest"."dev"."raw_payments" ("id", "order_id", "payment_method", "amount") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%...
[0m14:14:53.086632 [debug] [Thread-1 (]: SQL status: INSERT 0 113 in 0.0 seconds
[0m14:14:53.086813 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m14:14:53.087751 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_payments: COMMIT
[0m14:14:53.087823 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.raw_payments"
[0m14:14:53.087874 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_payments: COMMIT
[0m14:14:53.088841 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:14:53.089001 [debug] [Thread-1 (]: finished collecting timing info
[0m14:14:53.089062 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_payments: Close
[0m14:14:53.089211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b5e7656-c00d-45c1-852a-a656fb59d491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c21ae0>]}
[0m14:14:53.089315 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file dev.raw_payments .................................... [[32mINSERT 113[0m in 0.06s]
[0m14:14:53.089466 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_payments
[0m14:14:53.089895 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m14:14:53.089973 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:53.090026 [debug] [MainThread]: On master: BEGIN
[0m14:14:53.090075 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:14:53.098722 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m14:14:53.098808 [debug] [MainThread]: On master: COMMIT
[0m14:14:53.098861 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:53.098908 [debug] [MainThread]: On master: COMMIT
[0m14:14:53.099106 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:14:53.099166 [debug] [MainThread]: On master: Close
[0m14:14:53.099305 [info ] [MainThread]: 
[0m14:14:53.099404 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m14:14:53.099495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:53.099543 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m14:14:53.105537 [info ] [MainThread]: 
[0m14:14:53.105649 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:14:53.105756 [info ] [MainThread]: 
[0m14:14:53.105845 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:14:53.105968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c20940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f450c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f38d00>]}


============================== 2022-08-11 14:15:00.700984 | 5cec97ae-de5b-45c4-ae0f-a37ef39b85a1 ==============================
[0m14:15:00.701025 [info ] [MainThread]: Running with dbt=1.2.0
[0m14:15:00.701427 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:15:00.701508 [debug] [MainThread]: Tracking: tracking
[0m14:15:00.718526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084425c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d887c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108443bb0>]}
[0m14:15:00.797490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:00.797620 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:00.801489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cec97ae-de5b-45c4-ae0f-a37ef39b85a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086daa10>]}
[0m14:15:00.808113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cec97ae-de5b-45c4-ae0f-a37ef39b85a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10869aec0>]}
[0m14:15:00.808263 [info ] [MainThread]: Found 9 models, 23 tests, 0 snapshots, 1 analysis, 494 macros, 0 operations, 3 seed files, 2 sources, 3 exposures, 2 metrics
[0m14:15:00.808380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cec97ae-de5b-45c4-ae0f-a37ef39b85a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108433190>]}
[0m14:15:00.809288 [info ] [MainThread]: 
[0m14:15:00.809498 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m14:15:00.809912 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbttest"
[0m14:15:00.814306 [debug] [ThreadPool]: Using postgres connection "list_dbttest"
[0m14:15:00.814389 [debug] [ThreadPool]: On list_dbttest: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "connection_name": "list_dbttest"} */

    select distinct nspname from pg_namespace
  
[0m14:15:00.814449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:00.820371 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m14:15:00.820967 [debug] [ThreadPool]: On list_dbttest: Close
[0m14:15:00.821532 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbttest_dev"
[0m14:15:00.824115 [debug] [ThreadPool]: Using postgres connection "list_dbttest_dev"
[0m14:15:00.824221 [debug] [ThreadPool]: On list_dbttest_dev: BEGIN
[0m14:15:00.824299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:00.830937 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m14:15:00.831020 [debug] [ThreadPool]: Using postgres connection "list_dbttest_dev"
[0m14:15:00.831074 [debug] [ThreadPool]: On list_dbttest_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "connection_name": "list_dbttest_dev"} */
select
      'dbttest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbttest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m14:15:00.837410 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m14:15:00.837989 [debug] [ThreadPool]: On list_dbttest_dev: ROLLBACK
[0m14:15:00.838192 [debug] [ThreadPool]: On list_dbttest_dev: Close
[0m14:15:00.840531 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:00.840621 [debug] [MainThread]: On master: BEGIN
[0m14:15:00.840682 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:00.855816 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m14:15:00.855887 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:00.855942 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:15:00.871774 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
[0m14:15:00.872305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cec97ae-de5b-45c4-ae0f-a37ef39b85a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108737b80>]}
[0m14:15:00.872445 [debug] [MainThread]: On master: ROLLBACK
[0m14:15:00.872696 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:00.872760 [debug] [MainThread]: On master: BEGIN
[0m14:15:00.873199 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:15:00.873273 [debug] [MainThread]: On master: COMMIT
[0m14:15:00.873344 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:00.873408 [debug] [MainThread]: On master: COMMIT
[0m14:15:00.873563 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:15:00.873640 [debug] [MainThread]: On master: Close
[0m14:15:00.873797 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:15:00.873920 [info ] [MainThread]: 
[0m14:15:00.877316 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m14:15:00.877458 [info ] [Thread-1 (]: 1 of 6 START view model dev.stg_customers ...................................... [RUN]
[0m14:15:00.877671 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.stg_customers"
[0m14:15:00.877745 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m14:15:00.877820 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_customers
[0m14:15:00.879445 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m14:15:00.879936 [debug] [Thread-1 (]: finished collecting timing info
[0m14:15:00.880015 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m14:15:00.897326 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.stg_customers"
[0m14:15:00.897800 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m14:15:00.897870 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m14:15:00.897924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:00.902713 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:15:00.902813 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m14:15:00.902866 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbttest"."dev"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "dbttest"."dev"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name,
        email

    from source

)

select * from renamed
  );
[0m14:15:00.907742 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:15:00.911437 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m14:15:00.911522 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbttest"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m14:15:00.911942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:15:00.919280 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m14:15:00.919359 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m14:15:00.919417 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m14:15:00.920523 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:15:00.922648 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m14:15:00.922722 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest"."dev"."stg_customers__dbt_backup" cascade
[0m14:15:00.922934 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:15:00.923380 [debug] [Thread-1 (]: finished collecting timing info
[0m14:15:00.923455 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m14:15:00.923624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cec97ae-de5b-45c4-ae0f-a37ef39b85a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108786bc0>]}
[0m14:15:00.923771 [info ] [Thread-1 (]: 1 of 6 OK created view model dev.stg_customers ................................. [[32mCREATE VIEW[0m in 0.05s]
[0m14:15:00.923942 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m14:15:00.924021 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m14:15:00.924103 [info ] [Thread-1 (]: 2 of 6 START view model dev.stg_orders ......................................... [RUN]
[0m14:15:00.924259 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.stg_orders"
[0m14:15:00.924317 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m14:15:00.924375 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_orders
[0m14:15:00.926143 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m14:15:00.926572 [debug] [Thread-1 (]: finished collecting timing info
[0m14:15:00.926644 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m14:15:00.928214 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.stg_orders"
[0m14:15:00.928486 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m14:15:00.928542 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m14:15:00.928591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:00.932220 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:15:00.932290 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m14:15:00.932338 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbttest"."dev"."stg_orders__dbt_tmp" as (
    /*
hack for example macro references:
    

    The provided args are abc and 123


*/

with source as (
    select * from "dbttest"."dev"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
[0m14:15:00.934555 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:15:00.935658 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m14:15:00.935724 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbttest"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:15:00.936267 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:15:00.936831 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m14:15:00.936902 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m14:15:00.936954 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m14:15:00.937666 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:15:00.938489 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m14:15:00.938553 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest"."dev"."stg_orders__dbt_backup" cascade
[0m14:15:00.938802 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:15:00.939183 [debug] [Thread-1 (]: finished collecting timing info
[0m14:15:00.939248 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m14:15:00.939388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cec97ae-de5b-45c4-ae0f-a37ef39b85a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108725f00>]}
[0m14:15:00.939513 [info ] [Thread-1 (]: 2 of 6 OK created view model dev.stg_orders .................................... [[32mCREATE VIEW[0m in 0.02s]
[0m14:15:00.939663 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m14:15:00.939734 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m14:15:00.939888 [info ] [Thread-1 (]: 3 of 6 START view model dev.stg_payments ....................................... [RUN]
[0m14:15:00.940043 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.stg_payments"
[0m14:15:00.940097 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m14:15:00.940149 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_payments
[0m14:15:00.941952 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m14:15:00.943491 [debug] [Thread-1 (]: finished collecting timing info
[0m14:15:00.943557 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m14:15:00.945112 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.stg_payments"
[0m14:15:00.945435 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m14:15:00.945497 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m14:15:00.945547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:00.950498 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:15:00.950580 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m14:15:00.950631 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbttest"."dev"."stg_payments__dbt_tmp" as (
    with source as (
    select * from "dbttest"."dev"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        --`amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
[0m14:15:00.955696 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m14:15:00.957013 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m14:15:00.957080 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbttest"."dev"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m14:15:00.965818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m14:15:00.966374 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m14:15:00.966440 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m14:15:00.966492 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m14:15:00.987233 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m14:15:00.988283 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m14:15:00.988355 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest"."dev"."stg_payments__dbt_backup" cascade
[0m14:15:00.988622 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:15:00.989101 [debug] [Thread-1 (]: finished collecting timing info
[0m14:15:00.989182 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m14:15:00.989363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cec97ae-de5b-45c4-ae0f-a37ef39b85a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c3640>]}
[0m14:15:00.989523 [info ] [Thread-1 (]: 3 of 6 OK created view model dev.stg_payments .................................. [[32mCREATE VIEW[0m in 0.05s]
[0m14:15:00.989707 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m14:15:00.989795 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_orders
[0m14:15:00.990020 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.customer_orders"
[0m14:15:00.990116 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customer_orders
[0m14:15:00.990192 [debug] [Thread-1 (]: Compiling model.jaffle_shop.customer_orders
[0m14:15:00.991630 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customer_orders"
[0m14:15:00.992968 [debug] [Thread-1 (]: finished collecting timing info
[0m14:15:00.993155 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_orders
[0m14:15:00.993236 [debug] [Thread-1 (]: Began running node model.jaffle_shop.hidden_model
[0m14:15:00.993361 [info ] [Thread-1 (]: 4 of 6 START view model dev.hidden_model ....................................... [RUN]
[0m14:15:00.993559 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.hidden_model"
[0m14:15:00.993627 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.hidden_model
[0m14:15:00.993689 [debug] [Thread-1 (]: Compiling model.jaffle_shop.hidden_model
[0m14:15:00.995213 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.hidden_model"
[0m14:15:00.995569 [debug] [Thread-1 (]: finished collecting timing info
[0m14:15:00.995645 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.hidden_model
[0m14:15:00.998363 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.hidden_model"
[0m14:15:00.998715 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.hidden_model"
[0m14:15:00.998785 [debug] [Thread-1 (]: On model.jaffle_shop.hidden_model: BEGIN
[0m14:15:00.998844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:01.003444 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:15:01.003519 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.hidden_model"
[0m14:15:01.003577 [debug] [Thread-1 (]: On model.jaffle_shop.hidden_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.hidden_model"} */

  create view "dbttest"."dev"."hidden_model__dbt_tmp" as (
    -- hack for DAG viz
-- "dbttest"."dev"."raw_orders"

select * from "dbttest"."dev"."stg_orders"
  );
[0m14:15:01.010766 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m14:15:01.012233 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.hidden_model"
[0m14:15:01.012305 [debug] [Thread-1 (]: On model.jaffle_shop.hidden_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.hidden_model"} */
alter table "dbttest"."dev"."hidden_model__dbt_tmp" rename to "hidden_model"
[0m14:15:01.012632 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:15:01.013233 [debug] [Thread-1 (]: On model.jaffle_shop.hidden_model: COMMIT
[0m14:15:01.013302 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.hidden_model"
[0m14:15:01.013361 [debug] [Thread-1 (]: On model.jaffle_shop.hidden_model: COMMIT
[0m14:15:01.014525 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:15:01.015563 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.hidden_model"
[0m14:15:01.015629 [debug] [Thread-1 (]: On model.jaffle_shop.hidden_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.hidden_model"} */
drop view if exists "dbttest"."dev"."hidden_model__dbt_backup" cascade
[0m14:15:01.016144 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:15:01.016612 [debug] [Thread-1 (]: finished collecting timing info
[0m14:15:01.016691 [debug] [Thread-1 (]: On model.jaffle_shop.hidden_model: Close
[0m14:15:01.016867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cec97ae-de5b-45c4-ae0f-a37ef39b85a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108810400>]}
[0m14:15:01.017023 [info ] [Thread-1 (]: 4 of 6 OK created view model dev.hidden_model .................................. [[32mCREATE VIEW[0m in 0.02s]
[0m14:15:01.017200 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.hidden_model
[0m14:15:01.017284 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_payments
[0m14:15:01.017457 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.customer_payments"
[0m14:15:01.017541 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customer_payments
[0m14:15:01.017611 [debug] [Thread-1 (]: Compiling model.jaffle_shop.customer_payments
[0m14:15:01.019172 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customer_payments"
[0m14:15:01.019716 [debug] [Thread-1 (]: finished collecting timing info
[0m14:15:01.019888 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_payments
[0m14:15:01.019971 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payments
[0m14:15:01.020134 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.order_payments"
[0m14:15:01.020255 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payments
[0m14:15:01.020333 [debug] [Thread-1 (]: Compiling model.jaffle_shop.order_payments
[0m14:15:01.022014 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payments"
[0m14:15:01.022436 [debug] [Thread-1 (]: finished collecting timing info
[0m14:15:01.022598 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payments
[0m14:15:01.022680 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m14:15:01.022806 [info ] [Thread-1 (]: 5 of 6 START table model dev.dim_customers ..................................... [RUN]
[0m14:15:01.023014 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.dim_customers"
[0m14:15:01.023078 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m14:15:01.023138 [debug] [Thread-1 (]: Compiling model.jaffle_shop.dim_customers
[0m14:15:01.031196 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m14:15:01.031941 [debug] [Thread-1 (]: finished collecting timing info
[0m14:15:01.032019 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m14:15:01.042253 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.dim_customers"
[0m14:15:01.044710 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m14:15:01.044780 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m14:15:01.044837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:01.058117 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m14:15:01.058202 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m14:15:01.058260 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */


  create  table "dbttest"."dev"."dim_customers__dbt_tmp"
  as (
    with  __dbt__cte__customer_orders as (
with orders as (

    select * from "dbttest"."dev"."stg_orders"

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

)

select * from final
),  __dbt__cte__customer_payments as (
with payments as (

    select * from "dbttest"."dev"."stg_payments"

),

orders as (

    select * from "dbttest"."dev"."stg_orders"

),

final as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders using (order_id)

    group by 1

)

select * from final
),customers as (

    select * from "dbttest"."dev"."stg_customers"

),

customer_orders as (

    select * from __dbt__cte__customer_orders

),

customer_payments as (

    select * from __dbt__cte__customer_payments

),

final as (

    select
        customers.customer_id,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders using (customer_id)

    left join customer_payments using (customer_id)

)

select * from final
  );
[0m14:15:01.072702 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.01 seconds
[0m14:15:01.074215 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m14:15:01.074300 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbttest"."dev"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m14:15:01.075010 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:15:01.077778 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m14:15:01.077866 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m14:15:01.077933 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m14:15:01.078886 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:15:01.079883 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m14:15:01.079954 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbttest"."dev"."dim_customers__dbt_backup" cascade
[0m14:15:01.080397 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:15:01.080913 [debug] [Thread-1 (]: finished collecting timing info
[0m14:15:01.080997 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m14:15:01.081183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cec97ae-de5b-45c4-ae0f-a37ef39b85a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108726560>]}
[0m14:15:01.081350 [info ] [Thread-1 (]: 5 of 6 OK created table model dev.dim_customers ................................ [[32mSELECT 100[0m in 0.06s]
[0m14:15:01.081557 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m14:15:01.081646 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m14:15:01.081784 [info ] [Thread-1 (]: 6 of 6 START table model dev.fct_orders ........................................ [RUN]
[0m14:15:01.081995 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.fct_orders"
[0m14:15:01.082070 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m14:15:01.082140 [debug] [Thread-1 (]: Compiling model.jaffle_shop.fct_orders
[0m14:15:01.087612 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m14:15:01.088214 [debug] [Thread-1 (]: finished collecting timing info
[0m14:15:01.088298 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m14:15:01.090184 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.fct_orders"
[0m14:15:01.090463 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m14:15:01.090524 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m14:15:01.090584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:01.097757 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m14:15:01.097841 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m14:15:01.097900 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */


  create  table "dbttest"."dev"."fct_orders__dbt_tmp"
  as (
    

with  __dbt__cte__order_payments as (


with payments as (

    select * from "dbttest"."dev"."stg_payments"

),

final as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by 1

)

select * from final
),orders as (

    select * from "dbttest"."dev"."stg_orders"

),

order_payments as (

    select * from __dbt__cte__order_payments

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
[0m14:15:01.108385 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.01 seconds
[0m14:15:01.110729 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m14:15:01.110807 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbttest"."dev"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m14:15:01.111519 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:15:01.112222 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m14:15:01.112296 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m14:15:01.112357 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m14:15:01.113608 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:15:01.114603 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m14:15:01.114671 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest"."dev"."fct_orders__dbt_backup" cascade
[0m14:15:01.114911 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:15:01.115377 [debug] [Thread-1 (]: finished collecting timing info
[0m14:15:01.115458 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m14:15:01.115641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cec97ae-de5b-45c4-ae0f-a37ef39b85a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108863c70>]}
[0m14:15:01.115800 [info ] [Thread-1 (]: 6 of 6 OK created table model dev.fct_orders ................................... [[32mSELECT 99[0m in 0.03s]
[0m14:15:01.116005 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m14:15:01.116491 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m14:15:01.116589 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:01.116656 [debug] [MainThread]: On master: BEGIN
[0m14:15:01.116717 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:01.122559 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m14:15:01.122649 [debug] [MainThread]: On master: COMMIT
[0m14:15:01.122721 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:01.122786 [debug] [MainThread]: On master: COMMIT
[0m14:15:01.123034 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:15:01.123101 [debug] [MainThread]: On master: Close
[0m14:15:01.123258 [info ] [MainThread]: 
[0m14:15:01.123372 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m14:15:01.123479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:01.123537 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
[0m14:15:01.130136 [info ] [MainThread]: 
[0m14:15:01.130265 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:01.130379 [info ] [MainThread]: 
[0m14:15:01.130475 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:15:01.130601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10869ab30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10882b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108868dc0>]}


============================== 2022-08-12 09:44:38.145856 | 1ddb17a8-c7ac-4873-bd34-f12822ecd463 ==============================
[0m09:44:38.146015 [info ] [MainThread]: Running with dbt=1.2.0
[0m09:44:38.146862 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:44:38.146955 [debug] [MainThread]: Tracking: tracking
[0m09:44:38.182409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10411ec80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10411d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10411e950>]}
[0m09:44:38.225031 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:44:38.225290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1ddb17a8-c7ac-4873-bd34-f12822ecd463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103af9e70>]}
[0m09:44:38.323631 [debug] [MainThread]: Parsing macros/example_macro.sql
[0m09:44:38.324144 [debug] [MainThread]: Parsing macros/catalog.sql
[0m09:44:38.326648 [debug] [MainThread]: Parsing macros/relations.sql
[0m09:44:38.327441 [debug] [MainThread]: Parsing macros/adapters.sql
[0m09:44:38.339933 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m09:44:38.340781 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m09:44:38.341042 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m09:44:38.341784 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m09:44:38.345137 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m09:44:38.345448 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m09:44:38.346029 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m09:44:38.346475 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m09:44:38.348131 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m09:44:38.349119 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m09:44:38.349841 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m09:44:38.357708 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m09:44:38.364255 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m09:44:38.370044 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m09:44:38.372043 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m09:44:38.372879 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m09:44:38.373883 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m09:44:38.376019 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m09:44:38.384347 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m09:44:38.385076 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m09:44:38.389505 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m09:44:38.397317 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m09:44:38.399785 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m09:44:38.400995 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m09:44:38.403538 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m09:44:38.404260 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m09:44:38.405959 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m09:44:38.407000 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m09:44:38.410232 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m09:44:38.418822 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m09:44:38.419485 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m09:44:38.420536 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m09:44:38.421196 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m09:44:38.421578 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m09:44:38.421911 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m09:44:38.422196 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m09:44:38.422794 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m09:44:38.424710 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m09:44:38.428531 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m09:44:38.428899 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m09:44:38.429426 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m09:44:38.429852 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m09:44:38.430268 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m09:44:38.430964 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m09:44:38.431389 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m09:44:38.431868 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m09:44:38.432340 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m09:44:38.433464 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m09:44:38.433997 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m09:44:38.434468 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m09:44:38.434923 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m09:44:38.435364 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m09:44:38.435780 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m09:44:38.436231 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m09:44:38.436621 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m09:44:38.439581 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m09:44:38.440071 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m09:44:38.440875 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m09:44:38.441796 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m09:44:38.442273 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m09:44:38.443291 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m09:44:38.444440 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m09:44:38.451142 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m09:44:38.452432 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m09:44:38.458505 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m09:44:38.460501 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m09:44:38.463821 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m09:44:38.468047 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m09:44:38.469701 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m09:44:38.470270 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m09:44:38.470841 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m09:44:38.471341 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m09:44:38.473868 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m09:44:38.474393 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m09:44:38.475493 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m09:44:38.476032 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m09:44:38.477223 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m09:44:38.477665 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m09:44:38.478489 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m09:44:38.479459 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m09:44:38.483561 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m09:44:38.488525 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m09:44:38.489312 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m09:44:38.489891 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m09:44:38.490483 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m09:44:38.491169 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m09:44:38.491685 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m09:44:38.492321 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m09:44:38.492762 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m09:44:38.494367 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m09:44:38.496980 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m09:44:38.497801 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m09:44:38.498664 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m09:44:38.500276 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m09:44:38.503099 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m09:44:38.503844 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m09:44:38.505318 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m09:44:38.506204 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m09:44:38.507106 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m09:44:38.519436 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m09:44:38.520365 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m09:44:38.521484 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m09:44:38.522169 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m09:44:38.522935 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m09:44:38.523624 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m09:44:38.524599 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m09:44:38.525327 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m09:44:38.525931 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m09:44:38.527224 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m09:44:38.528179 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m09:44:38.528826 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m09:44:38.529381 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m09:44:38.530638 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m09:44:38.531539 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m09:44:38.532335 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m09:44:38.533328 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m09:44:38.534790 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m09:44:38.535447 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m09:44:38.537061 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m09:44:38.541630 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m09:44:38.542206 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m09:44:38.542727 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m09:44:38.543193 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m09:44:38.543716 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m09:44:38.545556 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m09:44:38.546309 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m09:44:38.547769 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m09:44:38.549609 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m09:44:38.551067 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m09:44:38.551779 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m09:44:38.553497 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m09:44:38.557238 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m09:44:38.562500 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m09:44:38.563086 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m09:44:38.566292 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m09:44:38.567874 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m09:44:38.568792 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m09:44:38.569634 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m09:44:38.572799 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m09:44:38.575432 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m09:44:38.577327 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m09:44:38.578713 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m09:44:38.579896 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m09:44:38.580753 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m09:44:38.755056 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers.sql
[0m09:44:38.760862 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payments.sql
[0m09:44:38.762082 [debug] [MainThread]: 1603: static parser failed on staging/stg_orders.sql
[0m09:44:38.764560 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_orders.sql
[0m09:44:38.765148 [debug] [MainThread]: 1699: static parser successfully parsed staging/hidden_model.sql
[0m09:44:38.766214 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/dim_customers.sql
[0m09:44:38.767453 [debug] [MainThread]: 1603: static parser failed on marts/core/fct_orders.sql
[0m09:44:38.769933 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/core/fct_orders.sql
[0m09:44:38.770426 [debug] [MainThread]: 1603: static parser failed on marts/core/intermediate/order_payments.sql
[0m09:44:38.772277 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/core/intermediate/order_payments.sql
[0m09:44:38.772843 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/intermediate/customer_payments.sql
[0m09:44:38.774033 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/intermediate/customer_orders.sql
[0m09:44:38.910836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ddb17a8-c7ac-4873-bd34-f12822ecd463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041f6590>]}
[0m09:44:38.918022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ddb17a8-c7ac-4873-bd34-f12822ecd463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042273a0>]}
[0m09:44:38.918173 [info ] [MainThread]: Found 9 models, 23 tests, 0 snapshots, 1 analysis, 494 macros, 0 operations, 3 seed files, 2 sources, 3 exposures, 2 metrics
[0m09:44:38.918291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ddb17a8-c7ac-4873-bd34-f12822ecd463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10426bb50>]}
[0m09:44:38.919261 [info ] [MainThread]: 
[0m09:44:38.919478 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m09:44:38.919910 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbttest"
[0m09:44:38.924655 [debug] [ThreadPool]: Using postgres connection "list_dbttest"
[0m09:44:38.924750 [debug] [ThreadPool]: On list_dbttest: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "connection_name": "list_dbttest"} */

    select distinct nspname from pg_namespace
  
[0m09:44:38.924812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:38.989737 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.06 seconds
[0m09:44:38.990667 [debug] [ThreadPool]: On list_dbttest: Close
[0m09:44:38.991569 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbttest_dev"
[0m09:44:38.995499 [debug] [ThreadPool]: Using postgres connection "list_dbttest_dev"
[0m09:44:38.995639 [debug] [ThreadPool]: On list_dbttest_dev: BEGIN
[0m09:44:38.995715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:39.006156 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m09:44:39.006342 [debug] [ThreadPool]: Using postgres connection "list_dbttest_dev"
[0m09:44:39.006425 [debug] [ThreadPool]: On list_dbttest_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "connection_name": "list_dbttest_dev"} */
select
      'dbttest' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbttest' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m09:44:39.023410 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.02 seconds
[0m09:44:39.024368 [debug] [ThreadPool]: On list_dbttest_dev: ROLLBACK
[0m09:44:39.024627 [debug] [ThreadPool]: On list_dbttest_dev: Close
[0m09:44:39.027931 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:39.028068 [debug] [MainThread]: On master: BEGIN
[0m09:44:39.028139 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:44:39.035322 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m09:44:39.035473 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:39.035539 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:44:39.059625 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
[0m09:44:39.060590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ddb17a8-c7ac-4873-bd34-f12822ecd463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044885e0>]}
[0m09:44:39.060805 [debug] [MainThread]: On master: ROLLBACK
[0m09:44:39.061103 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:39.061180 [debug] [MainThread]: On master: BEGIN
[0m09:44:39.061467 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:44:39.061538 [debug] [MainThread]: On master: COMMIT
[0m09:44:39.061617 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:39.061671 [debug] [MainThread]: On master: COMMIT
[0m09:44:39.061824 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:44:39.061895 [debug] [MainThread]: On master: Close
[0m09:44:39.062079 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:44:39.062207 [info ] [MainThread]: 
[0m09:44:39.068125 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m09:44:39.068308 [info ] [Thread-1 (]: 1 of 6 START view model dev.stg_customers ...................................... [RUN]
[0m09:44:39.068559 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.stg_customers"
[0m09:44:39.068696 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m09:44:39.068805 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_customers
[0m09:44:39.070647 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m09:44:39.071352 [debug] [Thread-1 (]: finished collecting timing info
[0m09:44:39.071461 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m09:44:39.092908 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.stg_customers"
[0m09:44:39.093748 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:44:39.093878 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m09:44:39.093942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:39.103120 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m09:44:39.103314 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:44:39.103389 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbttest"."dev"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "dbttest"."dev"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name,
        email

    from source

)

select * from renamed
  );
[0m09:44:39.108178 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:44:39.112210 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:44:39.112351 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbttest"."dev"."stg_customers" rename to "stg_customers__dbt_backup"
[0m09:44:39.113339 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:39.114983 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:44:39.115080 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbttest"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m09:44:39.115532 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:39.125009 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m09:44:39.125137 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:44:39.125200 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m09:44:39.126616 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:39.129731 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:44:39.129854 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest"."dev"."stg_customers__dbt_backup" cascade
[0m09:44:39.132982 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:44:39.133625 [debug] [Thread-1 (]: finished collecting timing info
[0m09:44:39.133714 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m09:44:39.133923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddb17a8-c7ac-4873-bd34-f12822ecd463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ea200>]}
[0m09:44:39.134104 [info ] [Thread-1 (]: 1 of 6 OK created view model dev.stg_customers ................................. [[32mCREATE VIEW[0m in 0.07s]
[0m09:44:39.134307 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m09:44:39.134411 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m09:44:39.134568 [info ] [Thread-1 (]: 2 of 6 START view model dev.stg_orders ......................................... [RUN]
[0m09:44:39.134750 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.stg_orders"
[0m09:44:39.134818 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m09:44:39.134885 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_orders
[0m09:44:39.136520 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m09:44:39.138006 [debug] [Thread-1 (]: finished collecting timing info
[0m09:44:39.138083 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m09:44:39.140140 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.stg_orders"
[0m09:44:39.140538 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:44:39.140615 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m09:44:39.140672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:39.150764 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m09:44:39.150912 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:44:39.150974 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbttest"."dev"."stg_orders__dbt_tmp" as (
    /*
hack for example macro references:
    

    The provided args are abc and 123


*/

with source as (
    select * from "dbttest"."dev"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
[0m09:44:39.154901 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:44:39.156675 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:44:39.156765 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbttest"."dev"."stg_orders" rename to "stg_orders__dbt_backup"
[0m09:44:39.157581 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:39.160033 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:44:39.160150 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbttest"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m09:44:39.161106 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:39.161821 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m09:44:39.161891 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:44:39.161947 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m09:44:39.162889 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:39.164005 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:44:39.164097 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest"."dev"."stg_orders__dbt_backup" cascade
[0m09:44:39.165609 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:44:39.166153 [debug] [Thread-1 (]: finished collecting timing info
[0m09:44:39.166265 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m09:44:39.166470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddb17a8-c7ac-4873-bd34-f12822ecd463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104636800>]}
[0m09:44:39.166635 [info ] [Thread-1 (]: 2 of 6 OK created view model dev.stg_orders .................................... [[32mCREATE VIEW[0m in 0.03s]
[0m09:44:39.166826 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m09:44:39.166931 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m09:44:39.167035 [info ] [Thread-1 (]: 3 of 6 START view model dev.stg_payments ....................................... [RUN]
[0m09:44:39.167220 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.stg_payments"
[0m09:44:39.167285 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m09:44:39.167347 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_payments
[0m09:44:39.168815 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m09:44:39.169382 [debug] [Thread-1 (]: finished collecting timing info
[0m09:44:39.169465 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m09:44:39.171467 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.stg_payments"
[0m09:44:39.171988 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:44:39.172052 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m09:44:39.172107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:39.189045 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m09:44:39.189214 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:44:39.189276 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbttest"."dev"."stg_payments__dbt_tmp" as (
    with source as (
    select * from "dbttest"."dev"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        --`amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
[0m09:44:39.195045 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m09:44:39.196788 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:44:39.196878 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbttest"."dev"."stg_payments" rename to "stg_payments__dbt_backup"
[0m09:44:39.197386 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:39.198978 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:44:39.199070 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbttest"."dev"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m09:44:39.200735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:39.201527 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m09:44:39.201619 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:44:39.201682 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m09:44:39.202835 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:39.204814 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:44:39.204891 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest"."dev"."stg_payments__dbt_backup" cascade
[0m09:44:39.206407 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:44:39.206999 [debug] [Thread-1 (]: finished collecting timing info
[0m09:44:39.207087 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m09:44:39.207290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddb17a8-c7ac-4873-bd34-f12822ecd463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10466e620>]}
[0m09:44:39.207470 [info ] [Thread-1 (]: 3 of 6 OK created view model dev.stg_payments .................................. [[32mCREATE VIEW[0m in 0.04s]
[0m09:44:39.207677 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m09:44:39.207763 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_orders
[0m09:44:39.207898 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.customer_orders"
[0m09:44:39.207965 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customer_orders
[0m09:44:39.208038 [debug] [Thread-1 (]: Compiling model.jaffle_shop.customer_orders
[0m09:44:39.209651 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customer_orders"
[0m09:44:39.210862 [debug] [Thread-1 (]: finished collecting timing info
[0m09:44:39.211166 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_orders
[0m09:44:39.211260 [debug] [Thread-1 (]: Began running node model.jaffle_shop.hidden_model
[0m09:44:39.211425 [info ] [Thread-1 (]: 4 of 6 START view model dev.hidden_model ....................................... [RUN]
[0m09:44:39.211656 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.hidden_model"
[0m09:44:39.211729 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.hidden_model
[0m09:44:39.211797 [debug] [Thread-1 (]: Compiling model.jaffle_shop.hidden_model
[0m09:44:39.213427 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.hidden_model"
[0m09:44:39.213930 [debug] [Thread-1 (]: finished collecting timing info
[0m09:44:39.214018 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.hidden_model
[0m09:44:39.216063 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.hidden_model"
[0m09:44:39.218859 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.hidden_model"
[0m09:44:39.218932 [debug] [Thread-1 (]: On model.jaffle_shop.hidden_model: BEGIN
[0m09:44:39.218988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:39.231217 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m09:44:39.231410 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.hidden_model"
[0m09:44:39.231483 [debug] [Thread-1 (]: On model.jaffle_shop.hidden_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.hidden_model"} */

  create view "dbttest"."dev"."hidden_model__dbt_tmp" as (
    -- hack for DAG viz
-- "dbttest"."dev"."raw_orders"

select * from "dbttest"."dev"."stg_orders"
  );
[0m09:44:39.238455 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m09:44:39.240132 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.hidden_model"
[0m09:44:39.240243 [debug] [Thread-1 (]: On model.jaffle_shop.hidden_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.hidden_model"} */
alter table "dbttest"."dev"."hidden_model__dbt_tmp" rename to "hidden_model"
[0m09:44:39.240832 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:39.241646 [debug] [Thread-1 (]: On model.jaffle_shop.hidden_model: COMMIT
[0m09:44:39.241748 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.hidden_model"
[0m09:44:39.241816 [debug] [Thread-1 (]: On model.jaffle_shop.hidden_model: COMMIT
[0m09:44:39.242714 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:39.244024 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.hidden_model"
[0m09:44:39.244118 [debug] [Thread-1 (]: On model.jaffle_shop.hidden_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.hidden_model"} */
drop view if exists "dbttest"."dev"."hidden_model__dbt_backup" cascade
[0m09:44:39.244373 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:44:39.244957 [debug] [Thread-1 (]: finished collecting timing info
[0m09:44:39.245056 [debug] [Thread-1 (]: On model.jaffle_shop.hidden_model: Close
[0m09:44:39.245264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddb17a8-c7ac-4873-bd34-f12822ecd463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10465b5b0>]}
[0m09:44:39.245434 [info ] [Thread-1 (]: 4 of 6 OK created view model dev.hidden_model .................................. [[32mCREATE VIEW[0m in 0.03s]
[0m09:44:39.245641 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.hidden_model
[0m09:44:39.245732 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_payments
[0m09:44:39.245958 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.customer_payments"
[0m09:44:39.246062 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customer_payments
[0m09:44:39.246134 [debug] [Thread-1 (]: Compiling model.jaffle_shop.customer_payments
[0m09:44:39.247818 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customer_payments"
[0m09:44:39.249556 [debug] [Thread-1 (]: finished collecting timing info
[0m09:44:39.249820 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_payments
[0m09:44:39.249911 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payments
[0m09:44:39.250122 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.order_payments"
[0m09:44:39.250190 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payments
[0m09:44:39.250253 [debug] [Thread-1 (]: Compiling model.jaffle_shop.order_payments
[0m09:44:39.253029 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payments"
[0m09:44:39.253515 [debug] [Thread-1 (]: finished collecting timing info
[0m09:44:39.253706 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payments
[0m09:44:39.253782 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m09:44:39.253937 [info ] [Thread-1 (]: 5 of 6 START table model dev.dim_customers ..................................... [RUN]
[0m09:44:39.254143 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.dim_customers"
[0m09:44:39.254215 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m09:44:39.254282 [debug] [Thread-1 (]: Compiling model.jaffle_shop.dim_customers
[0m09:44:39.261342 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m09:44:39.262095 [debug] [Thread-1 (]: finished collecting timing info
[0m09:44:39.262182 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m09:44:39.272388 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.dim_customers"
[0m09:44:39.273093 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:44:39.273164 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m09:44:39.273220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:39.285048 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m09:44:39.285186 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:44:39.285245 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */


  create  table "dbttest"."dev"."dim_customers__dbt_tmp"
  as (
    with  __dbt__cte__customer_orders as (
with orders as (

    select * from "dbttest"."dev"."stg_orders"

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

)

select * from final
),  __dbt__cte__customer_payments as (
with payments as (

    select * from "dbttest"."dev"."stg_payments"

),

orders as (

    select * from "dbttest"."dev"."stg_orders"

),

final as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders using (order_id)

    group by 1

)

select * from final
),customers as (

    select * from "dbttest"."dev"."stg_customers"

),

customer_orders as (

    select * from __dbt__cte__customer_orders

),

customer_payments as (

    select * from __dbt__cte__customer_payments

),

final as (

    select
        customers.customer_id,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders using (customer_id)

    left join customer_payments using (customer_id)

)

select * from final
  );
[0m09:44:39.294144 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.01 seconds
[0m09:44:39.295748 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:44:39.295839 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbttest"."dev"."dim_customers" rename to "dim_customers__dbt_backup"
[0m09:44:39.296190 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:39.297410 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:44:39.297481 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbttest"."dev"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m09:44:39.298293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:39.301059 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m09:44:39.301167 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:44:39.301221 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m09:44:39.302207 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:39.304229 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:44:39.304348 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbttest"."dev"."dim_customers__dbt_backup" cascade
[0m09:44:39.306979 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:39.307519 [debug] [Thread-1 (]: finished collecting timing info
[0m09:44:39.307621 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m09:44:39.307806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddb17a8-c7ac-4873-bd34-f12822ecd463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044b5780>]}
[0m09:44:39.307964 [info ] [Thread-1 (]: 5 of 6 OK created table model dev.dim_customers ................................ [[32mSELECT 100[0m in 0.05s]
[0m09:44:39.308156 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m09:44:39.308301 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m09:44:39.308462 [info ] [Thread-1 (]: 6 of 6 START table model dev.fct_orders ........................................ [RUN]
[0m09:44:39.308684 [debug] [Thread-1 (]: Acquiring new postgres connection "model.jaffle_shop.fct_orders"
[0m09:44:39.308757 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m09:44:39.308823 [debug] [Thread-1 (]: Compiling model.jaffle_shop.fct_orders
[0m09:44:39.313981 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m09:44:39.318123 [debug] [Thread-1 (]: finished collecting timing info
[0m09:44:39.318251 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m09:44:39.320311 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.fct_orders"
[0m09:44:39.322557 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m09:44:39.322626 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m09:44:39.322678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:39.337555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m09:44:39.337723 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m09:44:39.337784 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */


  create  table "dbttest"."dev"."fct_orders__dbt_tmp"
  as (
    

with  __dbt__cte__order_payments as (


with payments as (

    select * from "dbttest"."dev"."stg_payments"

),

final as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by 1

)

select * from final
),orders as (

    select * from "dbttest"."dev"."stg_orders"

),

order_payments as (

    select * from __dbt__cte__order_payments

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
[0m09:44:39.353964 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.02 seconds
[0m09:44:39.355688 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m09:44:39.355777 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbttest"."dev"."fct_orders" rename to "fct_orders__dbt_backup"
[0m09:44:39.357637 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:39.359044 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m09:44:39.359132 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbttest"."dev"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m09:44:39.361116 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:39.361846 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m09:44:39.361920 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m09:44:39.361974 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m09:44:39.363353 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:44:39.364426 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m09:44:39.364488 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "msm", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest"."dev"."fct_orders__dbt_backup" cascade
[0m09:44:39.369787 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m09:44:39.370477 [debug] [Thread-1 (]: finished collecting timing info
[0m09:44:39.370580 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m09:44:39.370772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ddb17a8-c7ac-4873-bd34-f12822ecd463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ed810>]}
[0m09:44:39.370924 [info ] [Thread-1 (]: 6 of 6 OK created table model dev.fct_orders ................................... [[32mSELECT 99[0m in 0.06s]
[0m09:44:39.371125 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m09:44:39.371627 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m09:44:39.371775 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:39.371854 [debug] [MainThread]: On master: BEGIN
[0m09:44:39.371913 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:44:39.382747 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m09:44:39.382891 [debug] [MainThread]: On master: COMMIT
[0m09:44:39.382947 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:39.382999 [debug] [MainThread]: On master: COMMIT
[0m09:44:39.383336 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:44:39.383403 [debug] [MainThread]: On master: Close
[0m09:44:39.383708 [info ] [MainThread]: 
[0m09:44:39.383899 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m09:44:39.384004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:39.384058 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
[0m09:44:39.391480 [info ] [MainThread]: 
[0m09:44:39.391635 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:44:39.391754 [info ] [MainThread]: 
[0m09:44:39.391844 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:44:39.391981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041f4160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104106d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f95d0>]}


============================== 2022-08-12 13:43:15.193043 | 04e86d49-a0fd-4859-97f5-26d46a4724cf ==============================
[0m13:43:15.193090 [info ] [MainThread]: Running with dbt=1.2.0
[0m13:43:15.193989 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m13:43:15.194089 [debug] [MainThread]: Tracking: tracking
[0m13:43:15.215888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111df8700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111df8640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dfae00>]}
[0m13:43:15.245662 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:43:15.245874 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:43:15.245972 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:43:15.246077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '04e86d49-a0fd-4859-97f5-26d46a4724cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dd1150>]}
[0m13:43:15.297249 [debug] [MainThread]: Parsing macros/example_macro.sql
[0m13:43:15.297746 [debug] [MainThread]: Parsing macros/etc.sql
[0m13:43:15.298653 [debug] [MainThread]: Parsing macros/catalog.sql
[0m13:43:15.301901 [debug] [MainThread]: Parsing macros/adapters.sql
[0m13:43:15.312771 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m13:43:15.313861 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m13:43:15.315041 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m13:43:15.316978 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m13:43:15.318140 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m13:43:15.324934 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m13:43:15.325606 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:43:15.325755 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:43:15.326014 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:43:15.326160 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:43:15.326385 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:43:15.326649 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:43:15.327055 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:43:15.327560 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:43:15.327762 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:43:15.327966 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:43:15.328179 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:43:15.328355 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:43:15.328930 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:43:15.329146 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:43:15.330389 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m13:43:15.331974 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m13:43:15.332905 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m13:43:15.333595 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m13:43:15.363976 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m13:43:15.370078 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m13:43:15.375783 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m13:43:15.377783 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m13:43:15.378567 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m13:43:15.379317 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m13:43:15.381183 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m13:43:15.388960 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m13:43:15.389599 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m13:43:15.393679 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m13:43:15.400817 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m13:43:15.403382 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m13:43:15.404642 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m13:43:15.407094 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m13:43:15.407647 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m13:43:15.409335 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m13:43:15.410426 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m13:43:15.413807 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m13:43:15.422310 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m13:43:15.422958 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m13:43:15.423999 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m13:43:15.424645 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m13:43:15.425033 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m13:43:15.425358 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m13:43:15.425635 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m13:43:15.426196 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m13:43:15.428476 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m13:43:15.432336 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:43:15.432695 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m13:43:15.433232 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m13:43:15.433652 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m13:43:15.434051 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:43:15.434570 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:43:15.434901 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:43:15.435332 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:43:15.435780 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:43:15.436832 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:43:15.437523 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:43:15.438138 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:43:15.438638 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m13:43:15.439099 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m13:43:15.439493 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:43:15.439952 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m13:43:15.440332 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m13:43:15.442889 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:43:15.443300 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m13:43:15.444058 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:43:15.445039 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:43:15.445505 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m13:43:15.446469 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m13:43:15.447626 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m13:43:15.454138 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m13:43:15.455425 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:43:15.461299 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m13:43:15.463161 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m13:43:15.466472 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m13:43:15.470806 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m13:43:15.472215 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m13:43:15.472708 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m13:43:15.473235 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m13:43:15.473719 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m13:43:15.476181 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m13:43:15.476657 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m13:43:15.477720 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m13:43:15.478258 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m13:43:15.479440 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m13:43:15.479856 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m13:43:15.480682 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m13:43:15.481754 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m13:43:15.485969 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m13:43:15.490565 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m13:43:15.491314 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m13:43:15.491957 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m13:43:15.492795 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m13:43:15.493577 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m13:43:15.494154 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m13:43:15.494835 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m13:43:15.495329 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m13:43:15.496801 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m13:43:15.499307 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m13:43:15.500096 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m13:43:15.500835 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m13:43:15.502377 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m13:43:15.505060 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m13:43:15.505667 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m13:43:15.506870 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m13:43:15.507699 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m13:43:15.508561 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m13:43:15.520453 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m13:43:15.521415 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m13:43:15.522805 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m13:43:15.523547 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m13:43:15.524340 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m13:43:15.525049 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m13:43:15.526037 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m13:43:15.526796 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m13:43:15.527303 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m13:43:15.528437 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m13:43:15.529341 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m13:43:15.529924 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m13:43:15.530433 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m13:43:15.531673 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m13:43:15.532543 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m13:43:15.533289 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m13:43:15.534214 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m13:43:15.535515 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m13:43:15.536097 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m13:43:15.537711 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m13:43:15.542030 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m13:43:15.542484 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m13:43:15.542971 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m13:43:15.543423 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m13:43:15.543907 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m13:43:15.545695 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m13:43:15.546610 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m13:43:15.548065 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m13:43:15.549889 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m13:43:15.551354 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m13:43:15.552049 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m13:43:15.553656 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m13:43:15.557250 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m13:43:15.562464 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m13:43:15.563017 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m13:43:15.566153 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m13:43:15.567588 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m13:43:15.568261 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m13:43:15.568960 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m13:43:15.571923 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m13:43:15.574415 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m13:43:15.576202 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m13:43:15.577349 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m13:43:15.578292 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m13:43:15.578997 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m13:43:15.758220 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers.sql
[0m13:43:15.763353 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payments.sql
[0m13:43:15.764311 [debug] [MainThread]: 1603: static parser failed on staging/stg_orders.sql
[0m13:43:15.766514 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_orders.sql
[0m13:43:15.767091 [debug] [MainThread]: 1699: static parser successfully parsed staging/hidden_model.sql
[0m13:43:15.768146 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/dim_customers.sql
[0m13:43:15.769066 [debug] [MainThread]: 1603: static parser failed on marts/core/fct_orders.sql
[0m13:43:15.771257 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/core/fct_orders.sql
[0m13:43:15.771774 [debug] [MainThread]: 1603: static parser failed on marts/core/intermediate/order_payments.sql
[0m13:43:15.774381 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/core/intermediate/order_payments.sql
[0m13:43:15.775017 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/intermediate/customer_payments.sql
[0m13:43:15.775951 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/intermediate/customer_orders.sql
[0m13:43:15.893260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04e86d49-a0fd-4859-97f5-26d46a4724cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f702b0>]}
[0m13:43:15.900461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04e86d49-a0fd-4859-97f5-26d46a4724cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122358d0>]}
[0m13:43:15.900613 [info ] [MainThread]: Found 9 models, 23 tests, 0 snapshots, 1 analysis, 523 macros, 0 operations, 3 seed files, 2 sources, 3 exposures, 2 metrics
[0m13:43:15.900732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04e86d49-a0fd-4859-97f5-26d46a4724cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dd8640>]}
[0m13:43:15.901721 [info ] [MainThread]: 
[0m13:43:15.901940 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:43:15.902341 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev"
[0m13:43:15.902451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:21.912560 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
  '
[0m13:43:21.913786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:21.914049 [debug] [MainThread]: Connection 'list_msm-groupdata-customer-dev' was properly closed.
[0m13:43:21.914515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f70370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f716c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f71720>]}


============================== 2022-08-12 15:12:28.454202 | 6392eb67-55cc-4a13-a53a-c8c2e0f65242 ==============================
[0m15:12:28.454263 [info ] [MainThread]: Running with dbt=1.2.0
[0m15:12:28.454874 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m15:12:28.454986 [debug] [MainThread]: Tracking: tracking
[0m15:12:28.470268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106604400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106607ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106605b10>]}
[0m15:12:28.552060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:12:28.552202 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:12:28.555703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6392eb67-55cc-4a13-a53a-c8c2e0f65242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075400d0>]}
[0m15:12:28.584915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6392eb67-55cc-4a13-a53a-c8c2e0f65242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10650ed40>]}
[0m15:12:28.585096 [info ] [MainThread]: Found 9 models, 23 tests, 0 snapshots, 1 analysis, 523 macros, 0 operations, 3 seed files, 2 sources, 3 exposures, 2 metrics
[0m15:12:28.585211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6392eb67-55cc-4a13-a53a-c8c2e0f65242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074d3c70>]}
[0m15:12:28.586163 [info ] [MainThread]: 
[0m15:12:28.586377 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:12:28.586756 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev"
[0m15:12:28.586869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:34.594749 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
  '
[0m15:12:34.597060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:34.597452 [debug] [MainThread]: Connection 'list_msm-groupdata-customer-dev' was properly closed.
[0m15:12:34.598065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10650c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10658acb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10658ad40>]}


============================== 2022-08-12 15:20:21.038442 | 4df776cf-2a9c-4122-875c-6d4f1d22cb64 ==============================
[0m15:20:21.038468 [info ] [MainThread]: Running with dbt=1.2.0
[0m15:20:21.039699 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m15:20:21.039843 [debug] [MainThread]: Tracking: tracking
[0m15:20:21.068507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f5cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f6a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f69e0>]}
[0m15:20:21.136600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:20:21.136751 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:20:21.140476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4df776cf-2a9c-4122-875c-6d4f1d22cb64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082e80d0>]}
[0m15:20:21.175895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4df776cf-2a9c-4122-875c-6d4f1d22cb64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107339060>]}
[0m15:20:21.176086 [info ] [MainThread]: Found 9 models, 23 tests, 0 snapshots, 1 analysis, 523 macros, 0 operations, 3 seed files, 2 sources, 3 exposures, 2 metrics
[0m15:20:21.176206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4df776cf-2a9c-4122-875c-6d4f1d22cb64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10827bfd0>]}
[0m15:20:21.177183 [info ] [MainThread]: 
[0m15:20:21.177413 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:20:21.177869 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev"
[0m15:20:21.178056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:22.204857 [debug] [ThreadPool]: Acquiring new bigquery connection "create_msm-groupdata-customer-dev_vertex_samples"
[0m15:20:22.205687 [debug] [ThreadPool]: Acquiring new bigquery connection "create_msm-groupdata-customer-dev_vertex_samples"
[0m15:20:22.206192 [debug] [ThreadPool]: BigQuery adapter: Creating schema "msm-groupdata-customer-dev.vertex_samples".
[0m15:20:22.206308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:23.179071 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev_vertex_samples"
[0m15:20:23.179533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:23.390817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4df776cf-2a9c-4122-875c-6d4f1d22cb64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ca6e90>]}
[0m15:20:23.391732 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:20:23.392193 [info ] [MainThread]: 
[0m15:20:23.399906 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m15:20:23.400010 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m15:20:23.400198 [info ] [Thread-1 (]: 1 of 3 START seed file vertex_samples.raw_customers ............................ [RUN]
[0m15:20:23.400339 [info ] [Thread-2 (]: 2 of 3 START seed file vertex_samples.raw_orders ............................... [RUN]
[0m15:20:23.400597 [debug] [Thread-1 (]: Acquiring new bigquery connection "seed.jaffle_shop.raw_customers"
[0m15:20:23.400815 [debug] [Thread-2 (]: Acquiring new bigquery connection "seed.jaffle_shop.raw_orders"
[0m15:20:23.400898 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m15:20:23.400973 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m15:20:23.401064 [debug] [Thread-1 (]: finished collecting timing info
[0m15:20:23.401249 [debug] [Thread-2 (]: finished collecting timing info
[0m15:20:23.401427 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m15:20:23.401554 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m15:20:23.429901 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:20:23.432249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:26.934097 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m15:20:26.946767 [debug] [Thread-1 (]: finished collecting timing info
[0m15:20:26.947080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4df776cf-2a9c-4122-875c-6d4f1d22cb64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10846e650>]}
[0m15:20:26.947230 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file vertex_samples.raw_customers ........................ [[32mINSERT 100[0m in 3.55s]
[0m15:20:26.947427 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m15:20:26.947521 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_payments
[0m15:20:26.947638 [info ] [Thread-1 (]: 3 of 3 START seed file vertex_samples.raw_payments ............................. [RUN]
[0m15:20:26.947996 [debug] [Thread-1 (]: Acquiring new bigquery connection "seed.jaffle_shop.raw_payments"
[0m15:20:26.948121 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m15:20:26.948198 [debug] [Thread-1 (]: finished collecting timing info
[0m15:20:26.948275 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_payments
[0m15:20:26.952632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:26.989426 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m15:20:26.992023 [debug] [Thread-2 (]: finished collecting timing info
[0m15:20:26.992285 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4df776cf-2a9c-4122-875c-6d4f1d22cb64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d7040>]}
[0m15:20:26.992427 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file vertex_samples.raw_orders ........................... [[32mINSERT 99[0m in 3.59s]
[0m15:20:26.992608 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m15:20:30.301766 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m15:20:30.304469 [debug] [Thread-1 (]: finished collecting timing info
[0m15:20:30.304733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4df776cf-2a9c-4122-875c-6d4f1d22cb64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c7d60>]}
[0m15:20:30.304869 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file vertex_samples.raw_payments ......................... [[32mINSERT 113[0m in 3.36s]
[0m15:20:30.305049 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_payments
[0m15:20:30.305591 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:20:30.305770 [info ] [MainThread]: 
[0m15:20:30.305887 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 9.13 seconds (9.13s).
[0m15:20:30.305989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:30.306041 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m15:20:30.306091 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m15:20:30.317049 [info ] [MainThread]: 
[0m15:20:30.317227 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:20:30.317343 [info ] [MainThread]: 
[0m15:20:30.317433 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:20:30.317591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c7f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c7dc0>]}


============================== 2022-08-12 15:20:41.954296 | 7d9f43bf-899d-42e6-83ee-47856a5c388b ==============================
[0m15:20:41.954371 [info ] [MainThread]: Running with dbt=1.2.0
[0m15:20:41.954855 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:20:41.954979 [debug] [MainThread]: Tracking: tracking
[0m15:20:41.973818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100e55d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100e5420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100e71c0>]}
[0m15:20:42.041996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:20:42.042151 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:20:42.045851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d9f43bf-899d-42e6-83ee-47856a5c388b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104ee8c0>]}
[0m15:20:42.081361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d9f43bf-899d-42e6-83ee-47856a5c388b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100043d0>]}
[0m15:20:42.081574 [info ] [MainThread]: Found 9 models, 23 tests, 0 snapshots, 1 analysis, 523 macros, 0 operations, 3 seed files, 2 sources, 3 exposures, 2 metrics
[0m15:20:42.081708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d9f43bf-899d-42e6-83ee-47856a5c388b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110006b30>]}
[0m15:20:42.082841 [info ] [MainThread]: 
[0m15:20:42.083226 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:20:42.083781 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev"
[0m15:20:42.083870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:43.039553 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev_vertex_samples"
[0m15:20:43.039842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:43.256342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d9f43bf-899d-42e6-83ee-47856a5c388b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa6e90>]}
[0m15:20:43.257363 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:20:43.257742 [info ] [MainThread]: 
[0m15:20:43.260801 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m15:20:43.260923 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m15:20:43.261058 [info ] [Thread-1 (]: 1 of 6 START view model vertex_samples.stg_customers ........................... [RUN]
[0m15:20:43.261183 [info ] [Thread-2 (]: 2 of 6 START view model vertex_samples.stg_orders .............................. [RUN]
[0m15:20:43.261414 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.stg_customers"
[0m15:20:43.261669 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.stg_orders"
[0m15:20:43.261763 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m15:20:43.261839 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m15:20:43.261938 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_customers
[0m15:20:43.262003 [debug] [Thread-2 (]: Compiling model.jaffle_shop.stg_orders
[0m15:20:43.264074 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m15:20:43.266251 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m15:20:43.267800 [debug] [Thread-1 (]: finished collecting timing info
[0m15:20:43.267887 [debug] [Thread-2 (]: finished collecting timing info
[0m15:20:43.267984 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m15:20:43.268062 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m15:20:43.287655 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.stg_orders"
[0m15:20:43.291017 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.stg_customers"
[0m15:20:43.291347 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:20:43.291496 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `msm-groupdata-customer-dev`.`vertex_samples`.`stg_orders`
  OPTIONS()
  as /*
hack for example macro references:
    

    The provided args are abc and 123


*/

with source as (
    select * from `msm-groupdata-customer-dev`.`vertex_samples`.`raw_orders`

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed;


[0m15:20:43.292340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:43.292540 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `msm-groupdata-customer-dev`.`vertex_samples`.`stg_customers`
  OPTIONS()
  as with source as (
    select * from `msm-groupdata-customer-dev`.`vertex_samples`.`raw_customers`

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name,
        email

    from source

)

select * from renamed;


[0m15:20:43.988947 [debug] [Thread-2 (]: finished collecting timing info
[0m15:20:43.989262 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d9f43bf-899d-42e6-83ee-47856a5c388b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac0550>]}
[0m15:20:43.989452 [info ] [Thread-2 (]: 2 of 6 OK created view model vertex_samples.stg_orders ......................... [[32mOK[0m in 0.73s]
[0m15:20:43.989657 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m15:20:43.989743 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_payments
[0m15:20:43.989935 [info ] [Thread-2 (]: 3 of 6 START view model vertex_samples.stg_payments ............................ [RUN]
[0m15:20:43.990117 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.stg_payments"
[0m15:20:43.990196 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_payments
[0m15:20:43.990299 [debug] [Thread-2 (]: Compiling model.jaffle_shop.stg_payments
[0m15:20:43.991881 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m15:20:43.992516 [debug] [Thread-2 (]: finished collecting timing info
[0m15:20:43.992621 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_payments
[0m15:20:43.994124 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.stg_payments"
[0m15:20:43.994569 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:20:43.994718 [debug] [Thread-2 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */


  create or replace view `msm-groupdata-customer-dev`.`vertex_samples`.`stg_payments`
  OPTIONS()
  as with source as (
    select * from `msm-groupdata-customer-dev`.`vertex_samples`.`raw_payments`

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        --`amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed;


[0m15:20:44.262809 [debug] [Thread-1 (]: finished collecting timing info
[0m15:20:44.263149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d9f43bf-899d-42e6-83ee-47856a5c388b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11009ded0>]}
[0m15:20:44.263336 [info ] [Thread-1 (]: 1 of 6 OK created view model vertex_samples.stg_customers ...................... [[32mOK[0m in 1.00s]
[0m15:20:44.263540 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m15:20:44.263627 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_orders
[0m15:20:44.263828 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.customer_orders"
[0m15:20:44.263924 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customer_orders
[0m15:20:44.264020 [debug] [Thread-1 (]: Compiling model.jaffle_shop.customer_orders
[0m15:20:44.265583 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customer_orders"
[0m15:20:44.266115 [debug] [Thread-1 (]: finished collecting timing info
[0m15:20:44.266308 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_orders
[0m15:20:44.266389 [debug] [Thread-1 (]: Began running node model.jaffle_shop.hidden_model
[0m15:20:44.266521 [info ] [Thread-1 (]: 4 of 6 START view model vertex_samples.hidden_model ............................ [RUN]
[0m15:20:44.266731 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.hidden_model"
[0m15:20:44.266797 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.hidden_model
[0m15:20:44.266855 [debug] [Thread-1 (]: Compiling model.jaffle_shop.hidden_model
[0m15:20:44.268372 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.hidden_model"
[0m15:20:44.269972 [debug] [Thread-1 (]: finished collecting timing info
[0m15:20:44.270053 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.hidden_model
[0m15:20:44.272735 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.hidden_model"
[0m15:20:44.273250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:44.273379 [debug] [Thread-1 (]: On model.jaffle_shop.hidden_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.hidden_model"} */


  create or replace view `msm-groupdata-customer-dev`.`vertex_samples`.`hidden_model`
  OPTIONS()
  as -- hack for DAG viz
-- `msm-groupdata-customer-dev`.`vertex_samples`.`raw_orders`

select * from `msm-groupdata-customer-dev`.`vertex_samples`.`stg_orders`;


[0m15:20:44.818906 [debug] [Thread-2 (]: finished collecting timing info
[0m15:20:44.819735 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d9f43bf-899d-42e6-83ee-47856a5c388b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107d05e0>]}
[0m15:20:44.820215 [info ] [Thread-2 (]: 3 of 6 OK created view model vertex_samples.stg_payments ....................... [[32mOK[0m in 0.83s]
[0m15:20:44.820703 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_payments
[0m15:20:44.821211 [debug] [Thread-2 (]: Began running node model.jaffle_shop.customer_payments
[0m15:20:44.821561 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.customer_payments"
[0m15:20:44.821685 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.customer_payments
[0m15:20:44.821793 [debug] [Thread-2 (]: Compiling model.jaffle_shop.customer_payments
[0m15:20:44.823680 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.customer_payments"
[0m15:20:44.827804 [debug] [Thread-2 (]: finished collecting timing info
[0m15:20:44.828147 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.customer_payments
[0m15:20:44.828243 [debug] [Thread-2 (]: Began running node model.jaffle_shop.order_payments
[0m15:20:44.828370 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.order_payments"
[0m15:20:44.828437 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.order_payments
[0m15:20:44.828501 [debug] [Thread-2 (]: Compiling model.jaffle_shop.order_payments
[0m15:20:44.830520 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.order_payments"
[0m15:20:44.831186 [debug] [Thread-2 (]: finished collecting timing info
[0m15:20:44.831371 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.order_payments
[0m15:20:44.831448 [debug] [Thread-2 (]: Began running node model.jaffle_shop.dim_customers
[0m15:20:44.831604 [info ] [Thread-2 (]: 5 of 6 START table model vertex_samples.dim_customers .......................... [RUN]
[0m15:20:44.831800 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.dim_customers"
[0m15:20:44.831866 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.dim_customers
[0m15:20:44.831927 [debug] [Thread-2 (]: Compiling model.jaffle_shop.dim_customers
[0m15:20:44.839807 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m15:20:44.840470 [debug] [Thread-2 (]: finished collecting timing info
[0m15:20:44.840553 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.dim_customers
[0m15:20:44.852968 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.dim_customers"
[0m15:20:44.870489 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:20:44.870692 [debug] [Thread-2 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `msm-groupdata-customer-dev`.`vertex_samples`.`dim_customers`
  
  
  OPTIONS()
  as (
    with  __dbt__cte__customer_orders as (
with orders as (

    select * from `msm-groupdata-customer-dev`.`vertex_samples`.`stg_orders`

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

)

select * from final
),  __dbt__cte__customer_payments as (
with payments as (

    select * from `msm-groupdata-customer-dev`.`vertex_samples`.`stg_payments`

),

orders as (

    select * from `msm-groupdata-customer-dev`.`vertex_samples`.`stg_orders`

),

final as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders using (order_id)

    group by 1

)

select * from final
),customers as (

    select * from `msm-groupdata-customer-dev`.`vertex_samples`.`stg_customers`

),

customer_orders as (

    select * from __dbt__cte__customer_orders

),

customer_payments as (

    select * from __dbt__cte__customer_payments

),

final as (

    select
        customers.customer_id,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders using (customer_id)

    left join customer_payments using (customer_id)

)

select * from final
  );
  
[0m15:20:44.901683 [debug] [Thread-1 (]: finished collecting timing info
[0m15:20:44.901964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d9f43bf-899d-42e6-83ee-47856a5c388b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107c97e0>]}
[0m15:20:44.902247 [info ] [Thread-1 (]: 4 of 6 OK created view model vertex_samples.hidden_model ....................... [[32mOK[0m in 0.64s]
[0m15:20:44.902534 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.hidden_model
[0m15:20:44.902670 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m15:20:44.902920 [info ] [Thread-1 (]: 6 of 6 START table model vertex_samples.fct_orders ............................. [RUN]
[0m15:20:44.903327 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.fct_orders"
[0m15:20:44.903491 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m15:20:44.903569 [debug] [Thread-1 (]: Compiling model.jaffle_shop.fct_orders
[0m15:20:44.909112 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m15:20:44.916465 [debug] [Thread-1 (]: finished collecting timing info
[0m15:20:44.916657 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m15:20:44.918445 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.fct_orders"
[0m15:20:44.919387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:44.919543 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */


  create or replace table `msm-groupdata-customer-dev`.`vertex_samples`.`fct_orders`
  
  
  OPTIONS()
  as (
    

with  __dbt__cte__order_payments as (


with payments as (

    select * from `msm-groupdata-customer-dev`.`vertex_samples`.`stg_payments`

),

final as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by 1

)

select * from final
),orders as (

    select * from `msm-groupdata-customer-dev`.`vertex_samples`.`stg_orders`

),

order_payments as (

    select * from __dbt__cte__order_payments

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
  
[0m15:20:47.451432 [debug] [Thread-1 (]: finished collecting timing info
[0m15:20:47.453637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d9f43bf-899d-42e6-83ee-47856a5c388b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107ff640>]}
[0m15:20:47.454619 [info ] [Thread-1 (]: 6 of 6 OK created table model vertex_samples.fct_orders ........................ [[32mCREATE TABLE (99.0 rows, 6.5 KB processed)[0m in 2.55s]
[0m15:20:47.455017 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m15:20:47.597412 [debug] [Thread-2 (]: finished collecting timing info
[0m15:20:47.599137 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d9f43bf-899d-42e6-83ee-47856a5c388b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110913f70>]}
[0m15:20:47.601215 [info ] [Thread-2 (]: 5 of 6 OK created table model vertex_samples.dim_customers ..................... [[32mCREATE TABLE (100.0 rows, 4.9 KB processed)[0m in 2.77s]
[0m15:20:47.602190 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.dim_customers
[0m15:20:47.602854 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:20:47.603074 [info ] [MainThread]: 
[0m15:20:47.603213 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 5.52 seconds (5.52s).
[0m15:20:47.603318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:47.603489 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
[0m15:20:47.603568 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m15:20:47.610415 [info ] [MainThread]: 
[0m15:20:47.610575 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:20:47.610700 [info ] [MainThread]: 
[0m15:20:47.610803 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:20:47.610959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f7ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100041f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107fd810>]}


============================== 2022-08-12 15:22:34.047741 | 882488e5-03ab-415d-8b94-f0c922c611d7 ==============================
[0m15:22:34.047846 [info ] [MainThread]: Running with dbt=1.2.0
[0m15:22:34.048620 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m15:22:34.048713 [debug] [MainThread]: Tracking: tracking
[0m15:22:34.074227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f608b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f629b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f61240>]}
[0m15:22:34.103386 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:22:34.103592 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:22:34.103701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '882488e5-03ab-415d-8b94-f0c922c611d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f42d40>]}
[0m15:22:34.161057 [debug] [MainThread]: Parsing macros/example_macro.sql
[0m15:22:34.161573 [debug] [MainThread]: Parsing macros/etc.sql
[0m15:22:34.162455 [debug] [MainThread]: Parsing macros/catalog.sql
[0m15:22:34.165861 [debug] [MainThread]: Parsing macros/adapters.sql
[0m15:22:34.177615 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m15:22:34.178867 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m15:22:34.180310 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m15:22:34.182635 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m15:22:34.184016 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m15:22:34.191417 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m15:22:34.192218 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m15:22:34.192394 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:22:34.192676 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m15:22:34.192826 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m15:22:34.193078 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m15:22:34.193382 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:22:34.193819 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:22:34.194380 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m15:22:34.194619 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m15:22:34.194837 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m15:22:34.195083 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m15:22:34.195260 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:22:34.195830 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m15:22:34.196052 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m15:22:34.197235 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m15:22:34.198884 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m15:22:34.199872 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m15:22:34.200586 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m15:22:34.208047 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m15:22:34.214130 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m15:22:34.220191 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m15:22:34.222379 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m15:22:34.223233 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m15:22:34.224148 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m15:22:34.226102 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m15:22:34.234474 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m15:22:34.235228 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m15:22:34.263997 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m15:22:34.271865 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m15:22:34.274479 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m15:22:34.275714 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m15:22:34.278220 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m15:22:34.278839 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m15:22:34.280469 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m15:22:34.281478 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m15:22:34.284550 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m15:22:34.293422 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m15:22:34.294181 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m15:22:34.295261 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m15:22:34.295922 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m15:22:34.296308 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m15:22:34.296654 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m15:22:34.296942 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m15:22:34.297565 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m15:22:34.299527 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m15:22:34.303475 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m15:22:34.303889 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m15:22:34.304519 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m15:22:34.305002 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m15:22:34.305424 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:22:34.305981 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m15:22:34.306315 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m15:22:34.306773 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m15:22:34.307231 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:22:34.308380 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:22:34.308973 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m15:22:34.309442 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m15:22:34.309898 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m15:22:34.310366 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m15:22:34.310829 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m15:22:34.311331 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m15:22:34.311736 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m15:22:34.314363 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m15:22:34.314778 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m15:22:34.315573 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:22:34.316502 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m15:22:34.316946 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m15:22:34.317940 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m15:22:34.319113 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m15:22:34.325953 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m15:22:34.327263 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m15:22:34.333265 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m15:22:34.335201 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m15:22:34.338414 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m15:22:34.342661 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m15:22:34.343950 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m15:22:34.344378 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m15:22:34.345061 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m15:22:34.345604 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m15:22:34.348142 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m15:22:34.348629 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m15:22:34.349710 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m15:22:34.350252 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m15:22:34.351440 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m15:22:34.351973 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m15:22:34.353309 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m15:22:34.354368 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m15:22:34.358359 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m15:22:34.363216 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m15:22:34.364143 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m15:22:34.364757 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m15:22:34.365380 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m15:22:34.366101 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m15:22:34.366646 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m15:22:34.367304 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m15:22:34.367781 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m15:22:34.369225 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m15:22:34.371697 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m15:22:34.372539 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m15:22:34.373384 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m15:22:34.375138 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m15:22:34.377997 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m15:22:34.378652 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m15:22:34.379880 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m15:22:34.380728 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m15:22:34.381611 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m15:22:34.394182 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m15:22:34.395198 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m15:22:34.396357 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m15:22:34.397057 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m15:22:34.397861 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m15:22:34.398588 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m15:22:34.399587 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m15:22:34.400330 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m15:22:34.400843 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m15:22:34.401955 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m15:22:34.402897 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m15:22:34.403529 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m15:22:34.404158 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m15:22:34.405457 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m15:22:34.406339 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m15:22:34.407125 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m15:22:34.408090 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m15:22:34.409667 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m15:22:34.410349 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m15:22:34.411997 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m15:22:34.416527 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m15:22:34.417050 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m15:22:34.417561 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m15:22:34.418013 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m15:22:34.418517 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m15:22:34.420345 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m15:22:34.421152 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m15:22:34.422716 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m15:22:34.424818 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m15:22:34.426443 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m15:22:34.427173 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m15:22:34.428812 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m15:22:34.432800 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m15:22:34.438548 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m15:22:34.439195 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m15:22:34.442427 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m15:22:34.443952 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m15:22:34.444679 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m15:22:34.445397 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m15:22:34.448656 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m15:22:34.451310 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m15:22:34.453212 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m15:22:34.454395 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m15:22:34.455410 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m15:22:34.456124 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m15:22:34.644793 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers.sql
[0m15:22:34.650584 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payments.sql
[0m15:22:34.651677 [debug] [MainThread]: 1603: static parser failed on staging/stg_orders.sql
[0m15:22:34.654405 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_orders.sql
[0m15:22:34.655086 [debug] [MainThread]: 1699: static parser successfully parsed staging/hidden_model.sql
[0m15:22:34.656559 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/dim_customers.sql
[0m15:22:34.657718 [debug] [MainThread]: 1603: static parser failed on marts/core/fct_orders.sql
[0m15:22:34.660240 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/core/fct_orders.sql
[0m15:22:34.660781 [debug] [MainThread]: 1603: static parser failed on marts/core/intermediate/order_payments.sql
[0m15:22:34.662834 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/core/intermediate/order_payments.sql
[0m15:22:34.663472 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/intermediate/customer_payments.sql
[0m15:22:34.664873 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/intermediate/customer_orders.sql
[0m15:22:34.785306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '882488e5-03ab-415d-8b94-f0c922c611d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202142b0>]}
[0m15:22:34.793072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '882488e5-03ab-415d-8b94-f0c922c611d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f63910>]}
[0m15:22:34.793282 [info ] [MainThread]: Found 9 models, 23 tests, 0 snapshots, 1 analysis, 523 macros, 0 operations, 3 seed files, 2 sources, 3 exposures, 2 metrics
[0m15:22:34.793399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '882488e5-03ab-415d-8b94-f0c922c611d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f405e0>]}
[0m15:22:34.794430 [info ] [MainThread]: 
[0m15:22:34.794655 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:22:34.795059 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev"
[0m15:22:34.795177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:35.698756 [debug] [ThreadPool]: Acquiring new bigquery connection "create_msm-groupdata-customer-dev_darren_vertex_samples"
[0m15:22:35.700126 [debug] [ThreadPool]: Acquiring new bigquery connection "create_msm-groupdata-customer-dev_darren_vertex_samples"
[0m15:22:35.700630 [debug] [ThreadPool]: BigQuery adapter: Creating schema "msm-groupdata-customer-dev.darren_vertex_samples".
[0m15:22:35.700893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:36.762661 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev_darren"
[0m15:22:36.762951 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev_darren_vertex_samples"
[0m15:22:36.763139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:36.763226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:37.221559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '882488e5-03ab-415d-8b94-f0c922c611d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120214f10>]}
[0m15:22:37.222461 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:22:37.222926 [info ] [MainThread]: 
[0m15:22:37.226463 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m15:22:37.227192 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m15:22:37.227379 [info ] [Thread-1 (]: 1 of 3 START seed file darren_vertex_samples.raw_customers ..................... [RUN]
[0m15:22:37.227513 [info ] [Thread-2 (]: 2 of 3 START seed file darren_vertex_samples.raw_orders ........................ [RUN]
[0m15:22:37.227763 [debug] [Thread-1 (]: Acquiring new bigquery connection "seed.jaffle_shop.raw_customers"
[0m15:22:37.227958 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m15:22:37.228091 [debug] [Thread-2 (]: Acquiring new bigquery connection "seed.jaffle_shop.raw_orders"
[0m15:22:37.228210 [debug] [Thread-1 (]: finished collecting timing info
[0m15:22:37.228309 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m15:22:37.228406 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m15:22:37.228477 [debug] [Thread-2 (]: finished collecting timing info
[0m15:22:37.238055 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m15:22:37.253244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:37.255469 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:22:40.726989 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m15:22:40.741623 [debug] [Thread-1 (]: finished collecting timing info
[0m15:22:40.741927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882488e5-03ab-415d-8b94-f0c922c611d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12058eb00>]}
[0m15:22:40.742083 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file darren_vertex_samples.raw_customers ................. [[32mINSERT 100[0m in 3.51s]
[0m15:22:40.742284 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m15:22:40.742375 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_payments
[0m15:22:40.742576 [info ] [Thread-1 (]: 3 of 3 START seed file darren_vertex_samples.raw_payments ...................... [RUN]
[0m15:22:40.742784 [debug] [Thread-1 (]: Acquiring new bigquery connection "seed.jaffle_shop.raw_payments"
[0m15:22:40.742857 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m15:22:40.742920 [debug] [Thread-1 (]: finished collecting timing info
[0m15:22:40.742979 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_payments
[0m15:22:40.748594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:40.824511 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m15:22:40.858334 [debug] [Thread-2 (]: finished collecting timing info
[0m15:22:40.858620 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882488e5-03ab-415d-8b94-f0c922c611d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea7e50>]}
[0m15:22:40.858755 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file darren_vertex_samples.raw_orders .................... [[32mINSERT 99[0m in 3.63s]
[0m15:22:40.858942 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m15:22:44.262203 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m15:22:44.264843 [debug] [Thread-1 (]: finished collecting timing info
[0m15:22:44.265143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882488e5-03ab-415d-8b94-f0c922c611d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120657850>]}
[0m15:22:44.265293 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file darren_vertex_samples.raw_payments .................. [[32mINSERT 113[0m in 3.52s]
[0m15:22:44.265498 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_payments
[0m15:22:44.266066 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:22:44.266264 [info ] [MainThread]: 
[0m15:22:44.266391 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 9.47 seconds (9.47s).
[0m15:22:44.266502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:44.266558 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m15:22:44.266613 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m15:22:44.280019 [info ] [MainThread]: 
[0m15:22:44.280216 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:44.280354 [info ] [MainThread]: 
[0m15:22:44.280459 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:22:44.280623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12032ec80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120617430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120615090>]}


============================== 2022-08-12 15:45:40.337058 | a621c2d6-4ec0-4e3b-9e8a-d99df72801ce ==============================
[0m15:45:40.337174 [info ] [MainThread]: Running with dbt=1.2.0
[0m15:45:40.337978 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:45:40.338090 [debug] [MainThread]: Tracking: tracking
[0m15:45:40.357945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a6a40>]}
[0m15:45:40.380851 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:45:40.381085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a621c2d6-4ec0-4e3b-9e8a-d99df72801ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108886950>]}
[0m15:45:40.437867 [debug] [MainThread]: Parsing macros/example_macro.sql
[0m15:45:40.438388 [debug] [MainThread]: Parsing macros/etc.sql
[0m15:45:40.439255 [debug] [MainThread]: Parsing macros/catalog.sql
[0m15:45:40.442346 [debug] [MainThread]: Parsing macros/adapters.sql
[0m15:45:40.452927 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m15:45:40.453975 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m15:45:40.455144 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m15:45:40.457076 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m15:45:40.458213 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m15:45:40.464932 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m15:45:40.465597 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m15:45:40.465755 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:45:40.466018 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m15:45:40.466162 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m15:45:40.466390 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m15:45:40.466650 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:45:40.467059 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:45:40.467567 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m15:45:40.467770 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m15:45:40.467972 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m15:45:40.468186 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m15:45:40.468356 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:45:40.468925 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m15:45:40.469139 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m15:45:40.470263 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m15:45:40.471845 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m15:45:40.472778 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m15:45:40.473467 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m15:45:40.480628 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m15:45:40.486629 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m15:45:40.492231 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m15:45:40.494168 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m15:45:40.494934 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m15:45:40.495683 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m15:45:40.497531 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m15:45:40.505507 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m15:45:40.506170 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m15:45:40.532525 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m15:45:40.539962 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m15:45:40.542552 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m15:45:40.543835 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m15:45:40.546402 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m15:45:40.546970 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m15:45:40.548520 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m15:45:40.549534 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m15:45:40.552829 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m15:45:40.561182 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m15:45:40.561817 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m15:45:40.562846 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m15:45:40.563489 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m15:45:40.563865 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m15:45:40.564191 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m15:45:40.564470 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m15:45:40.565043 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m15:45:40.566906 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m15:45:40.570589 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m15:45:40.570929 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m15:45:40.571434 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m15:45:40.571824 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m15:45:40.572204 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:45:40.572712 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m15:45:40.573034 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m15:45:40.573458 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m15:45:40.573894 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:45:40.574941 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:45:40.575442 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m15:45:40.575881 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m15:45:40.576312 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m15:45:40.576733 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m15:45:40.577103 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m15:45:40.577538 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m15:45:40.577904 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m15:45:40.580357 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m15:45:40.580736 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m15:45:40.581477 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:45:40.582342 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m15:45:40.582765 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m15:45:40.583697 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m15:45:40.584783 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m15:45:40.591188 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m15:45:40.592385 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m15:45:40.598159 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m15:45:40.599998 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m15:45:40.603087 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m15:45:40.607231 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m15:45:40.608468 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m15:45:40.608884 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m15:45:40.609386 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m15:45:40.609840 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m15:45:40.612219 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m15:45:40.612680 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m15:45:40.613724 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m15:45:40.614236 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m15:45:40.615393 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m15:45:40.615809 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m15:45:40.616729 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m15:45:40.617667 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m15:45:40.621599 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m15:45:40.626063 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m15:45:40.626797 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m15:45:40.627354 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m15:45:40.627932 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m15:45:40.628585 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m15:45:40.629090 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m15:45:40.629716 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m15:45:40.630155 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m15:45:40.631545 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m15:45:40.634188 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m15:45:40.650735 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m15:45:40.651474 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m15:45:40.652960 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m15:45:40.655794 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m15:45:40.656423 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m15:45:40.657680 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m15:45:40.658543 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m15:45:40.659450 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m15:45:40.670986 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m15:45:40.671831 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m15:45:40.672952 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m15:45:40.673591 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m15:45:40.674343 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m15:45:40.675024 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m15:45:40.675971 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m15:45:40.676685 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m15:45:40.677178 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m15:45:40.678264 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m15:45:40.679160 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m15:45:40.679737 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m15:45:40.680252 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m15:45:40.681438 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m15:45:40.682307 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m15:45:40.683047 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m15:45:40.683960 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m15:45:40.685224 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m15:45:40.685800 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m15:45:40.687344 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m15:45:40.691556 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m15:45:40.692002 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m15:45:40.692488 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m15:45:40.692929 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m15:45:40.693402 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m15:45:40.695166 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m15:45:40.695887 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m15:45:40.697333 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m15:45:40.699143 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m15:45:40.700582 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m15:45:40.701265 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m15:45:40.702840 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m15:45:40.706407 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m15:45:40.711577 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m15:45:40.712122 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m15:45:40.715240 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m15:45:40.716682 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m15:45:40.717338 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m15:45:40.718000 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m15:45:40.720956 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m15:45:40.723386 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m15:45:40.725167 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m15:45:40.726311 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m15:45:40.727252 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m15:45:40.727947 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m15:45:40.901176 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers.sql
[0m15:45:40.906334 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payments.sql
[0m15:45:40.907301 [debug] [MainThread]: 1603: static parser failed on staging/stg_orders.sql
[0m15:45:40.909502 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_orders.sql
[0m15:45:40.910121 [debug] [MainThread]: 1699: static parser successfully parsed staging/hidden_model.sql
[0m15:45:40.911188 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/dim_customers.sql
[0m15:45:40.912152 [debug] [MainThread]: 1603: static parser failed on marts/core/fct_orders.sql
[0m15:45:40.914208 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/core/fct_orders.sql
[0m15:45:40.914696 [debug] [MainThread]: 1603: static parser failed on marts/core/intermediate/order_payments.sql
[0m15:45:40.916601 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/core/intermediate/order_payments.sql
[0m15:45:40.917157 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/intermediate/customer_payments.sql
[0m15:45:40.918174 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/intermediate/customer_orders.sql
[0m15:45:41.025896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a621c2d6-4ec0-4e3b-9e8a-d99df72801ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097a7790>]}
[0m15:45:41.033498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a621c2d6-4ec0-4e3b-9e8a-d99df72801ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ff9a0>]}
[0m15:45:41.033632 [info ] [MainThread]: Found 9 models, 23 tests, 0 snapshots, 1 analysis, 523 macros, 0 operations, 3 seed files, 2 sources, 3 exposures, 2 metrics
[0m15:45:41.033745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a621c2d6-4ec0-4e3b-9e8a-d99df72801ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108884550>]}
[0m15:45:41.034635 [info ] [MainThread]: 
[0m15:45:41.034855 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:45:41.035290 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev"
[0m15:45:41.035397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:41.587194 [debug] [ThreadPool]: Acquiring new bigquery connection "create_msm-groupdata-customer-dev_darren"
[0m15:45:41.587706 [debug] [ThreadPool]: Acquiring new bigquery connection "create_msm-groupdata-customer-dev_darren"
[0m15:45:41.587806 [debug] [ThreadPool]: BigQuery adapter: Creating schema "msm-groupdata-customer-dev.darren".
[0m15:45:41.587882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:42.545222 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev_darren_vertex_samples"
[0m15:45:42.545905 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev_darren"
[0m15:45:42.546312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:42.546563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:42.871470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a621c2d6-4ec0-4e3b-9e8a-d99df72801ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097a6470>]}
[0m15:45:42.873303 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:45:42.873878 [info ] [MainThread]: 
[0m15:45:42.883058 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m15:45:42.883273 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m15:45:42.883651 [info ] [Thread-1 (]: 1 of 6 START view model darren.stg_customers ................................... [RUN]
[0m15:45:42.883919 [info ] [Thread-2 (]: 2 of 6 START view model darren.stg_orders ...................................... [RUN]
[0m15:45:42.884432 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.stg_customers"
[0m15:45:42.884923 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.stg_orders"
[0m15:45:42.885102 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m15:45:42.885253 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m15:45:42.885468 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_customers
[0m15:45:42.885608 [debug] [Thread-2 (]: Compiling model.jaffle_shop.stg_orders
[0m15:45:42.889846 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m15:45:42.893135 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m15:45:42.894313 [debug] [Thread-1 (]: finished collecting timing info
[0m15:45:42.894452 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m15:45:42.894549 [debug] [Thread-2 (]: finished collecting timing info
[0m15:45:42.916650 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.stg_customers"
[0m15:45:42.916779 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m15:45:42.918501 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.stg_orders"
[0m15:45:42.918754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:42.918876 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `msm-groupdata-customer-dev`.`darren`.`stg_customers`
  OPTIONS()
  as with source as (
    select * from `msm-groupdata-customer-dev`.`darren_vertex_samples`.`raw_customers`

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name,
        email

    from source

)

select * from renamed;


[0m15:45:42.919599 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:45:42.919702 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `msm-groupdata-customer-dev`.`darren`.`stg_orders`
  OPTIONS()
  as /*
hack for example macro references:
    

    The provided args are abc and 123


*/

with source as (
    select * from `msm-groupdata-customer-dev`.`darren_vertex_samples`.`raw_orders`

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed;


[0m15:45:43.675398 [debug] [Thread-1 (]: finished collecting timing info
[0m15:45:43.675655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a621c2d6-4ec0-4e3b-9e8a-d99df72801ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109add330>]}
[0m15:45:43.675833 [info ] [Thread-1 (]: 1 of 6 OK created view model darren.stg_customers .............................. [[32mOK[0m in 0.79s]
[0m15:45:43.676311 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m15:45:43.676807 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m15:45:43.677048 [info ] [Thread-1 (]: 3 of 6 START view model darren.stg_payments .................................... [RUN]
[0m15:45:43.677364 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.stg_payments"
[0m15:45:43.677530 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m15:45:43.677677 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_payments
[0m15:45:43.679576 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m15:45:43.680124 [debug] [Thread-1 (]: finished collecting timing info
[0m15:45:43.680196 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m15:45:43.681492 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.stg_payments"
[0m15:45:43.681964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:43.682054 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */


  create or replace view `msm-groupdata-customer-dev`.`darren`.`stg_payments`
  OPTIONS()
  as with source as (
    select * from `msm-groupdata-customer-dev`.`darren_vertex_samples`.`raw_payments`

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        --`amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed;


[0m15:45:43.823327 [debug] [Thread-2 (]: finished collecting timing info
[0m15:45:43.823871 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a621c2d6-4ec0-4e3b-9e8a-d99df72801ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109970ee0>]}
[0m15:45:43.824190 [info ] [Thread-2 (]: 2 of 6 OK created view model darren.stg_orders ................................. [[32mOK[0m in 0.94s]
[0m15:45:43.824536 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m15:45:43.824902 [debug] [Thread-2 (]: Began running node model.jaffle_shop.customer_orders
[0m15:45:43.825164 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.customer_orders"
[0m15:45:43.825284 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.customer_orders
[0m15:45:43.825397 [debug] [Thread-2 (]: Compiling model.jaffle_shop.customer_orders
[0m15:45:43.828405 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.customer_orders"
[0m15:45:43.829675 [debug] [Thread-2 (]: finished collecting timing info
[0m15:45:43.829965 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.customer_orders
[0m15:45:43.830084 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hidden_model
[0m15:45:43.830291 [info ] [Thread-2 (]: 4 of 6 START view model darren.hidden_model .................................... [RUN]
[0m15:45:43.830573 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.hidden_model"
[0m15:45:43.830670 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hidden_model
[0m15:45:43.830757 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hidden_model
[0m15:45:43.833047 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hidden_model"
[0m15:45:43.833627 [debug] [Thread-2 (]: finished collecting timing info
[0m15:45:43.833739 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hidden_model
[0m15:45:43.835873 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hidden_model"
[0m15:45:43.836853 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:45:43.837010 [debug] [Thread-2 (]: On model.jaffle_shop.hidden_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.hidden_model"} */


  create or replace view `msm-groupdata-customer-dev`.`darren`.`hidden_model`
  OPTIONS()
  as -- hack for DAG viz
-- `msm-groupdata-customer-dev`.`darren`.`raw_orders`

select * from `msm-groupdata-customer-dev`.`darren`.`stg_orders`;


[0m15:45:44.335204 [debug] [Thread-1 (]: finished collecting timing info
[0m15:45:44.335840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a621c2d6-4ec0-4e3b-9e8a-d99df72801ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088989d0>]}
[0m15:45:44.336064 [info ] [Thread-1 (]: 3 of 6 OK created view model darren.stg_payments ............................... [[32mOK[0m in 0.66s]
[0m15:45:44.336264 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m15:45:44.336463 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_payments
[0m15:45:44.336630 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.customer_payments"
[0m15:45:44.336701 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customer_payments
[0m15:45:44.336772 [debug] [Thread-1 (]: Compiling model.jaffle_shop.customer_payments
[0m15:45:44.339519 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customer_payments"
[0m15:45:44.340245 [debug] [Thread-1 (]: finished collecting timing info
[0m15:45:44.340477 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_payments
[0m15:45:44.340575 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payments
[0m15:45:44.340754 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.order_payments"
[0m15:45:44.340823 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payments
[0m15:45:44.340882 [debug] [Thread-1 (]: Compiling model.jaffle_shop.order_payments
[0m15:45:44.342989 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payments"
[0m15:45:44.343591 [debug] [Thread-1 (]: finished collecting timing info
[0m15:45:44.343765 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payments
[0m15:45:44.343836 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m15:45:44.343930 [info ] [Thread-1 (]: 5 of 6 START table model darren.dim_customers .................................. [RUN]
[0m15:45:44.344095 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.dim_customers"
[0m15:45:44.344158 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m15:45:44.344212 [debug] [Thread-1 (]: Compiling model.jaffle_shop.dim_customers
[0m15:45:44.350852 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m15:45:44.351620 [debug] [Thread-1 (]: finished collecting timing info
[0m15:45:44.351695 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m15:45:44.362600 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.dim_customers"
[0m15:45:44.363306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:44.363412 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `msm-groupdata-customer-dev`.`darren`.`dim_customers`
  
  
  OPTIONS()
  as (
    with  __dbt__cte__customer_orders as (
with orders as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_orders`

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

)

select * from final
),  __dbt__cte__customer_payments as (
with payments as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_payments`

),

orders as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_orders`

),

final as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders using (order_id)

    group by 1

)

select * from final
),customers as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_customers`

),

customer_orders as (

    select * from __dbt__cte__customer_orders

),

customer_payments as (

    select * from __dbt__cte__customer_payments

),

final as (

    select
        customers.customer_id,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders using (customer_id)

    left join customer_payments using (customer_id)

)

select * from final
  );
  
[0m15:45:44.669118 [debug] [Thread-2 (]: finished collecting timing info
[0m15:45:44.670686 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a621c2d6-4ec0-4e3b-9e8a-d99df72801ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ae440>]}
[0m15:45:44.671220 [info ] [Thread-2 (]: 4 of 6 OK created view model darren.hidden_model ............................... [[32mOK[0m in 0.84s]
[0m15:45:44.671629 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hidden_model
[0m15:45:44.671811 [debug] [Thread-2 (]: Began running node model.jaffle_shop.fct_orders
[0m15:45:44.672093 [info ] [Thread-2 (]: 6 of 6 START table model darren.fct_orders ..................................... [RUN]
[0m15:45:44.672494 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.fct_orders"
[0m15:45:44.672623 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.fct_orders
[0m15:45:44.672749 [debug] [Thread-2 (]: Compiling model.jaffle_shop.fct_orders
[0m15:45:44.682270 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m15:45:44.682993 [debug] [Thread-2 (]: finished collecting timing info
[0m15:45:44.683109 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.fct_orders
[0m15:45:44.686228 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.fct_orders"
[0m15:45:44.686687 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:45:44.686817 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */


  create or replace table `msm-groupdata-customer-dev`.`darren`.`fct_orders`
  
  
  OPTIONS()
  as (
    

with  __dbt__cte__order_payments as (


with payments as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_payments`

),

final as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by 1

)

select * from final
),orders as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_orders`

),

order_payments as (

    select * from __dbt__cte__order_payments

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
  
[0m15:45:47.538764 [debug] [Thread-2 (]: finished collecting timing info
[0m15:45:47.539928 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a621c2d6-4ec0-4e3b-9e8a-d99df72801ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089892a0>]}
[0m15:45:47.540542 [info ] [Thread-2 (]: 6 of 6 OK created table model darren.fct_orders ................................ [[32mCREATE TABLE (99.0 rows, 6.5 KB processed)[0m in 2.87s]
[0m15:45:47.541162 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.fct_orders
[0m15:45:49.188276 [debug] [Thread-1 (]: finished collecting timing info
[0m15:45:49.189333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a621c2d6-4ec0-4e3b-9e8a-d99df72801ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109601ff0>]}
[0m15:45:49.189902 [info ] [Thread-1 (]: 5 of 6 OK created table model darren.dim_customers ............................. [[32mCREATE TABLE (100.0 rows, 4.9 KB processed)[0m in 4.85s]
[0m15:45:49.190466 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m15:45:49.191990 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:45:49.192532 [info ] [MainThread]: 
[0m15:45:49.192858 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 8.16 seconds (8.16s).
[0m15:45:49.193159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:49.193309 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m15:45:49.193450 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
[0m15:45:49.208130 [info ] [MainThread]: 
[0m15:45:49.208378 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:45:49.208584 [info ] [MainThread]: 
[0m15:45:49.208748 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:45:49.208999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109600250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096023e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10997a9e0>]}


============================== 2022-08-15 20:30:18.109995 | 4f517448-eb0d-474f-adbb-37bdf9029b2b ==============================
[0m20:30:18.110031 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:30:18.110608 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:30:18.110689 [debug] [MainThread]: Tracking: tracking
[0m20:30:18.130919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a9f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a9c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a9ba0>]}
[0m20:30:18.209609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:30:18.209744 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:30:18.213166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f517448-eb0d-474f-adbb-37bdf9029b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e80d0>]}
[0m20:30:18.242811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f517448-eb0d-474f-adbb-37bdf9029b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ed0c0>]}
[0m20:30:18.242990 [info ] [MainThread]: Found 9 models, 23 tests, 0 snapshots, 1 analysis, 523 macros, 0 operations, 3 seed files, 2 sources, 3 exposures, 2 metrics
[0m20:30:18.243110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f517448-eb0d-474f-adbb-37bdf9029b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ed180>]}
[0m20:30:18.244032 [info ] [MainThread]: 
[0m20:30:18.244239 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:30:18.244676 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev"
[0m20:30:18.244780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:18.864276 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev_darren"
[0m20:30:18.864686 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev_darren_vertex_samples"
[0m20:30:18.864955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:30:18.865053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:19.133255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f517448-eb0d-474f-adbb-37bdf9029b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041a6e60>]}
[0m20:30:19.134070 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:30:19.134402 [info ] [MainThread]: 
[0m20:30:19.140067 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m20:30:19.140191 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m20:30:19.140314 [info ] [Thread-1 (]: 1 of 6 START view model darren.stg_customers ................................... [RUN]
[0m20:30:19.140440 [info ] [Thread-2 (]: 2 of 6 START view model darren.stg_orders ...................................... [RUN]
[0m20:30:19.140672 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.stg_customers"
[0m20:30:19.140838 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.stg_orders"
[0m20:30:19.140920 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m20:30:19.141001 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m20:30:19.141097 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_customers
[0m20:30:19.141183 [debug] [Thread-2 (]: Compiling model.jaffle_shop.stg_orders
[0m20:30:19.143080 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m20:30:19.144987 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m20:30:19.146056 [debug] [Thread-2 (]: finished collecting timing info
[0m20:30:19.146138 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m20:30:19.146690 [debug] [Thread-1 (]: finished collecting timing info
[0m20:30:19.146763 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m20:30:19.161402 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.stg_customers"
[0m20:30:19.164878 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.stg_orders"
[0m20:30:19.164992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:19.165157 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `msm-groupdata-customer-dev`.`darren`.`stg_customers`
  OPTIONS()
  as with source as (
    select * from `msm-groupdata-customer-dev`.`darren_vertex_samples`.`raw_customers`

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name,
        email

    from source

)

select * from renamed;


[0m20:30:19.169333 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:30:19.169468 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `msm-groupdata-customer-dev`.`darren`.`stg_orders`
  OPTIONS()
  as /*
hack for example macro references:
    

    The provided args are abc and 123


*/

with source as (
    select * from `msm-groupdata-customer-dev`.`darren_vertex_samples`.`raw_orders`

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed;


[0m20:30:19.887566 [debug] [Thread-2 (]: finished collecting timing info
[0m20:30:19.888402 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f517448-eb0d-474f-adbb-37bdf9029b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ec070>]}
[0m20:30:19.888769 [info ] [Thread-2 (]: 2 of 6 OK created view model darren.stg_orders ................................. [[32mOK[0m in 0.75s]
[0m20:30:19.889140 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m20:30:19.889290 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_payments
[0m20:30:19.889595 [info ] [Thread-2 (]: 3 of 6 START view model darren.stg_payments .................................... [RUN]
[0m20:30:19.890031 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.stg_payments"
[0m20:30:19.890148 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_payments
[0m20:30:19.890263 [debug] [Thread-2 (]: Compiling model.jaffle_shop.stg_payments
[0m20:30:19.892954 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m20:30:19.894402 [debug] [Thread-2 (]: finished collecting timing info
[0m20:30:19.894528 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_payments
[0m20:30:19.896822 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.stg_payments"
[0m20:30:19.899141 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:30:19.899319 [debug] [Thread-2 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */


  create or replace view `msm-groupdata-customer-dev`.`darren`.`stg_payments`
  OPTIONS()
  as with source as (
    select * from `msm-groupdata-customer-dev`.`darren_vertex_samples`.`raw_payments`

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        --`amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed;


[0m20:30:20.214554 [debug] [Thread-1 (]: finished collecting timing info
[0m20:30:20.215481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f517448-eb0d-474f-adbb-37bdf9029b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669ee60>]}
[0m20:30:20.215978 [info ] [Thread-1 (]: 1 of 6 OK created view model darren.stg_customers .............................. [[32mOK[0m in 1.07s]
[0m20:30:20.216518 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m20:30:20.216761 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_orders
[0m20:30:20.217294 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.customer_orders"
[0m20:30:20.217542 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customer_orders
[0m20:30:20.217743 [debug] [Thread-1 (]: Compiling model.jaffle_shop.customer_orders
[0m20:30:20.221752 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customer_orders"
[0m20:30:20.227520 [debug] [Thread-1 (]: finished collecting timing info
[0m20:30:20.227928 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_orders
[0m20:30:20.228097 [debug] [Thread-1 (]: Began running node model.jaffle_shop.hidden_model
[0m20:30:20.228306 [info ] [Thread-1 (]: 4 of 6 START view model darren.hidden_model .................................... [RUN]
[0m20:30:20.228789 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.hidden_model"
[0m20:30:20.228937 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.hidden_model
[0m20:30:20.229069 [debug] [Thread-1 (]: Compiling model.jaffle_shop.hidden_model
[0m20:30:20.232151 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.hidden_model"
[0m20:30:20.233170 [debug] [Thread-1 (]: finished collecting timing info
[0m20:30:20.233308 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.hidden_model
[0m20:30:20.240714 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.hidden_model"
[0m20:30:20.241901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:20.242104 [debug] [Thread-1 (]: On model.jaffle_shop.hidden_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.hidden_model"} */


  create or replace view `msm-groupdata-customer-dev`.`darren`.`hidden_model`
  OPTIONS()
  as -- hack for DAG viz
-- `msm-groupdata-customer-dev`.`darren`.`raw_orders`

select * from `msm-groupdata-customer-dev`.`darren`.`stg_orders`;


[0m20:30:20.852176 [debug] [Thread-2 (]: finished collecting timing info
[0m20:30:20.852994 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f517448-eb0d-474f-adbb-37bdf9029b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078be650>]}
[0m20:30:20.853505 [info ] [Thread-2 (]: 3 of 6 OK created view model darren.stg_payments ............................... [[32mOK[0m in 0.96s]
[0m20:30:20.854035 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_payments
[0m20:30:20.854550 [debug] [Thread-2 (]: Began running node model.jaffle_shop.customer_payments
[0m20:30:20.854927 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.customer_payments"
[0m20:30:20.855099 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.customer_payments
[0m20:30:20.855254 [debug] [Thread-2 (]: Compiling model.jaffle_shop.customer_payments
[0m20:30:20.859418 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.customer_payments"
[0m20:30:20.860899 [debug] [Thread-2 (]: finished collecting timing info
[0m20:30:20.861288 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.customer_payments
[0m20:30:20.861441 [debug] [Thread-2 (]: Began running node model.jaffle_shop.order_payments
[0m20:30:20.861850 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.order_payments"
[0m20:30:20.862023 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.order_payments
[0m20:30:20.862152 [debug] [Thread-2 (]: Compiling model.jaffle_shop.order_payments
[0m20:30:20.865706 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.order_payments"
[0m20:30:20.867299 [debug] [Thread-2 (]: finished collecting timing info
[0m20:30:20.867627 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.order_payments
[0m20:30:20.867768 [debug] [Thread-2 (]: Began running node model.jaffle_shop.dim_customers
[0m20:30:20.867999 [info ] [Thread-2 (]: 5 of 6 START table model darren.dim_customers .................................. [RUN]
[0m20:30:20.868384 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.dim_customers"
[0m20:30:20.868483 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.dim_customers
[0m20:30:20.868574 [debug] [Thread-2 (]: Compiling model.jaffle_shop.dim_customers
[0m20:30:20.880595 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m20:30:20.884501 [debug] [Thread-2 (]: finished collecting timing info
[0m20:30:20.884608 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.dim_customers
[0m20:30:20.892053 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:30:20.978309 [debug] [Thread-1 (]: finished collecting timing info
[0m20:30:20.978720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f517448-eb0d-474f-adbb-37bdf9029b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669ea40>]}
[0m20:30:20.978995 [info ] [Thread-1 (]: 4 of 6 OK created view model darren.hidden_model ............................... [[32mOK[0m in 0.75s]
[0m20:30:20.979292 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.hidden_model
[0m20:30:20.979425 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m20:30:20.979575 [info ] [Thread-1 (]: 6 of 6 START table model darren.fct_orders ..................................... [RUN]
[0m20:30:20.979859 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.fct_orders"
[0m20:30:20.980033 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m20:30:20.980163 [debug] [Thread-1 (]: Compiling model.jaffle_shop.fct_orders
[0m20:30:20.989932 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m20:30:20.990543 [debug] [Thread-1 (]: finished collecting timing info
[0m20:30:20.990631 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m20:30:20.992092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:21.111846 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.dim_customers"
[0m20:30:21.112790 [debug] [Thread-2 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `msm-groupdata-customer-dev`.`darren`.`dim_customers`
  
  
  OPTIONS()
  as (
    with  __dbt__cte__customer_orders as (
with orders as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_orders`

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

)

select * from final
),  __dbt__cte__customer_payments as (
with payments as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_payments`

),

orders as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_orders`

),

final as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders using (order_id)

    group by 1

)

select * from final
),customers as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_customers`

),

customer_orders as (

    select * from __dbt__cte__customer_orders

),

customer_payments as (

    select * from __dbt__cte__customer_payments

),

final as (

    select
        customers.customer_id,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders using (customer_id)

    left join customer_payments using (customer_id)

)

select * from final
  );
  
[0m20:30:21.251329 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.fct_orders"
[0m20:30:21.252535 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */


  create or replace table `msm-groupdata-customer-dev`.`darren`.`fct_orders`
  
  
  OPTIONS()
  as (
    

with  __dbt__cte__order_payments as (


with payments as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_payments`

),

final as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by 1

)

select * from final
),orders as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_orders`

),

order_payments as (

    select * from __dbt__cte__order_payments

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
  
[0m20:30:23.974915 [debug] [Thread-2 (]: finished collecting timing info
[0m20:30:23.975704 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f517448-eb0d-474f-adbb-37bdf9029b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10668afe0>]}
[0m20:30:23.976211 [info ] [Thread-2 (]: 5 of 6 OK created table model darren.dim_customers ............................. [[32mCREATE TABLE (100.0 rows, 4.9 KB processed)[0m in 3.11s]
[0m20:30:23.976813 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.dim_customers
[0m20:30:24.023250 [debug] [Thread-1 (]: finished collecting timing info
[0m20:30:24.023876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f517448-eb0d-474f-adbb-37bdf9029b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041ee8c0>]}
[0m20:30:24.024261 [info ] [Thread-1 (]: 6 of 6 OK created table model darren.fct_orders ................................ [[32mCREATE TABLE (99.0 rows, 6.5 KB processed)[0m in 3.04s]
[0m20:30:24.024704 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m20:30:24.026017 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:30:24.026442 [info ] [MainThread]: 
[0m20:30:24.026682 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 5.78 seconds (5.78s).
[0m20:30:24.026892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:30:24.026996 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
[0m20:30:24.027093 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m20:30:24.038679 [info ] [MainThread]: 
[0m20:30:24.038918 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:30:24.039111 [info ] [MainThread]: 
[0m20:30:24.039264 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:30:24.039482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e2b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107873610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041ee830>]}


============================== 2022-08-15 20:39:22.560478 | 1cfe678c-fc40-4228-a93a-c8af32c05b95 ==============================
[0m20:39:22.560627 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:39:22.561296 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:39:22.561402 [debug] [MainThread]: Tracking: tracking
[0m20:39:22.585234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116063370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116061cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116061c60>]}
[0m20:39:22.651816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:39:22.651955 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:39:22.655487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cfe678c-fc40-4228-a93a-c8af32c05b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11635c0d0>]}
[0m20:39:22.686079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cfe678c-fc40-4228-a93a-c8af32c05b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115fa5060>]}
[0m20:39:22.686279 [info ] [MainThread]: Found 9 models, 23 tests, 0 snapshots, 1 analysis, 523 macros, 0 operations, 3 seed files, 2 sources, 3 exposures, 2 metrics
[0m20:39:22.686405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cfe678c-fc40-4228-a93a-c8af32c05b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115fa51e0>]}
[0m20:39:22.687372 [info ] [MainThread]: 
[0m20:39:22.687597 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:39:22.688063 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev"
[0m20:39:22.688179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:23.212709 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev_darren"
[0m20:39:23.213383 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev_darren_vertex_samples"
[0m20:39:23.213746 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:39:23.214000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:23.464122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cfe678c-fc40-4228-a93a-c8af32c05b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152f8970>]}
[0m20:39:23.466421 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:39:23.467282 [info ] [MainThread]: 
[0m20:39:23.474484 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m20:39:23.474695 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m20:39:23.475114 [info ] [Thread-1 (]: 1 of 6 START view model darren.stg_customers ................................... [RUN]
[0m20:39:23.475390 [info ] [Thread-2 (]: 2 of 6 START view model darren.stg_orders ...................................... [RUN]
[0m20:39:23.475890 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.stg_customers"
[0m20:39:23.476327 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.stg_orders"
[0m20:39:23.476507 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m20:39:23.476654 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m20:39:23.476880 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_customers
[0m20:39:23.477017 [debug] [Thread-2 (]: Compiling model.jaffle_shop.stg_orders
[0m20:39:23.481610 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m20:39:23.485415 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m20:39:23.486544 [debug] [Thread-2 (]: finished collecting timing info
[0m20:39:23.486681 [debug] [Thread-1 (]: finished collecting timing info
[0m20:39:23.486802 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m20:39:23.486937 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m20:39:23.511501 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.stg_customers"
[0m20:39:23.515559 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.stg_orders"
[0m20:39:23.515772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:23.515893 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `msm-groupdata-customer-dev`.`darren`.`stg_customers`
  OPTIONS()
  as with source as (
    select * from `msm-groupdata-customer-dev`.`darren_vertex_samples`.`raw_customers`

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name,
        email

    from source

)

select * from renamed;


[0m20:39:23.516573 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:23.516679 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `msm-groupdata-customer-dev`.`darren`.`stg_orders`
  OPTIONS()
  as /*
hack for example macro references:
    

    The provided args are abc and 123


*/

with source as (
    select * from `msm-groupdata-customer-dev`.`darren_vertex_samples`.`raw_orders`

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed;


[0m20:39:24.397789 [debug] [Thread-1 (]: finished collecting timing info
[0m20:39:24.398536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cfe678c-fc40-4228-a93a-c8af32c05b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152f8820>]}
[0m20:39:24.398889 [info ] [Thread-1 (]: 1 of 6 OK created view model darren.stg_customers .............................. [[32mOK[0m in 0.92s]
[0m20:39:24.399262 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m20:39:24.399425 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m20:39:24.399720 [info ] [Thread-1 (]: 3 of 6 START view model darren.stg_payments .................................... [RUN]
[0m20:39:24.400086 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.stg_payments"
[0m20:39:24.400209 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m20:39:24.400333 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_payments
[0m20:39:24.403080 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m20:39:24.404419 [debug] [Thread-1 (]: finished collecting timing info
[0m20:39:24.404523 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m20:39:24.406705 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.stg_payments"
[0m20:39:24.407722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:24.407903 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */


  create or replace view `msm-groupdata-customer-dev`.`darren`.`stg_payments`
  OPTIONS()
  as with source as (
    select * from `msm-groupdata-customer-dev`.`darren_vertex_samples`.`raw_payments`

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        --`amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed;


[0m20:39:24.414308 [debug] [Thread-2 (]: finished collecting timing info
[0m20:39:24.414683 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cfe678c-fc40-4228-a93a-c8af32c05b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1160606a0>]}
[0m20:39:24.414948 [info ] [Thread-2 (]: 2 of 6 OK created view model darren.stg_orders ................................. [[32mOK[0m in 0.94s]
[0m20:39:24.415226 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m20:39:24.415528 [debug] [Thread-2 (]: Began running node model.jaffle_shop.customer_orders
[0m20:39:24.415773 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.customer_orders"
[0m20:39:24.415877 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.customer_orders
[0m20:39:24.415977 [debug] [Thread-2 (]: Compiling model.jaffle_shop.customer_orders
[0m20:39:24.418200 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.customer_orders"
[0m20:39:24.418835 [debug] [Thread-2 (]: finished collecting timing info
[0m20:39:24.419123 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.customer_orders
[0m20:39:24.419247 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hidden_model
[0m20:39:24.419434 [info ] [Thread-2 (]: 4 of 6 START view model darren.hidden_model .................................... [RUN]
[0m20:39:24.419735 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.hidden_model"
[0m20:39:24.419833 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hidden_model
[0m20:39:24.419921 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hidden_model
[0m20:39:24.421999 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hidden_model"
[0m20:39:24.425168 [debug] [Thread-2 (]: finished collecting timing info
[0m20:39:24.425264 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hidden_model
[0m20:39:24.429942 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hidden_model"
[0m20:39:24.430496 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:24.430621 [debug] [Thread-2 (]: On model.jaffle_shop.hidden_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.hidden_model"} */


  create or replace view `msm-groupdata-customer-dev`.`darren`.`hidden_model`
  OPTIONS()
  as -- hack for DAG viz
-- `msm-groupdata-customer-dev`.`darren`.`raw_orders`

select * from `msm-groupdata-customer-dev`.`darren`.`stg_orders`;


[0m20:39:24.981137 [debug] [Thread-1 (]: finished collecting timing info
[0m20:39:24.981950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cfe678c-fc40-4228-a93a-c8af32c05b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115fd7400>]}
[0m20:39:24.982423 [info ] [Thread-1 (]: 3 of 6 OK created view model darren.stg_payments ............................... [[32mOK[0m in 0.58s]
[0m20:39:24.982974 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m20:39:24.983513 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_payments
[0m20:39:24.983977 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.customer_payments"
[0m20:39:24.984178 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customer_payments
[0m20:39:24.984366 [debug] [Thread-1 (]: Compiling model.jaffle_shop.customer_payments
[0m20:39:24.988654 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customer_payments"
[0m20:39:24.990771 [debug] [Thread-1 (]: finished collecting timing info
[0m20:39:24.991163 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_payments
[0m20:39:24.991331 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payments
[0m20:39:24.991672 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.order_payments"
[0m20:39:24.991902 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payments
[0m20:39:24.992037 [debug] [Thread-1 (]: Compiling model.jaffle_shop.order_payments
[0m20:39:24.995508 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payments"
[0m20:39:24.996245 [debug] [Thread-1 (]: finished collecting timing info
[0m20:39:24.996583 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payments
[0m20:39:24.996726 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m20:39:24.996990 [info ] [Thread-1 (]: 5 of 6 START table model darren.dim_customers .................................. [RUN]
[0m20:39:24.997399 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.dim_customers"
[0m20:39:24.997518 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m20:39:24.997625 [debug] [Thread-1 (]: Compiling model.jaffle_shop.dim_customers
[0m20:39:25.011239 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m20:39:25.011888 [debug] [Thread-1 (]: finished collecting timing info
[0m20:39:25.012001 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m20:39:25.019909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:25.277697 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.dim_customers"
[0m20:39:25.279270 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `msm-groupdata-customer-dev`.`darren`.`dim_customers`
  
  
  OPTIONS()
  as (
    with  __dbt__cte__customer_orders as (
with orders as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_orders`

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

)

select * from final
),  __dbt__cte__customer_payments as (
with payments as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_payments`

),

orders as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_orders`

),

final as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders using (order_id)

    group by 1

)

select * from final
),customers as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_customers`

),

customer_orders as (

    select * from __dbt__cte__customer_orders

),

customer_payments as (

    select * from __dbt__cte__customer_payments

),

final as (

    select
        customers.customer_id,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders using (customer_id)

    left join customer_payments using (customer_id)

)

select * from final
  );
  
[0m20:39:25.385620 [debug] [Thread-2 (]: finished collecting timing info
[0m20:39:25.386319 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cfe678c-fc40-4228-a93a-c8af32c05b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1166db730>]}
[0m20:39:25.386800 [info ] [Thread-2 (]: 4 of 6 OK created view model darren.hidden_model ............................... [[32mOK[0m in 0.97s]
[0m20:39:25.387345 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hidden_model
[0m20:39:25.387585 [debug] [Thread-2 (]: Began running node model.jaffle_shop.fct_orders
[0m20:39:25.387958 [info ] [Thread-2 (]: 6 of 6 START table model darren.fct_orders ..................................... [RUN]
[0m20:39:25.388503 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.fct_orders"
[0m20:39:25.388657 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.fct_orders
[0m20:39:25.388806 [debug] [Thread-2 (]: Compiling model.jaffle_shop.fct_orders
[0m20:39:25.400310 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m20:39:25.402105 [debug] [Thread-2 (]: finished collecting timing info
[0m20:39:25.402241 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.fct_orders
[0m20:39:25.404456 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:25.633101 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.fct_orders"
[0m20:39:25.635626 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */


  create or replace table `msm-groupdata-customer-dev`.`darren`.`fct_orders`
  
  
  OPTIONS()
  as (
    

with  __dbt__cte__order_payments as (


with payments as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_payments`

),

final as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by 1

)

select * from final
),orders as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_orders`

),

order_payments as (

    select * from __dbt__cte__order_payments

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
  
[0m20:39:28.077070 [debug] [Thread-1 (]: finished collecting timing info
[0m20:39:28.077946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cfe678c-fc40-4228-a93a-c8af32c05b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116043400>]}
[0m20:39:28.078440 [info ] [Thread-1 (]: 5 of 6 OK created table model darren.dim_customers ............................. [[32mCREATE TABLE (100.0 rows, 4.9 KB processed)[0m in 3.08s]
[0m20:39:28.079008 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m20:39:28.206342 [debug] [Thread-2 (]: finished collecting timing info
[0m20:39:28.206845 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cfe678c-fc40-4228-a93a-c8af32c05b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1166e08e0>]}
[0m20:39:28.207164 [info ] [Thread-2 (]: 6 of 6 OK created table model darren.fct_orders ................................ [[32mCREATE TABLE (99.0 rows, 6.5 KB processed)[0m in 2.82s]
[0m20:39:28.207532 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.fct_orders
[0m20:39:28.208514 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:39:28.208885 [info ] [MainThread]: 
[0m20:39:28.209110 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 5.52 seconds (5.52s).
[0m20:39:28.209310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:39:28.209416 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m20:39:28.209518 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
[0m20:39:28.222864 [info ] [MainThread]: 
[0m20:39:28.223134 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:39:28.223367 [info ] [MainThread]: 
[0m20:39:28.223550 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:39:28.223811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1160437c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116042740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125c0f40>]}


============================== 2022-08-15 20:55:22.180124 | 88ff14e6-f995-45ec-8076-8c0280c043e4 ==============================
[0m20:55:22.180193 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:55:22.181138 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m20:55:22.181259 [debug] [MainThread]: Tracking: tracking
[0m20:55:22.199981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085af820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085aceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085aea40>]}
[0m20:55:22.276919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:55:22.277064 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:55:22.280559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88ff14e6-f995-45ec-8076-8c0280c043e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ec0d0>]}
[0m20:55:22.309970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88ff14e6-f995-45ec-8076-8c0280c043e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084f1060>]}
[0m20:55:22.310153 [info ] [MainThread]: Found 9 models, 23 tests, 0 snapshots, 1 analysis, 523 macros, 0 operations, 3 seed files, 2 sources, 3 exposures, 2 metrics
[0m20:55:22.310280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88ff14e6-f995-45ec-8076-8c0280c043e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109483fd0>]}
[0m20:55:22.311249 [info ] [MainThread]: 
[0m20:55:22.311453 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:55:22.311819 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev"
[0m20:55:22.311894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:22.881830 [debug] [ThreadPool]: Acquiring new bigquery connection "create_msm-groupdata-customer-dev_darren_vertex_samples"
[0m20:55:22.882718 [debug] [ThreadPool]: Acquiring new bigquery connection "create_msm-groupdata-customer-dev_darren_vertex_samples"
[0m20:55:22.882947 [debug] [ThreadPool]: BigQuery adapter: Creating schema "msm-groupdata-customer-dev.darren_vertex_samples".
[0m20:55:22.883168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:23.912284 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev_darren"
[0m20:55:23.913057 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev_darren_vertex_samples"
[0m20:55:23.913349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:23.913612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:24.149132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88ff14e6-f995-45ec-8076-8c0280c043e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b4910>]}
[0m20:55:24.150232 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:55:24.150650 [info ] [MainThread]: 
[0m20:55:24.160329 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m20:55:24.160557 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m20:55:24.160937 [info ] [Thread-1 (]: 1 of 3 START seed file darren_vertex_samples.raw_customers ..................... [RUN]
[0m20:55:24.161183 [info ] [Thread-2 (]: 2 of 3 START seed file darren_vertex_samples.raw_orders ........................ [RUN]
[0m20:55:24.161679 [debug] [Thread-1 (]: Acquiring new bigquery connection "seed.jaffle_shop.raw_customers"
[0m20:55:24.162127 [debug] [Thread-2 (]: Acquiring new bigquery connection "seed.jaffle_shop.raw_orders"
[0m20:55:24.162297 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m20:55:24.162447 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m20:55:24.162709 [debug] [Thread-1 (]: finished collecting timing info
[0m20:55:24.162850 [debug] [Thread-2 (]: finished collecting timing info
[0m20:55:24.162990 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m20:55:24.163114 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m20:55:24.203340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:24.204021 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:55:27.661752 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m20:55:27.663271 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m20:55:27.688524 [debug] [Thread-1 (]: finished collecting timing info
[0m20:55:27.689246 [debug] [Thread-2 (]: finished collecting timing info
[0m20:55:27.689478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88ff14e6-f995-45ec-8076-8c0280c043e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109494e50>]}
[0m20:55:27.689682 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88ff14e6-f995-45ec-8076-8c0280c043e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a673b50>]}
[0m20:55:27.689861 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file darren_vertex_samples.raw_customers ................. [[32mINSERT 100[0m in 3.53s]
[0m20:55:27.689997 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file darren_vertex_samples.raw_orders .................... [[32mINSERT 99[0m in 3.53s]
[0m20:55:27.690223 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m20:55:27.690395 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m20:55:27.690502 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_payments
[0m20:55:27.690774 [info ] [Thread-1 (]: 3 of 3 START seed file darren_vertex_samples.raw_payments ...................... [RUN]
[0m20:55:27.691045 [debug] [Thread-1 (]: Acquiring new bigquery connection "seed.jaffle_shop.raw_payments"
[0m20:55:27.691140 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m20:55:27.691224 [debug] [Thread-1 (]: finished collecting timing info
[0m20:55:27.691303 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_payments
[0m20:55:27.696397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:31.094089 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m20:55:31.100175 [debug] [Thread-1 (]: finished collecting timing info
[0m20:55:31.100673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88ff14e6-f995-45ec-8076-8c0280c043e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a2bf0>]}
[0m20:55:31.100997 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file darren_vertex_samples.raw_payments .................. [[32mINSERT 113[0m in 3.41s]
[0m20:55:31.101428 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_payments
[0m20:55:31.102639 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:55:31.103015 [info ] [MainThread]: 
[0m20:55:31.103270 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 8.79 seconds (8.79s).
[0m20:55:31.103505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:31.103621 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m20:55:31.103733 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m20:55:31.121735 [info ] [MainThread]: 
[0m20:55:31.121985 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:55:31.122154 [info ] [MainThread]: 
[0m20:55:31.122308 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:55:31.122512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6d2a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6d2f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6d2b30>]}


============================== 2022-08-15 20:57:27.482475 | 3571a071-23e7-4449-963a-af62fdefee98 ==============================
[0m20:57:27.482493 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:57:27.482903 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:57:27.482980 [debug] [MainThread]: Tracking: tracking
[0m20:57:27.497333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c05b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c0ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c1cc0>]}
[0m20:57:27.564943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:57:27.565081 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:57:27.568601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3571a071-23e7-4449-963a-af62fdefee98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820e830>]}
[0m20:57:27.598825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3571a071-23e7-4449-963a-af62fdefee98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e0340>]}
[0m20:57:27.598994 [info ] [MainThread]: Found 9 models, 23 tests, 0 snapshots, 1 analysis, 523 macros, 0 operations, 3 seed files, 2 sources, 3 exposures, 2 metrics
[0m20:57:27.599107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3571a071-23e7-4449-963a-af62fdefee98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e2aa0>]}
[0m20:57:27.600022 [info ] [MainThread]: 
[0m20:57:27.600233 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:57:27.600672 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev"
[0m20:57:27.600776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:28.090009 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev_darren_vertex_samples"
[0m20:57:28.090728 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev_darren"
[0m20:57:28.091087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:28.091308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:28.325527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3571a071-23e7-4449-963a-af62fdefee98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f5ae90>]}
[0m20:57:28.327967 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:57:28.328500 [info ] [MainThread]: 
[0m20:57:28.339499 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m20:57:28.339711 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m20:57:28.340119 [info ] [Thread-1 (]: 1 of 6 START view model darren.stg_customers ................................... [RUN]
[0m20:57:28.340453 [info ] [Thread-2 (]: 2 of 6 START view model darren.stg_orders ...................................... [RUN]
[0m20:57:28.341033 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.stg_customers"
[0m20:57:28.341444 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.stg_orders"
[0m20:57:28.341610 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m20:57:28.341762 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m20:57:28.341973 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_customers
[0m20:57:28.342109 [debug] [Thread-2 (]: Compiling model.jaffle_shop.stg_orders
[0m20:57:28.346939 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m20:57:28.350827 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m20:57:28.352720 [debug] [Thread-2 (]: finished collecting timing info
[0m20:57:28.352860 [debug] [Thread-1 (]: finished collecting timing info
[0m20:57:28.352996 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m20:57:28.353174 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m20:57:28.376551 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.stg_customers"
[0m20:57:28.380190 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.stg_orders"
[0m20:57:28.380439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:28.380565 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `msm-groupdata-customer-dev`.`darren`.`stg_customers`
  OPTIONS()
  as with source as (
    select * from `msm-groupdata-customer-dev`.`darren_vertex_samples`.`raw_customers`

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name,
        email

    from source

)

select * from renamed;


[0m20:57:28.381306 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:28.381489 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `msm-groupdata-customer-dev`.`darren`.`stg_orders`
  OPTIONS()
  as /*
hack for example macro references:
    

    The provided args are abc and 123


*/

with source as (
    select * from `msm-groupdata-customer-dev`.`darren_vertex_samples`.`raw_orders`

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed;


[0m20:57:29.125293 [debug] [Thread-1 (]: finished collecting timing info
[0m20:57:29.125919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3571a071-23e7-4449-963a-af62fdefee98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e2aa0>]}
[0m20:57:29.126291 [info ] [Thread-1 (]: 1 of 6 OK created view model darren.stg_customers .............................. [[32mOK[0m in 0.79s]
[0m20:57:29.126668 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m20:57:29.126825 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m20:57:29.126982 [info ] [Thread-1 (]: 3 of 6 START view model darren.stg_payments .................................... [RUN]
[0m20:57:29.127429 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.stg_payments"
[0m20:57:29.127570 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m20:57:29.127697 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_payments
[0m20:57:29.130359 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m20:57:29.133021 [debug] [Thread-1 (]: finished collecting timing info
[0m20:57:29.133156 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m20:57:29.135362 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.stg_payments"
[0m20:57:29.136684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:29.136861 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */


  create or replace view `msm-groupdata-customer-dev`.`darren`.`stg_payments`
  OPTIONS()
  as with source as (
    select * from `msm-groupdata-customer-dev`.`darren_vertex_samples`.`raw_payments`

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        --`amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed;


[0m20:57:29.295036 [debug] [Thread-2 (]: finished collecting timing info
[0m20:57:29.295881 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3571a071-23e7-4449-963a-af62fdefee98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820e7d0>]}
[0m20:57:29.296403 [info ] [Thread-2 (]: 2 of 6 OK created view model darren.stg_orders ................................. [[32mOK[0m in 0.95s]
[0m20:57:29.296950 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m20:57:29.297483 [debug] [Thread-2 (]: Began running node model.jaffle_shop.customer_orders
[0m20:57:29.297858 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.customer_orders"
[0m20:57:29.298050 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.customer_orders
[0m20:57:29.298231 [debug] [Thread-2 (]: Compiling model.jaffle_shop.customer_orders
[0m20:57:29.302127 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.customer_orders"
[0m20:57:29.303868 [debug] [Thread-2 (]: finished collecting timing info
[0m20:57:29.304403 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.customer_orders
[0m20:57:29.304598 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hidden_model
[0m20:57:29.304956 [info ] [Thread-2 (]: 4 of 6 START view model darren.hidden_model .................................... [RUN]
[0m20:57:29.305442 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.hidden_model"
[0m20:57:29.305575 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hidden_model
[0m20:57:29.305694 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hidden_model
[0m20:57:29.308824 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hidden_model"
[0m20:57:29.314533 [debug] [Thread-2 (]: finished collecting timing info
[0m20:57:29.314715 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hidden_model
[0m20:57:29.322175 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hidden_model"
[0m20:57:29.323053 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:29.323219 [debug] [Thread-2 (]: On model.jaffle_shop.hidden_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.hidden_model"} */


  create or replace view `msm-groupdata-customer-dev`.`darren`.`hidden_model`
  OPTIONS()
  as -- hack for DAG viz
-- `msm-groupdata-customer-dev`.`darren`.`raw_orders`

select * from `msm-groupdata-customer-dev`.`darren`.`stg_orders`;


[0m20:57:29.845953 [debug] [Thread-1 (]: finished collecting timing info
[0m20:57:29.846700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3571a071-23e7-4449-963a-af62fdefee98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ddd50>]}
[0m20:57:29.847075 [info ] [Thread-1 (]: 3 of 6 OK created view model darren.stg_payments ............................... [[32mOK[0m in 0.72s]
[0m20:57:29.847424 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m20:57:29.847760 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_payments
[0m20:57:29.848041 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.customer_payments"
[0m20:57:29.848199 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customer_payments
[0m20:57:29.848340 [debug] [Thread-1 (]: Compiling model.jaffle_shop.customer_payments
[0m20:57:29.852157 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customer_payments"
[0m20:57:29.853666 [debug] [Thread-1 (]: finished collecting timing info
[0m20:57:29.854019 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_payments
[0m20:57:29.854370 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payments
[0m20:57:29.854630 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.order_payments"
[0m20:57:29.854903 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payments
[0m20:57:29.855389 [debug] [Thread-1 (]: Compiling model.jaffle_shop.order_payments
[0m20:57:29.858862 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payments"
[0m20:57:29.859846 [debug] [Thread-1 (]: finished collecting timing info
[0m20:57:29.860137 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payments
[0m20:57:29.860259 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m20:57:29.860516 [info ] [Thread-1 (]: 5 of 6 START table model darren.dim_customers .................................. [RUN]
[0m20:57:29.860797 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.dim_customers"
[0m20:57:29.860897 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m20:57:29.860990 [debug] [Thread-1 (]: Compiling model.jaffle_shop.dim_customers
[0m20:57:29.873255 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m20:57:29.873834 [debug] [Thread-1 (]: finished collecting timing info
[0m20:57:29.873938 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m20:57:29.881379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:30.114782 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.dim_customers"
[0m20:57:30.116339 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `msm-groupdata-customer-dev`.`darren`.`dim_customers`
  
  
  OPTIONS()
  as (
    with  __dbt__cte__customer_orders as (
with orders as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_orders`

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

)

select * from final
),  __dbt__cte__customer_payments as (
with payments as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_payments`

),

orders as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_orders`

),

final as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders using (order_id)

    group by 1

)

select * from final
),customers as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_customers`

),

customer_orders as (

    select * from __dbt__cte__customer_orders

),

customer_payments as (

    select * from __dbt__cte__customer_payments

),

final as (

    select
        customers.customer_id,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders using (customer_id)

    left join customer_payments using (customer_id)

)

select * from final
  );
  
[0m20:57:30.385096 [debug] [Thread-2 (]: finished collecting timing info
[0m20:57:30.385798 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3571a071-23e7-4449-963a-af62fdefee98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c1060>]}
[0m20:57:30.386158 [info ] [Thread-2 (]: 4 of 6 OK created view model darren.hidden_model ............................... [[32mOK[0m in 1.08s]
[0m20:57:30.386538 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hidden_model
[0m20:57:30.386713 [debug] [Thread-2 (]: Began running node model.jaffle_shop.fct_orders
[0m20:57:30.387039 [info ] [Thread-2 (]: 6 of 6 START table model darren.fct_orders ..................................... [RUN]
[0m20:57:30.387509 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.fct_orders"
[0m20:57:30.387669 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.fct_orders
[0m20:57:30.387824 [debug] [Thread-2 (]: Compiling model.jaffle_shop.fct_orders
[0m20:57:30.398012 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m20:57:30.399064 [debug] [Thread-2 (]: finished collecting timing info
[0m20:57:30.399139 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.fct_orders
[0m20:57:30.401017 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:30.632985 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.fct_orders"
[0m20:57:30.634975 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */


  create or replace table `msm-groupdata-customer-dev`.`darren`.`fct_orders`
  
  
  OPTIONS()
  as (
    

with  __dbt__cte__order_payments as (


with payments as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_payments`

),

final as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by 1

)

select * from final
),orders as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_orders`

),

order_payments as (

    select * from __dbt__cte__order_payments

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
  
[0m20:57:32.760223 [debug] [Thread-1 (]: finished collecting timing info
[0m20:57:32.760516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3571a071-23e7-4449-963a-af62fdefee98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108400dc0>]}
[0m20:57:32.760684 [info ] [Thread-1 (]: 5 of 6 OK created table model darren.dim_customers ............................. [[32mCREATE TABLE (100.0 rows, 4.9 KB processed)[0m in 2.90s]
[0m20:57:32.760876 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m20:57:33.312503 [debug] [Thread-2 (]: finished collecting timing info
[0m20:57:33.313297 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3571a071-23e7-4449-963a-af62fdefee98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108400f10>]}
[0m20:57:33.313766 [info ] [Thread-2 (]: 6 of 6 OK created table model darren.fct_orders ................................ [[32mCREATE TABLE (99.0 rows, 6.5 KB processed)[0m in 2.93s]
[0m20:57:33.314477 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.fct_orders
[0m20:57:33.315276 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:57:33.315480 [info ] [MainThread]: 
[0m20:57:33.315620 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 5.72 seconds (5.72s).
[0m20:57:33.315724 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:57:33.315773 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m20:57:33.315820 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
[0m20:57:33.322059 [info ] [MainThread]: 
[0m20:57:33.322196 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:57:33.322312 [info ] [MainThread]: 
[0m20:57:33.322404 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:57:33.322540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725baf0>]}


============================== 2022-08-15 20:59:53.787643 | b6d4e12f-28ce-47ce-b06b-f6583b06b92b ==============================
[0m20:59:53.787706 [info ] [MainThread]: Running with dbt=1.2.0
[0m20:59:53.788520 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:59:53.788634 [debug] [MainThread]: Tracking: tracking
[0m20:59:53.813148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086500a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086500d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108652770>]}
[0m20:59:53.878468 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:59:53.878613 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:59:53.882141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6d4e12f-28ce-47ce-b06b-f6583b06b92b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095900d0>]}
[0m20:59:53.913323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6d4e12f-28ce-47ce-b06b-f6583b06b92b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085951e0>]}
[0m20:59:53.913505 [info ] [MainThread]: Found 9 models, 23 tests, 0 snapshots, 1 analysis, 523 macros, 0 operations, 3 seed files, 2 sources, 3 exposures, 2 metrics
[0m20:59:53.913669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6d4e12f-28ce-47ce-b06b-f6583b06b92b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108595360>]}
[0m20:59:53.914599 [info ] [MainThread]: 
[0m20:59:53.914809 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:59:53.915260 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev"
[0m20:59:53.915368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:54.413577 [debug] [ThreadPool]: Acquiring new bigquery connection "create_msm-groupdata-customer-dev_darren"
[0m20:59:54.414808 [debug] [ThreadPool]: Acquiring new bigquery connection "create_msm-groupdata-customer-dev_darren"
[0m20:59:54.415088 [debug] [ThreadPool]: BigQuery adapter: Creating schema "msm-groupdata-customer-dev.darren".
[0m20:59:54.415306 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:59:55.293608 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev_darren_vertex_samples"
[0m20:59:55.294383 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-customer-dev_darren"
[0m20:59:55.294680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:59:55.294907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:55.569061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6d4e12f-28ce-47ce-b06b-f6583b06b92b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084ecf70>]}
[0m20:59:55.570705 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:59:55.571207 [info ] [MainThread]: 
[0m20:59:55.580682 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m20:59:55.580912 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m20:59:55.581216 [info ] [Thread-1 (]: 1 of 6 START view model darren.stg_customers ................................... [RUN]
[0m20:59:55.581469 [info ] [Thread-2 (]: 2 of 6 START view model darren.stg_orders ...................................... [RUN]
[0m20:59:55.581928 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.stg_customers"
[0m20:59:55.582307 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.stg_orders"
[0m20:59:55.582487 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m20:59:55.582629 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m20:59:55.582833 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_customers
[0m20:59:55.582972 [debug] [Thread-2 (]: Compiling model.jaffle_shop.stg_orders
[0m20:59:55.587451 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m20:59:55.591241 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m20:59:55.592304 [debug] [Thread-1 (]: finished collecting timing info
[0m20:59:55.592432 [debug] [Thread-2 (]: finished collecting timing info
[0m20:59:55.592533 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m20:59:55.592646 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m20:59:55.614956 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.stg_orders"
[0m20:59:55.618839 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.stg_customers"
[0m20:59:55.619140 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:59:55.619289 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `msm-groupdata-customer-dev`.`darren`.`stg_orders`
  OPTIONS()
  as /*
hack for example macro references:
    

    The provided args are abc and 123


*/

with source as (
    select * from `msm-groupdata-customer-dev`.`darren_vertex_samples`.`raw_orders`

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed;


[0m20:59:55.620004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:55.620105 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `msm-groupdata-customer-dev`.`darren`.`stg_customers`
  OPTIONS()
  as with source as (
    select * from `msm-groupdata-customer-dev`.`darren_vertex_samples`.`raw_customers`

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name,
        email

    from source

)

select * from renamed;


[0m20:59:56.569871 [debug] [Thread-2 (]: finished collecting timing info
[0m20:59:56.570658 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6d4e12f-28ce-47ce-b06b-f6583b06b92b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107630670>]}
[0m20:59:56.571059 [info ] [Thread-2 (]: 2 of 6 OK created view model darren.stg_orders ................................. [[32mOK[0m in 0.99s]
[0m20:59:56.571443 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m20:59:56.571598 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_payments
[0m20:59:56.571985 [info ] [Thread-2 (]: 3 of 6 START view model darren.stg_payments .................................... [RUN]
[0m20:59:56.572296 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.stg_payments"
[0m20:59:56.572412 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_payments
[0m20:59:56.572537 [debug] [Thread-2 (]: Compiling model.jaffle_shop.stg_payments
[0m20:59:56.575260 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m20:59:56.576410 [debug] [Thread-2 (]: finished collecting timing info
[0m20:59:56.576534 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_payments
[0m20:59:56.578860 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.stg_payments"
[0m20:59:56.579636 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:59:56.579823 [debug] [Thread-2 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */


  create or replace view `msm-groupdata-customer-dev`.`darren`.`stg_payments`
  OPTIONS()
  as with source as (
    select * from `msm-groupdata-customer-dev`.`darren_vertex_samples`.`raw_payments`

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        --`amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed;


[0m20:59:56.633417 [debug] [Thread-1 (]: finished collecting timing info
[0m20:59:56.634030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6d4e12f-28ce-47ce-b06b-f6583b06b92b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108664250>]}
[0m20:59:56.634386 [info ] [Thread-1 (]: 1 of 6 OK created view model darren.stg_customers .............................. [[32mOK[0m in 1.05s]
[0m20:59:56.634755 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m20:59:56.634915 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_orders
[0m20:59:56.635261 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.customer_orders"
[0m20:59:56.635413 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customer_orders
[0m20:59:56.635548 [debug] [Thread-1 (]: Compiling model.jaffle_shop.customer_orders
[0m20:59:56.638421 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customer_orders"
[0m20:59:56.639973 [debug] [Thread-1 (]: finished collecting timing info
[0m20:59:56.640321 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_orders
[0m20:59:56.640460 [debug] [Thread-1 (]: Began running node model.jaffle_shop.hidden_model
[0m20:59:56.640683 [info ] [Thread-1 (]: 4 of 6 START view model darren.hidden_model .................................... [RUN]
[0m20:59:56.640994 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.hidden_model"
[0m20:59:56.641102 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.hidden_model
[0m20:59:56.641197 [debug] [Thread-1 (]: Compiling model.jaffle_shop.hidden_model
[0m20:59:56.643478 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.hidden_model"
[0m20:59:56.644244 [debug] [Thread-1 (]: finished collecting timing info
[0m20:59:56.644350 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.hidden_model
[0m20:59:56.648312 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.hidden_model"
[0m20:59:56.648779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:56.648908 [debug] [Thread-1 (]: On model.jaffle_shop.hidden_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.hidden_model"} */


  create or replace view `msm-groupdata-customer-dev`.`darren`.`hidden_model`
  OPTIONS()
  as -- hack for DAG viz
-- `msm-groupdata-customer-dev`.`darren`.`raw_orders`

select * from `msm-groupdata-customer-dev`.`darren`.`stg_orders`;


[0m20:59:57.324351 [debug] [Thread-2 (]: finished collecting timing info
[0m20:59:57.325902 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6d4e12f-28ce-47ce-b06b-f6583b06b92b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109774b20>]}
[0m20:59:57.326665 [info ] [Thread-2 (]: 3 of 6 OK created view model darren.stg_payments ............................... [[32mOK[0m in 0.75s]
[0m20:59:57.327493 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_payments
[0m20:59:57.328026 [debug] [Thread-2 (]: Began running node model.jaffle_shop.customer_payments
[0m20:59:57.328359 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.customer_payments"
[0m20:59:57.328497 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.customer_payments
[0m20:59:57.328634 [debug] [Thread-2 (]: Compiling model.jaffle_shop.customer_payments
[0m20:59:57.332293 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.customer_payments"
[0m20:59:57.333699 [debug] [Thread-2 (]: finished collecting timing info
[0m20:59:57.334030 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.customer_payments
[0m20:59:57.334172 [debug] [Thread-2 (]: Began running node model.jaffle_shop.order_payments
[0m20:59:57.334461 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.order_payments"
[0m20:59:57.334618 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.order_payments
[0m20:59:57.334794 [debug] [Thread-2 (]: Compiling model.jaffle_shop.order_payments
[0m20:59:57.337789 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.order_payments"
[0m20:59:57.338356 [debug] [Thread-2 (]: finished collecting timing info
[0m20:59:57.338658 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.order_payments
[0m20:59:57.338789 [debug] [Thread-2 (]: Began running node model.jaffle_shop.dim_customers
[0m20:59:57.339013 [info ] [Thread-2 (]: 5 of 6 START table model darren.dim_customers .................................. [RUN]
[0m20:59:57.339401 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.dim_customers"
[0m20:59:57.339604 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.dim_customers
[0m20:59:57.339711 [debug] [Thread-2 (]: Compiling model.jaffle_shop.dim_customers
[0m20:59:57.351477 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m20:59:57.352085 [debug] [Thread-2 (]: finished collecting timing info
[0m20:59:57.352175 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.dim_customers
[0m20:59:57.366665 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.dim_customers"
[0m20:59:57.374399 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:59:57.374551 [debug] [Thread-2 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `msm-groupdata-customer-dev`.`darren`.`dim_customers`
  
  
  OPTIONS()
  as (
    with  __dbt__cte__customer_orders as (
with orders as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_orders`

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

)

select * from final
),  __dbt__cte__customer_payments as (
with payments as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_payments`

),

orders as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_orders`

),

final as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders using (order_id)

    group by 1

)

select * from final
),customers as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_customers`

),

customer_orders as (

    select * from __dbt__cte__customer_orders

),

customer_payments as (

    select * from __dbt__cte__customer_payments

),

final as (

    select
        customers.customer_id,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders using (customer_id)

    left join customer_payments using (customer_id)

)

select * from final
  );
  
[0m20:59:57.610873 [debug] [Thread-1 (]: finished collecting timing info
[0m20:59:57.611777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6d4e12f-28ce-47ce-b06b-f6583b06b92b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10976c490>]}
[0m20:59:57.612294 [info ] [Thread-1 (]: 4 of 6 OK created view model darren.hidden_model ............................... [[32mOK[0m in 0.97s]
[0m20:59:57.612822 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.hidden_model
[0m20:59:57.613059 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m20:59:57.613455 [info ] [Thread-1 (]: 6 of 6 START table model darren.fct_orders ..................................... [RUN]
[0m20:59:57.613980 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.fct_orders"
[0m20:59:57.614150 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m20:59:57.614304 [debug] [Thread-1 (]: Compiling model.jaffle_shop.fct_orders
[0m20:59:57.626242 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m20:59:57.627160 [debug] [Thread-1 (]: finished collecting timing info
[0m20:59:57.627314 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m20:59:57.629918 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.fct_orders"
[0m20:59:57.630433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:57.630592 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */


  create or replace table `msm-groupdata-customer-dev`.`darren`.`fct_orders`
  
  
  OPTIONS()
  as (
    

with  __dbt__cte__order_payments as (


with payments as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_payments`

),

final as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by 1

)

select * from final
),orders as (

    select * from `msm-groupdata-customer-dev`.`darren`.`stg_orders`

),

order_payments as (

    select * from __dbt__cte__order_payments

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
  
[0m21:00:00.176003 [debug] [Thread-1 (]: finished collecting timing info
[0m21:00:00.176763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6d4e12f-28ce-47ce-b06b-f6583b06b92b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10976e410>]}
[0m21:00:00.177193 [info ] [Thread-1 (]: 6 of 6 OK created table model darren.fct_orders ................................ [[32mCREATE TABLE (99.0 rows, 6.5 KB processed)[0m in 2.56s]
[0m21:00:00.177695 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m21:00:00.282602 [debug] [Thread-2 (]: finished collecting timing info
[0m21:00:00.283437 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6d4e12f-28ce-47ce-b06b-f6583b06b92b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f8190>]}
[0m21:00:00.283890 [info ] [Thread-2 (]: 5 of 6 OK created table model darren.dim_customers ............................. [[32mCREATE TABLE (100.0 rows, 4.9 KB processed)[0m in 2.94s]
[0m21:00:00.284407 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.dim_customers
[0m21:00:00.285801 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m21:00:00.286266 [info ] [MainThread]: 
[0m21:00:00.286567 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 6.37 seconds (6.37s).
[0m21:00:00.286851 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:00.286999 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
[0m21:00:00.287135 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m21:00:00.302567 [info ] [MainThread]: 
[0m21:00:00.302820 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:00:00.303021 [info ] [MainThread]: 
[0m21:00:00.303195 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m21:00:00.303458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084ecf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108646a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108646ad0>]}


============================== 2022-08-15 21:03:23.798914 | 0825cddf-5602-4597-a0a9-22f4b18424dd ==============================
[0m21:03:23.798975 [info ] [MainThread]: Running with dbt=1.2.0
[0m21:03:23.799365 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m21:03:23.799476 [debug] [MainThread]: Tracking: tracking
[0m21:03:23.833840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f590f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f5a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f58880>]}
[0m21:03:23.857053 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:03:23.857276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0825cddf-5602-4597-a0a9-22f4b18424dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f47790>]}
[0m21:03:23.913497 [debug] [MainThread]: Parsing macros/example_macro.sql
[0m21:03:23.913932 [debug] [MainThread]: Parsing macros/etc.sql
[0m21:03:23.914790 [debug] [MainThread]: Parsing macros/catalog.sql
[0m21:03:23.917977 [debug] [MainThread]: Parsing macros/adapters.sql
[0m21:03:23.928509 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m21:03:23.929555 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m21:03:23.930716 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m21:03:23.932637 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m21:03:23.933830 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m21:03:23.940624 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m21:03:23.941283 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m21:03:23.941431 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m21:03:23.941692 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m21:03:23.941836 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m21:03:23.942063 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m21:03:23.942325 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m21:03:23.942729 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m21:03:23.943228 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m21:03:23.943430 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m21:03:23.943628 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m21:03:23.943838 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m21:03:23.944005 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m21:03:23.944565 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m21:03:23.944774 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m21:03:23.945894 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m21:03:23.947461 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m21:03:23.948384 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m21:03:23.949070 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m21:03:23.956285 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m21:03:23.962295 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m21:03:23.967854 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m21:03:23.969758 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m21:03:23.970506 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m21:03:23.971237 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m21:03:23.973054 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m21:03:23.980962 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m21:03:23.981619 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m21:03:24.007223 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m21:03:24.014493 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m21:03:24.016890 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m21:03:24.018069 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m21:03:24.020414 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m21:03:24.020940 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m21:03:24.022432 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m21:03:24.023381 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m21:03:24.026390 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m21:03:24.034670 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m21:03:24.035291 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m21:03:24.036311 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m21:03:24.036952 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m21:03:24.037324 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m21:03:24.037648 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m21:03:24.037969 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m21:03:24.038567 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m21:03:24.040395 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m21:03:24.044053 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m21:03:24.044380 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m21:03:24.044879 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m21:03:24.045269 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m21:03:24.045648 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m21:03:24.046152 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m21:03:24.046474 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m21:03:24.046908 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m21:03:24.047347 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m21:03:24.048390 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m21:03:24.048895 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m21:03:24.049335 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m21:03:24.049764 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m21:03:24.050175 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m21:03:24.050545 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m21:03:24.050978 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m21:03:24.051341 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m21:03:24.053775 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m21:03:24.054144 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m21:03:24.054896 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m21:03:24.055753 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m21:03:24.056171 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m21:03:24.057095 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m21:03:24.058184 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m21:03:24.064592 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m21:03:24.065792 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m21:03:24.071584 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m21:03:24.073414 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m21:03:24.076497 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m21:03:24.080633 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m21:03:24.081871 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m21:03:24.082280 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m21:03:24.082786 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m21:03:24.083241 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m21:03:24.085614 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m21:03:24.086073 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m21:03:24.087104 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m21:03:24.087611 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m21:03:24.088773 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m21:03:24.089179 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m21:03:24.090088 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m21:03:24.091021 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m21:03:24.094996 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m21:03:24.099543 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m21:03:24.100286 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m21:03:24.100862 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m21:03:24.101439 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m21:03:24.102097 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m21:03:24.102609 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m21:03:24.103230 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m21:03:24.103664 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m21:03:24.105025 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m21:03:24.107368 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m21:03:24.108108 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m21:03:24.108789 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m21:03:24.110265 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m21:03:24.112883 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m21:03:24.113467 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m21:03:24.114646 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m21:03:24.115450 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m21:03:24.116296 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m21:03:24.127593 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m21:03:24.128422 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m21:03:24.129510 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m21:03:24.130142 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m21:03:24.130895 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m21:03:24.131571 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m21:03:24.132522 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m21:03:24.133231 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m21:03:24.133725 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m21:03:24.134882 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m21:03:24.135782 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m21:03:24.136354 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m21:03:24.136859 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m21:03:24.138033 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m21:03:24.138896 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m21:03:24.139630 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m21:03:24.140544 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m21:03:24.141797 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m21:03:24.142410 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m21:03:24.143983 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m21:03:24.148184 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m21:03:24.148627 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m21:03:24.149107 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m21:03:24.149545 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m21:03:24.150020 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m21:03:24.151861 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m21:03:24.152574 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m21:03:24.154009 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m21:03:24.155803 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m21:03:24.157233 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m21:03:24.157909 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m21:03:24.159513 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m21:03:24.163026 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m21:03:24.168244 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m21:03:24.168806 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m21:03:24.171913 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m21:03:24.173339 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m21:03:24.173993 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m21:03:24.174708 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m21:03:24.177657 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m21:03:24.180091 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m21:03:24.181883 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m21:03:24.183079 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m21:03:24.184042 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m21:03:24.184739 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m21:03:24.358099 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers.sql
[0m21:03:24.363227 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payments.sql
[0m21:03:24.364160 [debug] [MainThread]: 1603: static parser failed on staging/stg_orders.sql
[0m21:03:24.366413 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_orders.sql
[0m21:03:24.367021 [debug] [MainThread]: 1699: static parser successfully parsed staging/hidden_model.sql
[0m21:03:24.370453 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/dim_customers.sql
[0m21:03:24.371352 [debug] [MainThread]: 1603: static parser failed on marts/core/fct_orders.sql
[0m21:03:24.373532 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/core/fct_orders.sql
[0m21:03:24.374020 [debug] [MainThread]: 1603: static parser failed on marts/core/intermediate/order_payments.sql
[0m21:03:24.375984 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/core/intermediate/order_payments.sql
[0m21:03:24.376937 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/intermediate/customer_payments.sql
[0m21:03:24.377939 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/intermediate/customer_orders.sql
[0m21:03:24.486859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0825cddf-5602-4597-a0a9-22f4b18424dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091fe710>]}
[0m21:03:24.494367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0825cddf-5602-4597-a0a9-22f4b18424dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f5a530>]}
[0m21:03:24.494498 [info ] [MainThread]: Found 9 models, 23 tests, 0 snapshots, 1 analysis, 523 macros, 0 operations, 3 seed files, 2 sources, 3 exposures, 2 metrics
[0m21:03:24.494616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0825cddf-5602-4597-a0a9-22f4b18424dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f470d0>]}
[0m21:03:24.495536 [info ] [MainThread]: 
[0m21:03:24.495742 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m21:03:24.496132 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-marketing-dev"
[0m21:03:24.496244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:25.040486 [debug] [ThreadPool]: Acquiring new bigquery connection "create_msm-groupdata-marketing-dev_darren_vertex_samples"
[0m21:03:25.044556 [debug] [ThreadPool]: Acquiring new bigquery connection "create_msm-groupdata-marketing-dev_darren_vertex_samples"
[0m21:03:25.044805 [debug] [ThreadPool]: BigQuery adapter: Creating schema "msm-groupdata-marketing-dev.darren_vertex_samples".
[0m21:03:25.044989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:26.063233 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-marketing-dev_darren_vertex_samples"
[0m21:03:26.064160 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-marketing-dev_darren"
[0m21:03:26.064576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:26.064903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:26.495709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0825cddf-5602-4597-a0a9-22f4b18424dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091fd930>]}
[0m21:03:26.496926 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:03:26.497440 [info ] [MainThread]: 
[0m21:03:26.505784 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m21:03:26.506292 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m21:03:26.506774 [info ] [Thread-1 (]: 1 of 3 START seed file darren_vertex_samples.raw_customers ..................... [RUN]
[0m21:03:26.507111 [info ] [Thread-2 (]: 2 of 3 START seed file darren_vertex_samples.raw_orders ........................ [RUN]
[0m21:03:26.507657 [debug] [Thread-1 (]: Acquiring new bigquery connection "seed.jaffle_shop.raw_customers"
[0m21:03:26.508078 [debug] [Thread-2 (]: Acquiring new bigquery connection "seed.jaffle_shop.raw_orders"
[0m21:03:26.508244 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m21:03:26.508395 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m21:03:26.508594 [debug] [Thread-1 (]: finished collecting timing info
[0m21:03:26.508737 [debug] [Thread-2 (]: finished collecting timing info
[0m21:03:26.508879 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m21:03:26.509016 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m21:03:26.545718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:26.546461 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:03:29.953797 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m21:03:29.963288 [debug] [Thread-1 (]: finished collecting timing info
[0m21:03:29.963529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0825cddf-5602-4597-a0a9-22f4b18424dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092df940>]}
[0m21:03:29.963665 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file darren_vertex_samples.raw_customers ................. [[32mINSERT 100[0m in 3.46s]
[0m21:03:29.963850 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m21:03:29.963937 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_payments
[0m21:03:29.964041 [info ] [Thread-1 (]: 3 of 3 START seed file darren_vertex_samples.raw_payments ...................... [RUN]
[0m21:03:29.964206 [debug] [Thread-1 (]: Acquiring new bigquery connection "seed.jaffle_shop.raw_payments"
[0m21:03:29.964270 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m21:03:29.964329 [debug] [Thread-1 (]: finished collecting timing info
[0m21:03:29.964385 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_payments
[0m21:03:29.969540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:30.146115 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m21:03:30.147632 [debug] [Thread-2 (]: finished collecting timing info
[0m21:03:30.147836 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0825cddf-5602-4597-a0a9-22f4b18424dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109430610>]}
[0m21:03:30.147963 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file darren_vertex_samples.raw_orders .................... [[32mINSERT 99[0m in 3.64s]
[0m21:03:30.148145 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m21:03:33.285993 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m21:03:33.291076 [debug] [Thread-1 (]: finished collecting timing info
[0m21:03:33.291659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0825cddf-5602-4597-a0a9-22f4b18424dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109430e80>]}
[0m21:03:33.291969 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file darren_vertex_samples.raw_payments .................. [[32mINSERT 113[0m in 3.33s]
[0m21:03:33.292228 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_payments
[0m21:03:33.292818 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m21:03:33.292982 [info ] [MainThread]: 
[0m21:03:33.293090 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 8.80 seconds (8.80s).
[0m21:03:33.293190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:33.293242 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m21:03:33.293292 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m21:03:33.299499 [info ] [MainThread]: 
[0m21:03:33.299625 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:03:33.299738 [info ] [MainThread]: 
[0m21:03:33.299830 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:03:33.299964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109406a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109488670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090aad10>]}


============================== 2022-08-15 21:03:39.175623 | a16dc8ea-428d-423a-a45b-5855bb5a54e3 ==============================
[0m21:03:39.175658 [info ] [MainThread]: Running with dbt=1.2.0
[0m21:03:39.176171 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:03:39.176281 [debug] [MainThread]: Tracking: tracking
[0m21:03:39.189604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e56c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e6320>]}
[0m21:03:39.258997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:03:39.259134 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:03:39.262583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a16dc8ea-428d-423a-a45b-5855bb5a54e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ee8f0>]}
[0m21:03:39.292085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a16dc8ea-428d-423a-a45b-5855bb5a54e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106404400>]}
[0m21:03:39.292267 [info ] [MainThread]: Found 9 models, 23 tests, 0 snapshots, 1 analysis, 523 macros, 0 operations, 3 seed files, 2 sources, 3 exposures, 2 metrics
[0m21:03:39.292384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a16dc8ea-428d-423a-a45b-5855bb5a54e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106406b60>]}
[0m21:03:39.293292 [info ] [MainThread]: 
[0m21:03:39.293496 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m21:03:39.293919 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-marketing-dev"
[0m21:03:39.293994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:39.811670 [debug] [ThreadPool]: Acquiring new bigquery connection "create_msm-groupdata-marketing-dev_darren"
[0m21:03:39.813154 [debug] [ThreadPool]: Acquiring new bigquery connection "create_msm-groupdata-marketing-dev_darren"
[0m21:03:39.813522 [debug] [ThreadPool]: BigQuery adapter: Creating schema "msm-groupdata-marketing-dev.darren".
[0m21:03:39.813759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:40.880036 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-marketing-dev_darren_vertex_samples"
[0m21:03:40.880585 [debug] [ThreadPool]: Acquiring new bigquery connection "list_msm-groupdata-marketing-dev_darren"
[0m21:03:40.880926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:40.881102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:41.145409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a16dc8ea-428d-423a-a45b-5855bb5a54e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ca6b00>]}
[0m21:03:41.146345 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:03:41.146738 [info ] [MainThread]: 
[0m21:03:41.154074 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m21:03:41.154345 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m21:03:41.154712 [info ] [Thread-1 (]: 1 of 6 START view model darren.stg_customers ................................... [RUN]
[0m21:03:41.154976 [info ] [Thread-2 (]: 2 of 6 START view model darren.stg_orders ...................................... [RUN]
[0m21:03:41.155465 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.stg_customers"
[0m21:03:41.155846 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.stg_orders"
[0m21:03:41.156003 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m21:03:41.156141 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m21:03:41.156358 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_customers
[0m21:03:41.156490 [debug] [Thread-2 (]: Compiling model.jaffle_shop.stg_orders
[0m21:03:41.161272 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m21:03:41.165147 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m21:03:41.166326 [debug] [Thread-2 (]: finished collecting timing info
[0m21:03:41.166412 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m21:03:41.167010 [debug] [Thread-1 (]: finished collecting timing info
[0m21:03:41.167095 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m21:03:41.189310 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.stg_customers"
[0m21:03:41.193330 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.stg_orders"
[0m21:03:41.193639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:41.193814 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `msm-groupdata-marketing-dev`.`darren`.`stg_customers`
  OPTIONS()
  as with source as (
    select * from `msm-groupdata-marketing-dev`.`darren_vertex_samples`.`raw_customers`

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name,
        email

    from source

)

select * from renamed;


[0m21:03:41.194576 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:03:41.194768 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `msm-groupdata-marketing-dev`.`darren`.`stg_orders`
  OPTIONS()
  as /*
hack for example macro references:
    

    The provided args are abc and 123


*/

with source as (
    select * from `msm-groupdata-marketing-dev`.`darren_vertex_samples`.`raw_orders`

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed;


[0m21:03:41.992594 [debug] [Thread-1 (]: finished collecting timing info
[0m21:03:41.993237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a16dc8ea-428d-423a-a45b-5855bb5a54e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063cbdc0>]}
[0m21:03:41.993592 [info ] [Thread-1 (]: 1 of 6 OK created view model darren.stg_customers .............................. [[32mOK[0m in 0.84s]
[0m21:03:41.993970 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m21:03:41.994128 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m21:03:41.994416 [info ] [Thread-1 (]: 3 of 6 START view model darren.stg_payments .................................... [RUN]
[0m21:03:41.994769 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.stg_payments"
[0m21:03:41.994892 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m21:03:41.995012 [debug] [Thread-1 (]: Compiling model.jaffle_shop.stg_payments
[0m21:03:41.997721 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m21:03:41.999128 [debug] [Thread-1 (]: finished collecting timing info
[0m21:03:41.999252 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m21:03:42.001550 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.stg_payments"
[0m21:03:42.002424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:42.002600 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */


  create or replace view `msm-groupdata-marketing-dev`.`darren`.`stg_payments`
  OPTIONS()
  as with source as (
    select * from `msm-groupdata-marketing-dev`.`darren_vertex_samples`.`raw_payments`

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        --`amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed;


[0m21:03:42.012683 [debug] [Thread-2 (]: finished collecting timing info
[0m21:03:42.013185 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a16dc8ea-428d-423a-a45b-5855bb5a54e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e87c0>]}
[0m21:03:42.013499 [info ] [Thread-2 (]: 2 of 6 OK created view model darren.stg_orders ................................. [[32mOK[0m in 0.86s]
[0m21:03:42.013842 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m21:03:42.014187 [debug] [Thread-2 (]: Began running node model.jaffle_shop.customer_orders
[0m21:03:42.014428 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.customer_orders"
[0m21:03:42.014535 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.customer_orders
[0m21:03:42.014642 [debug] [Thread-2 (]: Compiling model.jaffle_shop.customer_orders
[0m21:03:42.017097 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.customer_orders"
[0m21:03:42.017943 [debug] [Thread-2 (]: finished collecting timing info
[0m21:03:42.018201 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.customer_orders
[0m21:03:42.018292 [debug] [Thread-2 (]: Began running node model.jaffle_shop.hidden_model
[0m21:03:42.018390 [info ] [Thread-2 (]: 4 of 6 START view model darren.hidden_model .................................... [RUN]
[0m21:03:42.018603 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.hidden_model"
[0m21:03:42.018667 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.hidden_model
[0m21:03:42.018724 [debug] [Thread-2 (]: Compiling model.jaffle_shop.hidden_model
[0m21:03:42.020150 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.hidden_model"
[0m21:03:42.020614 [debug] [Thread-2 (]: finished collecting timing info
[0m21:03:42.020707 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.hidden_model
[0m21:03:42.025067 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.hidden_model"
[0m21:03:42.025541 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:03:42.025664 [debug] [Thread-2 (]: On model.jaffle_shop.hidden_model: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.hidden_model"} */


  create or replace view `msm-groupdata-marketing-dev`.`darren`.`hidden_model`
  OPTIONS()
  as -- hack for DAG viz
-- `msm-groupdata-marketing-dev`.`darren`.`raw_orders`

select * from `msm-groupdata-marketing-dev`.`darren`.`stg_orders`;


[0m21:03:42.749215 [debug] [Thread-1 (]: finished collecting timing info
[0m21:03:42.750005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a16dc8ea-428d-423a-a45b-5855bb5a54e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069cc100>]}
[0m21:03:42.750508 [info ] [Thread-1 (]: 3 of 6 OK created view model darren.stg_payments ............................... [[32mOK[0m in 0.76s]
[0m21:03:42.751044 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m21:03:42.751545 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_payments
[0m21:03:42.751910 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.customer_payments"
[0m21:03:42.752112 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customer_payments
[0m21:03:42.752283 [debug] [Thread-1 (]: Compiling model.jaffle_shop.customer_payments
[0m21:03:42.756411 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customer_payments"
[0m21:03:42.757687 [debug] [Thread-1 (]: finished collecting timing info
[0m21:03:42.758158 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_payments
[0m21:03:42.758337 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payments
[0m21:03:42.758609 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.order_payments"
[0m21:03:42.758943 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payments
[0m21:03:42.759085 [debug] [Thread-1 (]: Compiling model.jaffle_shop.order_payments
[0m21:03:42.762877 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payments"
[0m21:03:42.764126 [debug] [Thread-1 (]: finished collecting timing info
[0m21:03:42.764516 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payments
[0m21:03:42.764668 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m21:03:42.764934 [info ] [Thread-1 (]: 5 of 6 START table model darren.dim_customers .................................. [RUN]
[0m21:03:42.765370 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.jaffle_shop.dim_customers"
[0m21:03:42.765486 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m21:03:42.765591 [debug] [Thread-1 (]: Compiling model.jaffle_shop.dim_customers
[0m21:03:42.776098 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m21:03:42.785726 [debug] [Thread-2 (]: finished collecting timing info
[0m21:03:42.786036 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a16dc8ea-428d-423a-a45b-5855bb5a54e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069bbeb0>]}
[0m21:03:42.786257 [info ] [Thread-2 (]: 4 of 6 OK created view model darren.hidden_model ............................... [[32mOK[0m in 0.77s]
[0m21:03:42.786509 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.hidden_model
[0m21:03:42.786624 [debug] [Thread-2 (]: Began running node model.jaffle_shop.fct_orders
[0m21:03:42.786819 [info ] [Thread-2 (]: 6 of 6 START table model darren.fct_orders ..................................... [RUN]
[0m21:03:42.787112 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.jaffle_shop.fct_orders"
[0m21:03:42.787210 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.fct_orders
[0m21:03:42.787298 [debug] [Thread-2 (]: Compiling model.jaffle_shop.fct_orders
[0m21:03:42.794454 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m21:03:42.811378 [debug] [Thread-1 (]: finished collecting timing info
[0m21:03:42.811525 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m21:03:42.818968 [debug] [Thread-2 (]: finished collecting timing info
[0m21:03:42.825447 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.fct_orders
[0m21:03:42.828344 [debug] [Thread-1 (]: Writing runtime SQL for node "model.jaffle_shop.dim_customers"
[0m21:03:42.830011 [debug] [Thread-2 (]: Writing runtime SQL for node "model.jaffle_shop.fct_orders"
[0m21:03:42.833422 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:03:42.833523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:42.833617 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */


  create or replace table `msm-groupdata-marketing-dev`.`darren`.`fct_orders`
  
  
  OPTIONS()
  as (
    

with  __dbt__cte__order_payments as (


with payments as (

    select * from `msm-groupdata-marketing-dev`.`darren`.`stg_payments`

),

final as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by 1

)

select * from final
),orders as (

    select * from `msm-groupdata-marketing-dev`.`darren`.`stg_orders`

),

order_payments as (

    select * from __dbt__cte__order_payments

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
  
[0m21:03:42.833705 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "feature_library", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `msm-groupdata-marketing-dev`.`darren`.`dim_customers`
  
  
  OPTIONS()
  as (
    with  __dbt__cte__customer_orders as (
with orders as (

    select * from `msm-groupdata-marketing-dev`.`darren`.`stg_orders`

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

)

select * from final
),  __dbt__cte__customer_payments as (
with payments as (

    select * from `msm-groupdata-marketing-dev`.`darren`.`stg_payments`

),

orders as (

    select * from `msm-groupdata-marketing-dev`.`darren`.`stg_orders`

),

final as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders using (order_id)

    group by 1

)

select * from final
),customers as (

    select * from `msm-groupdata-marketing-dev`.`darren`.`stg_customers`

),

customer_orders as (

    select * from __dbt__cte__customer_orders

),

customer_payments as (

    select * from __dbt__cte__customer_payments

),

final as (

    select
        customers.customer_id,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders using (customer_id)

    left join customer_payments using (customer_id)

)

select * from final
  );
  
[0m21:03:45.141911 [debug] [Thread-2 (]: finished collecting timing info
[0m21:03:45.142733 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a16dc8ea-428d-423a-a45b-5855bb5a54e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2b2e0>]}
[0m21:03:45.143221 [info ] [Thread-2 (]: 6 of 6 OK created table model darren.fct_orders ................................ [[32mCREATE TABLE (99.0 rows, 6.5 KB processed)[0m in 2.36s]
[0m21:03:45.143720 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.fct_orders
[0m21:03:45.438779 [debug] [Thread-1 (]: finished collecting timing info
[0m21:03:45.439527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a16dc8ea-428d-423a-a45b-5855bb5a54e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106977f10>]}
[0m21:03:45.440003 [info ] [Thread-1 (]: 5 of 6 OK created table model darren.dim_customers ............................. [[32mCREATE TABLE (100.0 rows, 4.9 KB processed)[0m in 2.67s]
[0m21:03:45.440461 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m21:03:45.441847 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m21:03:45.442297 [info ] [MainThread]: 
[0m21:03:45.442575 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 6.15 seconds (6.15s).
[0m21:03:45.442813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:45.442937 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m21:03:45.443050 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
[0m21:03:45.458878 [info ] [MainThread]: 
[0m21:03:45.459122 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:03:45.459321 [info ] [MainThread]: 
[0m21:03:45.459479 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m21:03:45.459737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063cbfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064041c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647fa60>]}


============================== 2022-08-16 11:27:28.190268 | 23a97b68-48da-4842-b6c8-0510baeadde2 ==============================
[0m11:27:28.190274 [info ] [MainThread]: Running with dbt=1.2.0
[0m11:27:28.190473 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m11:27:28.190540 [debug] [MainThread]: Tracking: tracking
[0m11:27:28.211190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e2e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e2fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109387c0>]}
[0m11:27:28.224702 [debug] [MainThread]: Executing "git --help"
[0m11:27:28.252374 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:27:28.252781 [debug] [MainThread]: STDERR: "b''"
[0m11:27:28.253073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e2ecb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110939210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110939720>]}


============================== 2022-08-16 11:44:19.970583 | cf92946c-e986-4e79-8ec8-40bf1bcb5d2c ==============================
[0m11:44:19.970602 [info ] [MainThread]: Running with dbt=1.2.0
[0m11:44:19.970967 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/darren.price/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m11:44:19.971085 [debug] [MainThread]: Tracking: tracking
[0m11:44:19.990076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f5900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f6b00>]}
[0m11:44:19.991173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044fe110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044fceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ffe50>]}
